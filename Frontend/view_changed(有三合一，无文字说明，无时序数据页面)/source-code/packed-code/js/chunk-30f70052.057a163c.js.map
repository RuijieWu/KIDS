{"version":3,"sources":["webpack:///./node_modules/core-js/modules/_string-at.js","webpack:///./node_modules/core-js/modules/_advance-string-index.js","webpack:///./node_modules/core-js/modules/es6.regexp.match.js","webpack:///./src/pages/DataWareHouse.vue?7e9e","webpack:///./src/pages/DataWareHouse.vue","webpack:///src/pages/DataWareHouse.vue","webpack:///./src/pages/DataWareHouse.vue?83ea","webpack:///./src/pages/DataWareHouse.vue?4659"],"names":["toInteger","defined","module","exports","TO_STRING","that","pos","a","b","s","String","i","l","length","undefined","charCodeAt","charAt","slice","at","S","index","unicode","anObject","toLength","advanceStringIndex","regExpExec","MATCH","$match","maybeCallNative","regexp","O","this","fn","call","RegExp","res","done","value","rx","global","fullUnicode","lastIndex","result","A","n","matchStr","render","_vm","_c","_self","directives","name","rawName","loading","expression","attrs","staticClass","slot","_v","staticStyle","_l","warehousesData","warehouse","key","_s","storage_name","getStorageDescription","used_space","total_space","calculatePercentage","determineColor","nodes","scopedSlots","_u","scope","calculateNodePercentage","row","staticRenderFns","data","dataWarehouseStructureImage","mounted","fetchData","methods","storageName","_fetchData","_asyncToGenerator","regeneratorRuntime","mark","_callee","response","wrap","_context","prev","next","axios","get","sent","warehouses","initTotalUsageChart","t0","console","error","finish","stop","apply","arguments","used","parseSize","total","log","Math","round","node","sizeString","match","_match","_slicedToArray","size","unit","multipliers","B","kB","MB","GB","TB","pow","PB","parseFloat","toUpperCase","item","percentage","_this","chartDom","document","getElementById","myChart","echarts","totalUsed","reduce","sum","totalCapacity","option","title","text","left","tooltip","trigger","formatter","legend","orient","series","type","radius","emphasis","itemStyle","shadowBlur","shadowOffsetX","shadowColor","setOption","component"],"mappings":"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","file":"js/chunk-30f70052.057a163c.js","sourcesContent":["var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","'use strict';\nvar at = require('./_string-at')(true);\n\n // `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? at(S, index).length : 1);\n};\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@match logic\nrequire('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[MATCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative($match, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      if (!rx.global) return regExpExec(rx, S);\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataWareHouse.vue?vue&type=style&index=0&id=3d8ecb9e&prod&lang=css\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"id\":\"app\",\"element-loading-text\":\"加载中...\"}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"数据仓库监控\")])]),_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":12}},[_c('div',{staticStyle:{\"width\":\"100%\",\"height\":\"300px\"},attrs:{\"id\":\"totalUsageChart\"}})]),_c('el-col',{attrs:{\"span\":12}},[_c('h4',[_vm._v(\"数据仓库实现技术\")]),_c('ul',[_c('li',[_vm._v(\"分布式集群架构的多层数据仓库\")]),_c('li',[_vm._v(\"数据仓库分为数据采集层、数据存储与分析层和数据共享层三层。数据流在这三层之中逐级传递，最终为应用层提供数据支持。\")]),_c('li',[_vm._v(\"多层数据仓库结构整合了不同技术的优势特色，可以实现海量数据存储和动态扩容\")])])])],1),_c('el-row',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"gutter\":20}},_vm._l((_vm.warehousesData),function(warehouse,index){return _c('el-col',{key:index,attrs:{\"span\":12}},[_c('el-card',{staticClass:\"warehouse-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"\\n              \"+_vm._s(warehouse.storage_name)+\"\\n              \"),_c('el-tooltip',{attrs:{\"content\":_vm.getStorageDescription(warehouse.storage_name),\"placement\":\"top-start\"}},[_c('i',{staticClass:\"el-icon-question\"})])],1)]),_c('div',{staticClass:\"warehouse-info\"},[_c('p',[_vm._v(\"已使用容量: \"+_vm._s(warehouse.used_space))]),_c('p',[_vm._v(\"总容量: \"+_vm._s(warehouse.total_space))]),_c('el-progress',{attrs:{\"percentage\":_vm.calculatePercentage(warehouse),\"color\":_vm.determineColor(warehouse)}}),_c('el-collapse',{staticStyle:{\"margin-top\":\"10px\"}},[_c('el-collapse-item',{attrs:{\"title\":\"查看子节点详情\"}},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":warehouse.nodes}},[_c('el-table-column',{attrs:{\"prop\":\"node_name\",\"label\":\"节点名称\"}}),_c('el-table-column',{attrs:{\"prop\":\"used_space\",\"label\":\"已使用容量\"}}),_c('el-table-column',{attrs:{\"prop\":\"total_space\",\"label\":\"总容量\"}}),_c('el-table-column',{attrs:{\"label\":\"使用率\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-progress',{attrs:{\"percentage\":_vm.calculateNodePercentage(scope.row),\"color\":_vm.determineColor(scope.row)}})]}}],null,true)}),_c('el-table-column',{attrs:{\"prop\":\"transactions\",\"label\":\"事务提交\"}}),_c('el-table-column',{attrs:{\"prop\":\"rollbacks\",\"label\":\"事务回滚\"}}),_c('el-table-column',{attrs:{\"prop\":\"blks_read\",\"label\":\"块读取\"}}),_c('el-table-column',{attrs:{\"prop\":\"blks_hit\",\"label\":\"块命中\"}})],1)],1)],1)],1)])],1)}),1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"app\" v-loading=\"loading\" element-loading-text=\"加载中...\">\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>数据仓库监控</span>\r\n      </div>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"12\">\r\n          <div id=\"totalUsageChart\" style=\"width: 100%; height: 300px;\"></div>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <!--  <img\r\n            style=\"width: 100%; max-height: 200px; object-fit: contain; margin-bottom: 20px;\"\r\n            src=\"../assets/img/warehouse.jpg\"\r\n            fit=\"contain\"\r\n            :preview-src-list=\"[dataWarehouseStructureImage]\">\r\n          </img> -->\r\n          <h4>数据仓库实现技术</h4>\r\n          <ul>\r\n            <li>分布式集群架构的多层数据仓库</li>\r\n            <li>数据仓库分为数据采集层、数据存储与分析层和数据共享层三层。数据流在这三层之中逐级传递，最终为应用层提供数据支持。</li>\r\n            <li>多层数据仓库结构整合了不同技术的优势特色，可以实现海量数据存储和动态扩容</li>\r\n          </ul>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\r\n        <el-col :span=\"12\" v-for=\"(warehouse, index) in warehousesData\" :key=\"index\">\r\n          <el-card class=\"warehouse-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n              <span>\r\n                {{ warehouse.storage_name }}\r\n                <el-tooltip \r\n                  :content=\"getStorageDescription(warehouse.storage_name)\" \r\n                  placement=\"top-start\"\r\n                >\r\n                  <i class=\"el-icon-question\"></i>\r\n                </el-tooltip>\r\n              </span>\r\n            </div>\r\n            <div class=\"warehouse-info\">\r\n              <p>已使用容量: {{ warehouse.used_space }}</p>\r\n              <p>总容量: {{ warehouse.total_space }}</p>\r\n              <el-progress \r\n                :percentage=\"calculatePercentage(warehouse)\"\r\n                :color=\"determineColor(warehouse)\">\r\n              </el-progress>\r\n              <el-collapse style=\"margin-top: 10px;\">\r\n                <el-collapse-item title=\"查看子节点详情\">\r\n                  <el-table :data=\"warehouse.nodes\" style=\"width: 100%\">\r\n                    <el-table-column prop=\"node_name\" label=\"节点名称\"></el-table-column>\r\n                    <el-table-column prop=\"used_space\" label=\"已使用容量\"></el-table-column>\r\n                    <el-table-column prop=\"total_space\" label=\"总容量\"></el-table-column>\r\n                    <el-table-column label=\"使用率\">\r\n                      <template slot-scope=\"scope\">\r\n                        <el-progress \r\n                          :percentage=\"calculateNodePercentage(scope.row)\"\r\n                          :color=\"determineColor(scope.row)\">\r\n                        </el-progress>\r\n                      </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"transactions\" label=\"事务提交\"></el-table-column>\r\n                    <el-table-column prop=\"rollbacks\" label=\"事务回滚\"></el-table-column>\r\n                    <el-table-column prop=\"blks_read\" label=\"块读取\"></el-table-column>\r\n                    <el-table-column prop=\"blks_hit\" label=\"块命中\"></el-table-column>\r\n                  </el-table>\r\n                </el-collapse-item>\r\n              </el-collapse>\r\n            </div>\r\n          </el-card>\r\n        </el-col>\r\n      </el-row>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'App',\r\n  data() {\r\n    return {\r\n      warehousesData: [],\r\n      loading:false,\r\n      dataWarehouseStructureImage: '../assets/img/warehouse.jpg',\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchData()\r\n  },\r\n  methods: {\r\n    getStorageDescription(storageName) {\r\n    if (storageName === 'HDFS Storage') {\r\n      return 'HDFS (Hadoop Distributed File System) 是数据存储与分析层的数据仓库，HDFS存储数据采集模块Agent采集的数据，并且直接将数据交付给KIDS引擎。'\r\n    } else if (storageName === 'Postgres Storage') {\r\n      return 'PostgreSQL 是数据共享层的数据仓库，PostgreSQL获取规则引擎预检的数据和KIDS引擎交付的数据提供给应用层即接口和前端使用。'\r\n    }\r\n    return '数据存储系统'\r\n  },\r\n    async fetchData() {\r\n      this.loading = true;\r\n      try {\r\n        const response = await axios.get('http://43.138.200.89:8080/data/stats')\r\n        this.warehousesData = response.data.warehouses\r\n        this.initTotalUsageChart()\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error)\r\n      }finally{\r\n        this.loading = false;\r\n      }\r\n    },\r\n    calculatePercentage(warehouse) {\r\n      const used = this.parseSize(warehouse.used_space);\r\n      const total = this.parseSize(warehouse.total_space);\r\n      console.log(\"使用量\",used,total,warehouse.used_space,warehouse.total_space)\r\n      console.log(\"使用率\",Math.round((used / total) * 100))\r\n      return Math.round((used / total) * 100) || 0;\r\n    },\r\n\r\n    calculateNodePercentage(node) {\r\n      const used = this.parseSize(node.used_space);\r\n      const total = this.parseSize(node.total_space);\r\n      return Math.round((used / total) * 100) || 0;\r\n    },\r\n\r\n    parseSize(sizeString) {\r\n      const match = sizeString.match(/(\\d+(\\.\\d+)?)\\s*(\\w+)/);\r\n      if (!match) return 0;\r\n      const [, size, , unit] = match;\r\n      const multipliers = { B: 1, kB: 1024, MB: 1024 * 1024, GB: 1024 * 1024 * 1024, TB: 1024 ** 4, PB: 1024 ** 5 };\r\n      return parseFloat(size) * (multipliers[unit.toUpperCase()] || 1);\r\n    },\r\n\r\n    determineColor(item) {\r\n      const percentage = this.calculatePercentage(item)\r\n      if (percentage >= 90) {\r\n        return '#FF4949'  // 红色\r\n      } else if (percentage >= 70) {\r\n        return '#F7BA2A'  // 橙色\r\n      } else {\r\n        return '#13CE66'  // 绿色\r\n      }\r\n    },\r\n    initTotalUsageChart() {\r\n      const chartDom = document.getElementById('totalUsageChart')\r\n      const myChart = echarts.init(chartDom)\r\n      const totalUsed = this.warehousesData.reduce((sum, warehouse) => sum + this.parseSize(warehouse.used_space), 0)\r\n      const totalCapacity = this.warehousesData.reduce((sum, warehouse) => sum + this.parseSize(warehouse.total_space), 0)\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '总体使用情况',\r\n          left: 'center'\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: '{a} <br/>{b}: {c} GB ({d}%)'\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          left: 'left'\r\n        },\r\n        series: [\r\n          {\r\n            name: '容量',\r\n            type: 'pie',\r\n            radius: '50%',\r\n            data: [\r\n              { value: totalUsed / (1024 * 1024 * 1024), name: '已使用' },\r\n              { value: (totalCapacity - totalUsed) / (1024 * 1024 * 1024), name: '未使用' }\r\n            ],\r\n            emphasis: {\r\n              itemStyle: {\r\n                shadowBlur: 10,\r\n                shadowOffsetX: 0,\r\n                shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      }\r\n      \r\n      myChart.setOption(option)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n#app {\r\n  font-family: Avenir, Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  color: #2c3e50;\r\n  margin-top: 60px;\r\n}\r\n.warehouse-card {\r\n  margin-bottom: 20px;\r\n}\r\n.warehouse-info {\r\n  text-align: left;\r\n}\r\n/* 新增样式 */\r\nul {\r\n  text-align: left;\r\n  padding-left: 20px;\r\n}\r\nli {\r\n  margin-bottom: 10px;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataWareHouse.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataWareHouse.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./DataWareHouse.vue?vue&type=template&id=3d8ecb9e\"\nimport script from \"./DataWareHouse.vue?vue&type=script&lang=js\"\nexport * from \"./DataWareHouse.vue?vue&type=script&lang=js\"\nimport style0 from \"./DataWareHouse.vue?vue&type=style&index=0&id=3d8ecb9e&prod&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}