(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e43f7f7"],{"02f4":function(t,e,a){var n=a("4588"),r=a("be13");t.exports=function(t){return function(e,a){var i,s,o=String(r(e)),c=n(a),l=o.length;return c<0||c>=l?t?"":void 0:(i=o.charCodeAt(c),i<55296||i>56319||c+1===l||(s=o.charCodeAt(c+1))<56320||s>57343?t?o.charAt(c):i:t?o.slice(c,c+2):s-56320+(i-55296<<10)+65536)}}},"0390":function(t,e,a){"use strict";var n=a("02f4")(!0);t.exports=function(t,e,a){return e+(a?n(t,e).length:1)}},"0a49":function(t,e,a){var n=a("9b43"),r=a("626a"),i=a("4bf8"),s=a("9def"),o=a("cd1c");t.exports=function(t,e){var a=1==t,c=2==t,l=3==t,u=4==t,d=6==t,h=5==t||d,p=e||o;return function(e,o,f){for(var g,m,v=i(e),b=r(v),y=n(o,f,3),w=s(b.length),_=0,S=a?p(e,w):c?p(e,0):void 0;w>_;_++)if((h||_ in b)&&(g=b[_],m=y(g,_,v),t))if(a)S[_]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return _;case 2:S.push(g)}else if(u)return!1;return d?-1:l||u?u:S}}},1169:function(t,e,a){var n=a("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"1c4c":function(t,e,a){"use strict";var n=a("9b43"),r=a("5ca1"),i=a("4bf8"),s=a("1fa8"),o=a("33a4"),c=a("9def"),l=a("f1ae"),u=a("27ee");r(r.S+r.F*!a("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,a,r,d,h=i(t),p="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,v=0,b=u(h);if(m&&(g=n(g,f>2?arguments[2]:void 0,2)),void 0==b||p==Array&&o(b))for(e=c(h.length),a=new p(e);e>v;v++)l(a,v,m?g(h[v],v):h[v]);else for(d=b.call(h),a=new p;!(r=d.next()).done;v++)l(a,v,m?s(d,g,[r.value,v],!0):r.value);return a.length=v,a}})},"20d6":function(t,e,a){"use strict";var n=a("5ca1"),r=a("0a49")(6),i="findIndex",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),n(n.P+n.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(i)},"28a5":function(t,e,a){"use strict";var n=a("aae3"),r=a("cb7c"),i=a("ebd6"),s=a("0390"),o=a("9def"),c=a("5f1b"),l=a("520a"),u=a("79e5"),d=Math.min,h=[].push,p="split",f="length",g="lastIndex",m=4294967295,v=!u((function(){RegExp(m,"y")}));a("214f")("split",2,(function(t,e,a,u){var b;return b="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[f]||2!="ab"[p](/(?:ab)*/)[f]||4!="."[p](/(.?)(.?)/)[f]||"."[p](/()()/)[f]>1||""[p](/.?/)[f]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!n(t))return a.call(r,t,e);var i,s,o,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,p=void 0===e?m:e>>>0,v=new RegExp(t.source,u+"g");while(i=l.call(v,r)){if(s=v[g],s>d&&(c.push(r.slice(d,i.index)),i[f]>1&&i.index<r[f]&&h.apply(c,i.slice(1)),o=i[0][f],d=s,c[f]>=p))break;v[g]===i.index&&v[g]++}return d===r[f]?!o&&v.test("")||c.push(""):c.push(r.slice(d)),c[f]>p?c.slice(0,p):c}:"0"[p](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)}:a,[function(a,n){var r=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,r,n):b.call(String(r),a,n)},function(t,e){var n=u(b,t,this,e,b!==a);if(n.done)return n.value;var l=r(t),h=String(this),p=i(l,RegExp),f=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(v?"y":"g"),y=new p(v?l:"^(?:"+l.source+")",g),w=void 0===e?m:e>>>0;if(0===w)return[];if(0===h.length)return null===c(y,h)?[h]:[];var _=0,S=0,C=[];while(S<h.length){y.lastIndex=v?S:0;var x,T=c(y,v?h:h.slice(S));if(null===T||(x=d(o(y.lastIndex+(v?0:S)),h.length))===_)S=s(h,S,f);else{if(C.push(h.slice(_,S)),C.length===w)return C;for(var j=1;j<=T.length-1;j++)if(C.push(T[j]),C.length===w)return C;S=_=x}}return C.push(h.slice(_)),C}]}))},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var n=a("6b75");function r(t){if(Array.isArray(t))return Object(n["a"])(t)}function i(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=a("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return r(t)||i(t)||Object(s["a"])(t)||o()}},"2e08":function(t,e,a){var n=a("9def"),r=a("9744"),i=a("be13");t.exports=function(t,e,a,s){var o=String(i(t)),c=o.length,l=void 0===a?" ":String(a),u=n(e);if(u<=c||""==l)return o;var d=u-c,h=r.call(l,Math.ceil(d/l.length));return h.length>d&&(h=h.slice(0,d)),s?h+o:o+h}},"2f21":function(t,e,a){"use strict";var n=a("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"306e":function(t,e,a){"use strict";a("7f50")},"37c8":function(t,e,a){e.f=a("2b4c")},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3a72":function(t,e,a){var n=a("7726"),r=a("8378"),i=a("2d00"),s=a("37c8"),o=a("86cc").f;t.exports=function(t){var e=r.Symbol||(r.Symbol=i?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:s.f(t)})}},"3c48":function(t,e,a){},"3f97":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.currentWebPage,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:t.handleSelect}},[e("el-menu-item",{attrs:{index:"rules"}},[t._v("规则预检")]),e("el-menu-item",{attrs:{index:"analysis"}},[t._v("AI模型检测")]),e("el-menu-item",{attrs:{index:"events"}},[t._v("事件输出")])],1),e("div",{staticClass:"container mt-4"},["analysis"!=t.currentWebPage&&"rules"!=t.currentWebPage&&"events"!=t.currentWebPage?e("div",[e("el-steps",{attrs:{active:4}},[e("el-step",{attrs:{title:"第一层过滤",description:"规则预检"}}),e("el-step",{attrs:{title:"第二层过滤",description:"AI模型检测"}}),e("el-step",{attrs:{title:"分析结果输出",description:"安全事件输出"}})],1)],1):t._e(),"analysis"===t.currentWebPage?e("div",[e("div",{staticClass:"main-container"},[e("div",{staticClass:"main-container"},[e("span",{staticStyle:{"font-size":"18px"}},[t._v('"KIDS系统对于数据的第二层检测，使用KIDS引擎分析规则预检后的数据，将时序数据分化为时间窗口，\n              每个异常时间窗口对应一个安全事件，引擎输出每个安全事件对应的溯源图"')]),e("div",{staticClass:"top-row"},[e("div",{staticClass:"top-row-left column"},[e("h4",[t._v("分析参数")]),e("div",{staticClass:"row upload-section"},[e("div",{staticClass:"row ml-3"},[e("el-tag",[t._v("上传方式")]),e("el-select",{staticClass:"ml-1 upload-selcter",attrs:{placeholder:"选择上传方式"},model:{value:t.selectedUploadType,callback:function(e){t.selectedUploadType=e},expression:"selectedUploadType"}},t._l(t.uploadMethod,(function(t){return e("el-option",{attrs:{label:t.label,value:t.value}})})),1)],1),"file"===t.selectedUploadType?e("div",{staticClass:"ml-3 row"},[e("el-button",{staticClass:"mt-0 mr-5",on:{click:t.showUploadDialog}},[t._v("选取文件")])],1):"manual"===t.selectedUploadType?e("div",{staticClass:"row align-items-center ml-3"},[e("div",[e("button",{staticClass:"ml-3 mr-3 mt-0",on:{click:t.changeShow}},[t._v(t._s(t.showTextArea?"收起":"展开"))])]),e("div",[e("button",{staticClass:"button upload-button mt-0",attrs:{disabled:!t.manualInput.trim()},on:{click:t.sendManualInput}},[t._v("发送数据")])])]):t._e()]),e("div",{staticClass:"w-100"},[t.showTextArea?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.manualInput,expression:"manualInput"}],staticClass:"form-control w-100 mt-2",staticStyle:{"background-color":"gray",color:"white"},attrs:{rows:"3",placeholder:"输入数据"},domProps:{value:t.manualInput},on:{input:[function(e){e.target.composing||(t.manualInput=e.target.value)},t.submitMultilineText]}}):t._e()]),e("div",{staticClass:"model-mode row mt-2"},[e("div",{staticClass:"row ml-3"},[e("el-tag",[t._v("分析方式")]),e("el-select",{staticClass:"ml-1 upload-selcter",attrs:{placeholder:"选择分析方式"},model:{value:t.modelConfig.MODEL_NAME,callback:function(e){t.$set(t.modelConfig,"MODEL_NAME",e)},expression:"modelConfig.MODEL_NAME"}},t._l(t.analysisMethod,(function(t){return e("el-option",{attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"row mt-0"},[e("el-button",{staticClass:"mt-0 ml-4",on:{click:t.showModelConfig}},[t._v("修改模型配置")])],1)]),e("el-dialog",{attrs:{title:"修改模型配置",visible:t.modelConfigVisible,width:"50%","modal-append-to-body":!1},on:{"update:visible":function(e){t.modelConfigVisible=e}}},[e("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"文件路径",name:"artifactsPath"}},[e("el-form",{attrs:{model:t.modelConfig,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"产物目录"}},[e("el-input",{model:{value:t.modelConfig.ARTIFACT_DIR,callback:function(e){t.$set(t.modelConfig,"ARTIFACT_DIR",e)},expression:"modelConfig.ARTIFACT_DIR"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"存储模型产物的目录路径",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"模型名称"}},[e("el-input",{model:{value:t.modelConfig.MODEL_NAME,callback:function(e){t.$set(t.modelConfig,"MODEL_NAME",e)},expression:"modelConfig.MODEL_NAME"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"模型的名称,更改模型的名称可以使用不同模型",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1)],1)],1),e("el-tab-pane",{attrs:{label:"阈值设置",name:"threshold"}},[e("el-form",{attrs:{model:t.modelConfig,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"损失因子"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0,max:10},model:{value:t.modelConfig.LOSS_FACTOR,callback:function(e){t.$set(t.modelConfig,"LOSS_FACTOR",e)},expression:"modelConfig.LOSS_FACTOR"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"损失函数的因子",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"最大时间窗口阈值"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0},model:{value:t.modelConfig.MAX_AVG_LOSS,callback:function(e){t.$set(t.modelConfig,"MAX_AVG_LOSS",e)},expression:"modelConfig.MAX_AVG_LOSS"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"允许的最大时间窗口阈值",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"最小时间窗口阈值"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0},model:{value:t.modelConfig.MIN_AVG_LOSS,callback:function(e){t.$set(t.modelConfig,"MIN_AVG_LOSS",e)},expression:"modelConfig.MIN_AVG_LOSS"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"允许的最小时间窗口阈值",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1),e("span",{staticClass:"dialog-footer row justify-content-end mr-5",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.modelConfigVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveModelConfig}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{visible:t.dialogVisible,title:"选择文件并上传",width:"50%","modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-change":t.handleFileChange,"auto-upload":!1,"file-list":t.fileList,accept:".json"}},[e("el-button",{staticClass:"mt-0",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),e("span",{staticClass:"dialog-footer row justify-content-end",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"mb-0",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("\n                确 认\n              ")]),e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1),e("span",{staticClass:"justify-content-center row mt-3 mb-2"},[e("el-button",{on:{click:t.triggerAnalysis}},[t._v("开始分析")])],1),t.progressVisible?e("el-progress",{staticClass:"justify-content-center",attrs:{percentage:t.progress,format:t.format,"stroke-width":20}}):t._e()],1),e("div",{staticClass:"top-row-right column"},[e("div",{staticClass:"row"},t._l(t.statsCards,(function(a){return e("div",{key:a.title,staticClass:"col-md-6 col-lg-6 mb-3"},[e("stats-card",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"stats.loading"}],staticClass:"h-100"},[e("div",{staticClass:"icon-big text-center",class:"icon-".concat(a.type),attrs:{slot:"header"},slot:"header"},[e("i",{class:a.icon})]),e("div",{staticClass:"numbers",attrs:{slot:"content"},slot:"content"},[e("p",[t._v(t._s(a.title))]),e("p",[t._v(t._s(a.subTitle))]),t._v("\n          "+t._s(a.value)+"\n        ")])])],1)})),0)])]),e("div",{staticClass:"bottom-row mt-3"},[e("div",{staticClass:"row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-4",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"被攻击方类型",chartLibrary:"echarts",chartData:t.objectTypes,"chart-type":"Pie"}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-8",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"最多次被攻击方","sub-title":"演示数据",chartLibrary:"echarts",chartType:"Bar",chartData:t.objectNames}})],1)]),e("div",{staticClass:"row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-4",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"攻击方类型",chartLibrary:"echarts",chartData:t.subjectTypes,"chart-type":"Pie"}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-8",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"最多次攻击方","sub-title":"演示数据",chartLibrary:"echarts",chartType:"Bar",chartData:t.subjectNames}})],1)])]),e("div",{staticClass:"bottom-row mt-3"},[e("div",{staticClass:"d-flex justify-content-start mb-3"},[e("el-button",{attrs:{type:"primary"},on:{click:t.toggleActionView}},[t._v("\n        "+t._s(t.showActionTable?"显示安全事件":"显示行为表格")+"\n      ")])],1),t.showActionTable?e("div",{staticClass:"action-table"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"table-selector"},[e("label",{attrs:{for:"tableSelect"}},[t._v("选择表格:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedTable,expression:"selectedTable"}],staticClass:"form-select",attrs:{id:"tableSelect"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedTable=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"AttackerTable"}},[t._v("攻击源列表")]),e("option",{attrs:{value:"AttackedTable"}},[t._v("被攻击方列表")]),e("option",{attrs:{value:"AlterTable"}},[t._v("可疑行为列表")]),e("option",{attrs:{value:"DangerTable"}},[t._v("危险行为列表")])])]),e("div",{staticClass:"search-bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),t.CurrentTable?e("div",{staticClass:"col-12"},[t.CurrentTable?e("card",{attrs:{title:t.CurrentTable.title,subTitle:t.CurrentTable.subTitle}},[e("div",{staticClass:"table",attrs:{slot:"raw-content"},slot:"raw-content"},[e("paper-table",{key:"".concat(t.selectedTable,"-").concat(t.dataUpdateTrigger),attrs:{data:t.filteredData,columns:t.CurrentTable.columns}})],1)]):t._e(),e("div",{staticClass:"page_button",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("p-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handlePrevPage.apply(null,arguments)}}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("p-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handleNextPage.apply(null,arguments)}}},[t._v("下一页")])],1)],1):t._e()]):e("div",{staticClass:"source-map"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"search-bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingSource,expression:"loadingSource"}],staticClass:"col-12",attrs:{"element-loading-text":"加载中..."}},[e("source-table",{attrs:{sources:t.filteredSources,title:t.EventTable.title}})],1)])])])])]):t._e(),"rules"===t.currentWebPage?e("div",[e("div",{staticClass:"main-container"},[e("div",{staticClass:"d-flex justify-content-end mb-3"},[e("span",{staticClass:"mr-5",staticStyle:{"font-size":"18px"}},[t._v('"KIDS系统对于数据的第一层过滤，此页面允许用户自定义黑白名单规则，\n      实现对数据的快速处理，处理后的数据插入数据库，使用AI进行第二层检测"')]),e("el-button",{attrs:{type:"primary"},on:{click:t.toggleView}},[t._v("\n        "+t._s(t.showTable?"显示规则":"显示表格")+"\n      ")])],1),t.showTable?e("div",{staticClass:"table"},[e("div",{staticClass:"col-12 d-flex justify-content-end"},[e("div",{staticClass:"table-header col-3"},[e("div",{staticClass:"search-bar mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search ml-2"})],1)])]),e("div",{staticClass:"col-12"},[e("card",{attrs:{title:t.tableData.title,subTitle:t.tableData.subTitle}},[e("div",{staticClass:"table",attrs:{slot:"raw-content"},slot:"raw-content"},[e("paper-table",{key:"".concat(t.tableData.title,"-").concat(t.dataUpdateTrigger),attrs:{data:t.filteredData,columns:t.tableData.columns}})],1)]),e("div",{staticClass:"page_button",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("p-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handlePrevPage.apply(null,arguments)}}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("p-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handleNextPage.apply(null,arguments)}}},[t._v("下一页")])],1)],1)]):e("div",{staticClass:"rule-engine"},[e("div",{staticClass:"d-flex justify-content-between"},[e("div",{staticClass:"mt-3 ml-2"},[e("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"筛选规则类型"},model:{value:t.ruleTypeFilter,callback:function(e){t.ruleTypeFilter=e},expression:"ruleTypeFilter"}},[e("el-option",{attrs:{label:"全部",value:"all"}}),e("el-option",{attrs:{label:"黑名单",value:"black"}}),e("el-option",{attrs:{label:"白名单",value:"white"}})],1)],1),e("div",[e("el-button",{staticClass:"mr-3 btn btn-primary mt-3",attrs:{type:"primary"},on:{click:t.showUploadDialog}},[t._v("导入规则")]),e("el-button",{staticClass:"btn btn-primary mt-3 mr-3",attrs:{type:"primary"},on:{click:t.addEmptyRule}},[t._v("添加新规则")])],1)]),e("div",{staticClass:"col-12 mb-2"},t._l(t.filteredRules,(function(a,n){return e("rule-child",{key:n,attrs:{rule:a,ruleId:a.id,index:n},on:{delete:t.deleteRule,updateRules:t.updateRules}})})),1),e("el-dialog",{attrs:{visible:t.dialogVisible,title:"选择文件并上传",width:"50%","modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-preview":t.handlePreview,"on-remove":t.handleRemove,"http-request":t.handleUpload,"on-change":t.handleChange,"file-list":t.fileList,accept:".yaml","auto-upload":!1,multiple:""}},[e("el-button",{staticClass:"mt-0",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),e("span",{staticClass:"dialog-footer row justify-content-end",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"mb-0",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("\n                确 认\n              ")]),e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)])]):t._e(),"events"===t.currentWebPage?e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("span",{staticStyle:{"font-size":"18px"}},[t._v('"此页面针对每个安全事件提供用户可查看的溯源图和统计数据，生成交互式安全报告并且处理其中间过程得到关键路径报告，\n          提供模板化的安全建议以及使用大语言模型生成的安全建议"')]),e("div",{staticClass:"table-header"},[e("div",{staticClass:"search-bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"col-12 loading",attrs:{"element-loading-text":"加载中..."}},[e("source-table",{attrs:{sources:t.filteredSources,title:t.EventTable.title}})],1)])]):t._e()])],1)},r=[],i=(a("ac4d"),a("8a81"),a("1c4c"),a("ffc1"),a("55dd"),a("6b54"),a("f576"),a("c5f6"),a("28a5"),a("3835")),s=(a("4917"),a("a481"),a("20d6"),a("53ca")),o=(a("5df3"),a("7f7f"),a("aef6"),a("96cf"),a("1da1")),c=(a("6762"),a("2fdb"),a("ac6a"),a("8615"),a("ade3")),l=a("2af9"),u=a("ba48"),d=a.n(u),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row my-3"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"d-flex align-items-center bg-white"},[e("el-tag",{staticClass:"ml-2 mr-2",on:{click:t.changeType}},[t._v(t._s("black"==t.ruleData.ruleType?"黑":"白")+"名单")]),e("div",{staticClass:"flex-grow-1"},[e("fg-input",{staticClass:"form-control rule-name-input",attrs:{type:"text",placeholder:"输入规则名称"},model:{value:t.ruleData.ruleName,callback:function(e){t.$set(t.ruleData,"ruleName",e)},expression:"ruleData.ruleName"}})],1),e("div",{staticClass:"levelSelect ml-3 mt-3 mb-3"},[e("label",[t._v(" 危害等级")]),e("div",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.ruleData.warnLevel,expression:"ruleData.warnLevel"}],staticClass:"form-select",class:t.warnLevelClass,attrs:{id:"tableSelect"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.ruleData,"warnLevel",e.target.multiple?a:a[0])}}},[e("option",{staticClass:"text-dange",attrs:{value:"high"}},[t._v("高危")]),e("option",{staticClass:"text-warning",attrs:{value:"medium"}},[t._v("可疑")]),e("option",{staticClass:"text-success",attrs:{value:"low"}},[t._v("低危")])])])]),e("div",{staticClass:"ruleMessage mt-3 ml-3 mb-3 mr-3"},[e("el-input",{attrs:{type:"text",placeholder:"输入规则信息"},model:{value:t.ruleData.ruleMessage,callback:function(e){t.$set(t.ruleData,"ruleMessage",e)},expression:"ruleData.ruleMessage"}})],1),e("div",{staticClass:"rule"},[e("button",{staticClass:"btn btn-primary ml-3 mr-3",on:{click:t.changeShow}},[t._v(t._s(t.showTextArea?"收起":"展开"))])]),e("div",{staticClass:"ml-3"},[e("b-form-checkbox",{attrs:{switch:""},model:{value:t.ruleData.enable,callback:function(e){t.$set(t.ruleData,"enable",e)},expression:"ruleData.enable"}},[t._v("启用")])],1),e("button",{staticClass:"btn btn-primary ml-3 mr-3",on:{click:t.saveInputs}},[t._v("保存")]),e("div",{staticClass:"ml-3 mr-3"},[e("b-button",{attrs:{variant:"success"},on:{click:t.exportRule}},[t._v("导出")])],1),e("div",{staticClass:"ml-3 mr-3"},[e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:t.open}})],1)],1),e("div",[t.showTextArea?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.displayMultilineText,expression:"displayMultilineText"}],staticClass:"form-control",staticStyle:{"background-color":"gray",color:"white"},attrs:{rows:"3",placeholder:"输入规则"},domProps:{value:t.displayMultilineText},on:{input:[function(e){e.target.composing||(t.displayMultilineText=e.target.value)},function(e){return t.updateMultilineText(e.target.value)}]}}):t._e()])])])},p=[],f=(a("8e6e"),a("456d"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-clamp"},[e("div",{staticClass:"text",style:{height:t.height}},[t.isVisible?e("span",{staticClass:"btn",on:{click:t.toggle}},[t._v(t._s(t.isExpand?"收起":"... 展开"))]):t._e(),e("div",{ref:"textRef",style:t.commonStyle},[t._t("default")],2)])])}),g=[],m={name:"text-clmp",props:{fontSize:{type:Number,default:14},lines:{type:Number,default:1},lineHeight:{type:Number,default:20},selectors:{type:String,default:""}},data:function(){return{isExpand:!1,isVisible:!1,textHeight:0}},computed:{height:function(){return this.isExpand?this.$refs.textRef.clientHeight+"px":Math.min(this.lines*this.lineHeight,this.textHeight)+"px"},commonStyle:function(){return{lineHeight:this.lineHeight+"px",fontSize:this.fontSize+"px"}}},mounted:function(){var t=this;this.init();var e=new MutationObserver((function(e){e.forEach((function(e){"characterData"===e.type&&t.init()}))}));e.observe(this.$refs.textRef,{characterData:!0,subtree:!0,childList:!0})},methods:{init:function(){this.isExpand=!1,this.textHeight=this.$refs&&this.$refs.textRef&&this.$refs.textRef.clientHeight||0,this.isVisible=this.textHeight>this.lines*this.lineHeight},toggle:function(){if(this.isExpand=!this.isExpand,!this.isExpand&&this.selectors){var t=document.querySelector(this.selectors);setTimeout((function(){t.scrollIntoView({behavior:"smooth",block:"start",inline:"center"})}),97)}}}},v=m,b=(a("84b7"),a("2877")),y=Object(b["a"])(v,f,g,!1,null,"94dbd87e",null),w=y.exports,_=a("cee4");function S(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?S(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var x={name:"rule-child",components:{TextClamp:w},props:{rule:{type:Object,required:!0},ruleId:{type:Number,required:!0}},data:function(){return{showTextArea:!1}},computed:{ruleData:{get:function(){return this.rule},set:function(t){this.$emit("update:rule",t)}},displayMultilineText:{get:function(){return"object"===Object(s["a"])(this.ruleData.multilineText)?JSON.stringify(this.ruleData.multilineText,null,2):this.ruleData.multilineText},set:function(t){this.updateMultilineText(t)}},warnLevelClass:function(){return{"text-danger":"high"===this.warnLevel,"text-warning":"medium"===this.warnLevel,"text-success":"low"===this.warnLevel}},levelSelectorClass:function(){return{"level-selector-danger":"high"===this.warnLevel,"level-selector-warning":"medium"===this.warnLevel,"level-selector-success":"low"===this.warnLevel}}},mounted:function(){console.log(this.ruleId,this.ruleData.id,this.rule.id)},methods:{changeType:function(){var t="black"==this.ruleData.ruleType?"white":"black";this.ruleData.ruleType=t,this.$emit("update:rule",C({},this.ruleData))},open:function(){var t=this;this.$confirm("确认删除该规则?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRule(),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},updateMultilineText:function(t){try{var e=JSON.parse(t);this.ruleData.multilineText=e}catch(a){this.ruleData.multilineText=t}},exportRule:function(){var t;if("string"===typeof this.ruleData.multilineText)try{t=JSON.parse(this.ruleData.multilineText)}catch(o){return console.error("无法解析 规则内容:",o),void alert("无法导出:规则内容不是有效的 JSON 格式")}else{if("object"!==Object(s["a"])(this.ruleData.multilineText))return console.error("规则内容格式不正确"),void alert("无法导出:规则内容格式不正确");t=this.ruleData.multilineText}var e={multilineText:t,ruleName:this.ruleData.ruleName,warnLevel:this.ruleData.warnLevel,ruleMessage:this.ruleData.ruleMessage,deleted:!1,ruleType:this.ruleData.ruleType};console.log(e);var a=JSON.stringify(e,null,2),n=new Blob([a],{type:"application/yaml"}),r=document.createElement("a");r.href=URL.createObjectURL(n);var i="".concat(this.ruleData.ruleName||"rule",".yaml");r.download=i,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href)},changeShow:function(){this.showTextArea=!this.showTextArea,console.log("showTextArea:",this.showTextArea)},saveInputs:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("规则",this.ruleData),this.$emit("update:rule",C({},this.ruleData)),console.log("启用",this.ruleData.enable),!this.ruleData.enable){t.next=22;break}if(t.prev=4,{ruleName:this.ruleData.ruleName,warnLevel:this.ruleData.warnLevel,ruleMessage:this.ruleData.ruleMessage,deleted:!1},'\n            {\n                {\n                  "MultilineText":'.concat(JSON.stringify(this.ruleData.multilineText),'\n                  "ruleName": ').concat(this.ruleData.ruleName,'\n                  "warnLevel":').concat(this.ruleData.warnLevel,'\n                  "ruleMessage":').concat(this.ruleData.ruleMessage,'\n                  "deleted":fasle\n                  "ruleType":').concat(this.ruleData.ruleType,'\n                  "ruleId":').concat(this.ruleId,"\n                  }\n            }"),"black"!=this.ruleData.ruleType){t.next=13;break}return t.next=10,_["a"].post("http://43.138.200.89:8080/blacklist/set-blacklist",this.ruleData.multilineText);case 10:t.sent,t.next=17;break;case 13:if("white"!=this.ruleData.ruleType){t.next=17;break}return t.next=16,_["a"].post("http://43.138.200.89:8080/blacklist/set-whitelist",this.ruleData.multilineText);case 16:t.sent;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](4),console.error("发送规则到后端时发生错误:",t.t0);case 22:case"end":return t.stop()}}),t,this,[[4,19]])})));function e(){return t.apply(this,arguments)}return e}(),loadInputs:function(){var t=localStorage.getItem("warnLevel_".concat(this.ruleId)),e=localStorage.getItem("ruleName_".concat(this.ruleId)),a=localStorage.getItem("ruleMessage_".concat(this.ruleId)),n=localStorage.getItem("mutilineText_".concat(this.ruleId)),r=localStorage.getItem("enable_".concat(this.ruleId)),i=localStorage.getItem("ruleType_".concat(this.ruleId));this.warnLevel=t,this.ruleName=e,this.ruleMessage=a,this.multilineText=n,this.enable=r,this.ruleType=i,this.$emit("updateRules")},deleteRule:function(){this.$emit("delete",this.ruleId)}}},T=x,j=(a("dd02"),Object(b["a"])(T,h,p,!1,null,null,null)),k=j.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"source-table"},[e("h3",[t._v(t._s(t.title))]),e("div",{staticClass:"row"},t._l(t.paginatedSources,(function(t){return e("div",{key:t.ID,staticClass:"col-md-6"},[e("source-child",{attrs:{source:t}})],1)})),0),e("div",{staticClass:"d-flex justify-content-center mt-4"},[e("button",{staticClass:"btn btn-primary mr-2",attrs:{disabled:1===t.currentPage},on:{click:t.prevPage}},[t._v("上一页")]),e("span",{staticClass:"align-self-center mx-3"},[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("button",{staticClass:"btn btn-primary",attrs:{disabled:t.currentPage===t.totalPages},on:{click:t.nextPage}},[t._v("下一页")])])])},D=[],N=function(){var t=this,e=t._self._c;return e("div",{staticClass:"source-child"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3"},[e("h4",[t._v(t._s(t.source.ID)+". "+t._s(t.source.主机名称))]),e("div",[e("span",{class:["badge",t.getBadgeClass(t.source.危害级别)]},[t._v(t._s(t.source.危害级别))])])]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("开始时间：")]),t._v(" "+t._s(t.source.开始时间)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("结束时间：")]),t._v(" "+t._s(t.source.结束时间)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("行为数：")]),t._v(" "+t._s(t.source.可疑行为数+t.source.危险行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("攻击方数：")]),t._v(" "+t._s(t.source.可疑攻击方数+t.source.危险攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("被攻击方数：")]),t._v(" "+t._s(t.source.可疑被攻击方数+t.source.危险被攻击方数)+"\n          ")]),e("div",{staticClass:"row ablity-button"},[e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showImageModal}},[t._v("查看相关图片")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showReportModal}},[t._v("查看安全报告")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showTableModal}},[t._v("查看行为表格")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showAdviceModal}},[t._v("查看安全建议")])])])]),t.showModalImage?e("div",{staticClass:"modal-overlay",on:{click:t.closeImageModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeImageModal}},[t._v("×")]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingImg,expression:"loadingImg"}],staticClass:"statistics-panel-img col-12",attrs:{"element-loading-text":"加载中..."}},[t.currentImage?e("el-image",{attrs:{src:t.currentImage,fit:"contain","preview-src-list":[t.currentImage]}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e(),e("span",{staticStyle:{display:"block","text-align":"center"}},[t._v(t._s(t.source.文件名))])],1)])]):t._e(),t.showModalReport?e("div",{staticClass:"modal-overlay",on:{click:t.closeReportModal}},[e("div",{staticClass:"modal-content report-modal",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeReportModal}},[t._v("×")]),e("h3",{staticClass:"modal-title"},[t._v("安全报告")]),e("div",{staticClass:"report-container row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingMsg,expression:"loadingMsg"}],staticClass:"statistics-panel",attrs:{"element-loading-text":"加载中..."}},[e("el-collapse-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showMessage,expression:"showMessage"}]},[e("h4",[t._v("统计信息")]),e("p",[t._v("数据总量: "+t._s(t.statistics.dataCount))]),e("h5",[t._v("最危险攻击方:")]),e("ul",t._l(t.statistics.topAttackers,(function(a,n){return e("li",{key:"attacker-"+n},[t._v("\n            "+t._s(a.name)+": "+t._s(a.count)+" 次\n          ")])})),0),e("h5",[t._v("最危险被攻击方:")]),e("ul",t._l(t.statistics.topTargets,(function(a,n){return e("li",{key:"target-"+n},[t._v("\n            "+t._s(a.name)+": "+t._s(a.count)+" 次\n          ")])})),0),e("h5",[t._v("前三种边类型统计：")]),e("ul",t._l(Object.entries(t.edgeTypeStats).slice(0,3),(function(a,n){return e("li",{key:n},[t._v("\n    "+t._s(t.edgeTypeMap[n]||n)+": "+t._s(a)+" 次\n  ")])})),0)])]),e("el-collapse-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showMessage,expression:"!showMessage"}]},[e("h4",[t._v("事件信息")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑行为数：")]),t._v(" "+t._s(t.source.可疑行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑攻击方数：")]),t._v(" "+t._s(t.source.可疑攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑被攻击方数：")]),t._v(" "+t._s(t.source.可疑被攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险行为数：")]),t._v(" "+t._s(t.source.危险行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险攻击方数：")]),t._v(" "+t._s(t.source.危险攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险被攻击方数：")]),t._v(" "+t._s(t.source.危险被攻击方数)+"\n          ")])])]),e("div",{staticClass:"message-button mb-2"},[e("el-button",{on:{click:function(e){t.showMessage=!t.showMessage}}},[t._v("切换信息")])],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSimplifiedGraph,expression:"!showSimplifiedGraph"},{name:"loading",rawName:"v-loading",value:t.loadingGra,expression:"loadingGra"}],staticClass:"echarts-container column",attrs:{id:"echarts-container","element-loading-text":"加载中..."}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSimplifiedGraph,expression:"showSimplifiedGraph"},{name:"loading",rawName:"v-loading",value:t.loadingGra,expression:"loadingGra"}],staticClass:"echarts-container column",attrs:{id:"simplified-graph","element-loading-text":"加载中..."}})]),e("div",{staticClass:"button-container"},[e("button",{staticClass:"btn btn-primary mr-3",on:{click:t.toggleEdgeStyle}},[t._v("\n        "+t._s(t.isStraightLine?"曲线显示":"直线显示")+"\n      ")]),e("button",{staticClass:"btn btn-primary",on:{click:t.showNodeFilter}},[t._v("筛选节点")]),e("button",{staticClass:"btn btn-primary ml-3",on:{click:t.toggleGraph}},[t._v(t._s(t.showSimplifiedGraph?"显示完整溯源图":"显示关键溯源图"))])])])]):t._e(),t.showNodeFilterModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeNodeFilterModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeNodeFilterModal}},[t._v("×")]),e("h3",[t._v("节点筛选")]),e("div",{staticClass:"d-flex justify-content-end"},[e("el-transfer",{attrs:{filterable:"","filter-method":t.filterNodes,"filter-placeholder":"请输入节点名称",data:t.allNodes,titles:["隐藏","显示"]},model:{value:t.visibleNodes,callback:function(e){t.visibleNodes=e},expression:"visibleNodes"}})],1),e("div",{staticClass:"d-flex justify-content-end"},[e("button",{staticClass:"btn btn-primary mt-3",on:{click:t.applyNodeFilter}},[t._v("应用筛选")])])])]):t._e(),t.showNodeModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeNodeModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeNodeModal}},[t._v("×")]),e("h3",[t._v("节点详情")]),e("p",[e("strong",[t._v("名称:")]),t._v(" "+t._s(t.selectedNode.name))]),e("p",[e("strong",[t._v("类型:")]),t._v(" "+t._s(t.selectedNode.type))]),e("button",{staticClass:"hide-node-btn col-2",on:{click:t.hideNode}},[t._v("隐藏此节点")])])]):t._e(),t.showEdgeModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeEdgeModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeEdgeModal}},[t._v("×")]),e("h3",[t._v("边详情")]),t._l(t.selectedEdge.actions,(function(a,n){return e("div",{key:n},[e("p",[e("strong",[t._v("行为:")]),t._v(" "+t._s(a.Action))]),e("p",[e("strong",[t._v("时间:")]),t._v(" "+t._s(t.formatTime(a.Time)))]),e("p",[e("strong",[t._v("危险等级:")]),t._v(" "+t._s(a.危险等级))]),n<t.selectedEdge.actions.length-1?e("hr"):t._e()])}))],2)]):t._e(),t.showTables?e("div",{staticClass:"modal-overlay",on:{click:t.closeTableModal}},[t.showTables?e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeTableModal}},[t._v("×")]),e("div",{staticClass:"col-12"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header row justify-content-between"},[e("div",{staticClass:"table-selector"},[e("label",{attrs:{for:"tableSelect"}},[t._v("选择表格:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedTable,expression:"selectedTable"}],staticClass:"form-select",attrs:{id:"tableSelect"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedTable=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"AlterTable"}},[t._v("可疑行为列表")]),e("option",{attrs:{value:"DangerTable"}},[t._v("危险行为列表")])])]),e("div",{staticClass:"search-bar mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),e("div",{staticClass:"col-12"},[t.CurrentTable?e("card",{attrs:{title:t.CurrentTable.title,subTitle:t.CurrentTable.subTitle}},[e("div",{staticClass:"table",attrs:{slot:"raw-content"},slot:"raw-content"},[e("paper-table",{key:"".concat(t.selectedTable,"-").concat(t.dataUpdateTrigger),attrs:{data:t.filteredData,columns:t.CurrentTable.columns}})],1)]):t._e(),e("div",{staticClass:"page_button"},[e("p-button",{attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handlePrevPage.apply(null,arguments)}}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("p-button",{attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handleNextPage.apply(null,arguments)}}},[t._v("下一页")])],1)],1)])]):t._e()]):t._e(),t.showAdvice?e("div",{staticClass:"modal-overlay",on:{click:t.closeAdviceModal}},[e("div",{staticClass:"modal-content advice-modal",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeAdviceModal}},[t._v("×")]),e("h3",[t._v("安全建议")]),e("el-collapse-transition",[t.showDetailedAdvice?t._e():e("div",[t._l(t.securityAdvice,(function(a,n){return e("p",{key:n},[t._v(t._s(a))])})),e("el-button",{attrs:{type:"primary"},on:{click:t.showDetailedSecurityAdvice}},[t._v("显示详细安全建议")])],2)]),e("el-collapse-transition",[t.showDetailedAdvice?e("div",{staticClass:"detailed-advice"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAi,expression:"loadingAi"}],staticClass:"message",attrs:{"element-loading-text":"加载中..."}},[e("img",{staticClass:"ai-avatar",attrs:{src:a("f01c"),alt:"AI Avatar"}}),e("div",{staticClass:"advice-content"},[e("p",[t._v(t._s(t.detailedSecurityAdvice.content))])])]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showDetailedAdvice=!1}}},[t._v("返回简要建议")])],1):t._e()])],1)]):t._e()])},A=[],M=a("2909"),I=(a("4f7f"),a("f400"),a("313e"));function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var R,F=["时间","主体类型","主体名称","行为","客体类型","客体名称"],L=["时间","主体类型","主体名称","行为","客体类型","客体名称"],$={components:{PaperTable:l["f"]},name:"SourceChild",props:{source:{type:Object,required:!0}},data:function(){return{dataUpdateTrigger:0,loadingAi:!1,loadingImg:!1,loadingMsg:!1,loadingGra:!1,showSimplifiedGraph:!1,showAdvice:!1,showMessage:!0,showTables:!1,showModalImage:!1,showModalReport:!1,showNodeModal:!1,showEdgeModal:!1,showNodeFilterModal:!1,showDetailedAdvice:!1,isStraightLine:!0,selectedNode:null,selectedEdge:null,reportData:null,networkData:null,forceRerender:!1,chart:null,hiddenNodes:[],allNodes:[],visibleNodes:[],allFilteredData:[],selectedTable:"DangerTable",searchText:"",securityAdvice:[],edgeTypeStats:{},edgeTypeMap:{EVENT_RECVFROM:"接收事件",EVENT_SENDTO:"发送事件",EVENT_EXECUTE:"执行事件",EVENT_WRITE:"写入事件",EVENT_READ:"读取事件",EVENT_OPEN:"打开事件",EVENT_CLOSE:"关闭事件"},detailedSecurityAdvice:{type:"ai",content:"",typedText:"",typeIndex:0},statistics:{topAttackers:[],topTargets:[],dataCount:0},AlterTable:{title:"可疑行为列表",subTitle:"",columns:[].concat(F),data:[],options:{pageSize:10,currentPage:1}},DangerTable:{title:"危险行为列表",subTitle:"",columns:[].concat(L),data:[],options:{pageSize:10,currentPage:1}}}},mounted:function(){window.addEventListener("resize",this.resizeChart),this.fetchReports()},beforeDestroy:function(){this.chart&&this.chart.dispose(),this.simplifiedChart&&this.simplifiedChart.dispose(),window.removeEventListener("resize",this.resizeChart)},computed:{currentImage:function(){var t=this.source.图片内容;return t?"data:image/png;base64,".concat(t):""},CurrentTable:function(){return this[this.selectedTable]},currentPage:function(){return this.CurrentTable.options.currentPage},pageSize:function(){return this.CurrentTable.options.pageSize||6},totalItems:function(){return this.allFilteredData.length||0},totalPages:function(){return Math.ceil(this.totalItems/this.pageSize)||1},currentPageData:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.CurrentTable.data.slice(t,e)},filteredData:function(){this.dataUpdateTrigger+=1;var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.allFilteredData.slice(t,e)}},watch:{searchText:function(t){this.updateAllFilteredData()},CurrentTable:function(){this.updateAllFilteredData()}},methods:{toggleGraph:function(){var t=this;this.showSimplifiedGraph=!this.showSimplifiedGraph,console.log("Toggling graph:",this.showSimplifiedGraph),this.$nextTick((function(){setTimeout((function(){t.showSimplifiedGraph?(t.renderSimplifiedEChartsGraph(),t.$nextTick((function(){t.simplifiedChart&&t.simplifiedChart.resize()}))):(t.renderEChartsGraph(),t.$nextTick((function(){t.chart&&t.chart.resize()})))}),100)}))},fetchImage:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.source.图片内容){t.next=16;break}return this.loadingImg=!0,t.prev=2,t.next=5,_["a"].get("http://43.138.200.89:8080/kairos/graph/content",{params:{file_name:this.source.文件名},headers:{"content-type":"application/json"}});case 5:e=t.sent,this.$set(this.source,"图片内容",e.data.file_content),this.$nextTick((function(){a.forceRerender=!a.forceRerender})),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log("溯源图获取出错",t.t0);case 13:return t.prev=13,this.loadingImg=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[2,10,13,16]])})));function e(){return t.apply(this,arguments)}return e}(),showDetailedSecurityAdvice:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.showDetailedAdvice=!0,this.loadingAi=!0,this.detailedSecurityAdvice.content)this.detailedSecurityAdvice.typedText="",this.detailedSecurityAdvice.typeIndex=0,this.typeNextChar(this.detailedSecurityAdvice),this.loadingAi=!1;else{e={networkData:[this.networkData],statistics:[this.statistics]},a="安全事件信息: ".concat(JSON.stringify(e),"\n用户问题:给出详细安全建议");try{_["a"].post("http://43.138.200.89:8080/kairos/completions",{prompt:a}).then((function(t){var e=t.data.advice;n.detailedSecurityAdvice.content=e,n.typeNextChar(n.detailedSecurityAdvice)}))}catch(r){console.error("Error fetching detailed security advice:",r),this.detailedSecurityAdvice.content="抱歉，获取详细安全建议时出现错误。请稍后再试。",this.detailedSecurityAdvice.typedText=this.detailedSecurityAdvice.content,this.loadingAi=!1}finally{this.loadingAi=!1}}case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchDetailedSecrityAdvice:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),typeNextChar:function(t){var e=this;t.typeIndex<t.content.length&&(t.typedText+=t.content.charAt(t.typeIndex),t.typeIndex++,setTimeout((function(){return e.typeNextChar(t)}),50))},calculateStatistics:function(){var t=this,e={},a={};this.edgeTypeStats={},this.networkData.links.forEach((function(n){e[n.source]=(e[n.source]||0)+1,a[n.target]=(a[n.target]||0)+1,n.actions.forEach((function(e){var a=t.edgeTypeMap[e.Action]||e.Action;t.edgeTypeStats[a]=(t.edgeTypeStats[a]||0)+1}))}));var n=function(t){return Object.entries(t).sort((function(t,e){return e[1]-t[1]})).map((function(t){var e=Object(i["a"])(t,2),a=e[0],n=e[1];return{name:a,count:n}}))},r=this.networkData.links.length<1e3?3:6;this.edgeTypeStats=Object.entries(this.edgeTypeStats).sort((function(t,e){return e[1]-t[1]})).reduce((function(t,e){var a=Object(i["a"])(e,2),n=a[0],r=a[1];return t[n]=r,t}),{}),this.statistics={topAttackers:n(e).slice(0,r),topTargets:n(a).slice(0,r),dataCount:this.networkData.links.length},console.log("Calculated statistics:",this.statistics),console.log("Edge type statistics:",this.edgeTypeStats)},generateSecurityAdvice:function(){var t=this;if(this.securityAdvice=[],this.statistics.topAttackers.length>0){var e=this.statistics.topAttackers[0].name;this.securityAdvice.push("".concat(e," 节点作为最频繁的攻击方较为危险，建议加强其防护和监控。"))}if(this.statistics.topTargets.length>0){var a=this.statistics.topTargets[0].name;this.securityAdvice.push("".concat(a," 节点作为最常被攻击的目标较为脆弱，建议对其进行全面检查与必要的隔离措施。"))}var n=["接收事件","发送事件","执行事件","写入事件","读取事件","打开事件","关闭事件"];n.forEach((function(e){var a=t.edgeTypeStats[e]||0,n="";switch(e){case"接收事件":a>0&&(n="检测到 ".concat(a," 次接收事件，建议审查入站流量，确保数据来源可信，并检查是否存在未经授权的数据接收。"));break;case"发送事件":a>0&&(n="发现 ".concat(a," 次发送事件，建议监控出站连接，防止可能的数据外泄，并确保所有外发数据都经过适当的加密和授权。"));break;case"执行事件":a>0&&(n="存在 ".concat(a," 次执行事件，建议审查所有被执行的程序，确保它们都是经过授权和安全的。考虑实施应用程序白名单策略。"));break;case"写入事件":a>0&&(n="检测到 ".concat(a," 次写入事件，建议监控文件系统变更，防止恶意软件写入或重要文件被篡改。考虑实施文件完整性监控。"));break;case"读取事件":a>0&&"检测到 ".concat(a," 次读取事件，建议审查文件访问权限，确保敏感数据不被未授权访问。考虑实施数据加密、访问日志记录，并监控异常的读取模式，如大量或频繁读取敏感文件。同时，评估是否存在数据泄露的风险，并确保所有读取操作都有正当理由。");case"打开事件":a>0&&(n="有 ".concat(a," 次文件或资源打开事件，建议审查访问控制策略，确保只有授权用户和进程能够访问敏感资源。"));break;case"关闭事件":a>0&&(n="记录到 ".concat(a," 次关闭事件，虽然这通常是正常行为，但建议检查是否有异常的资源使用模式，例如频繁的打开后立即关闭。"));break}n&&t.securityAdvice.push(n)})),this.statistics.dataCount>1e3?this.securityAdvice.push("鉴于大量的交互行为，建议加强整体网络安全策略，并考虑实施更严格的访问控制措施。"):this.securityAdvice.push("虽然交互行为数量不多，仍建议定期检查和更新安全策略，以防潜在威胁。")},updateAllFilteredData:function(){var t=this.searchText.trim().toLowerCase();this.allFilteredData=t?this.CurrentTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))})):this.CurrentTable.data,this.dataUpdateTrigger+=1},handlePrevPage:function(){this.CurrentTable.options.currentPage>1&&this.CurrentTable.options.currentPage--},handleNextPage:function(){this.CurrentTable.options.currentPage<this.totalPages&&this.CurrentTable.options.currentPage++},hideNode:function(){this.selectedNode&&(this.hiddenNodes.push(this.selectedNode.name),this.closeNodeModal(),this.updateGraph())},initNodeFilterData:function(){var t=this;this.allNodes=this.networkData.nodes.map((function(t,e){return{key:e,label:t.name,disabled:!1}})),this.visibleNodes=this.allNodes.filter((function(e){return!t.hiddenNodes.includes(e.label)})).map((function(t){return t.key}))},filterNodes:function(t,e){return e.label.toLowerCase().indexOf(t.toLowerCase())>-1},applyNodeFilter:function(){var t=this,e=this.allNodes.filter((function(e){return!t.visibleNodes.includes(e.key)})).map((function(t){return t.label}));this.hiddenNodes=e,this.updateGraph(),this.closeNodeFilterModal()},updateGraph:function(){var t=this,e=this.networkData.nodes.filter((function(e){return!t.hiddenNodes.includes(e.name)})),a=this.networkData.links.filter((function(e){return!t.hiddenNodes.includes(e.source)&&!t.hiddenNodes.includes(e.target)}));this.chart.setOption({series:[{data:e,links:a}]}),this.toggleGraph(),this.toggleGraph()},resizeChart:function(){this.chart&&this.chart.resize(),this.simplifiedChart&&this.simplifiedChart.resize()},getBadgeClass:function(t){switch(t.toLowerCase()){case"high":return"bg-danger";case"medium":return"bg-warning";case"low":return"bg-success";default:return"bg-secondary"}},showImageModal:function(){this.showModalImage=!0,this.fetchImage()},showTableModal:function(){this.showTables=!0},showReportModal:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.showModalReport=!0,t.next=3,this.$nextTick();case 3:return t.next=5,this.fetchReports();case 5:this.initChart(),this.initSimpleChart(),this.showSimplifiedGraph?this.renderSimplifiedEChartsGraph():this.renderEChartsGraph();case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showAdviceModal:function(){this.generateSecurityAdvice(),this.showAdvice=!0},closeImageModal:function(){this.showModalImage=!1},closeReportModal:function(){this.showModalReport=!1,this.chart&&(this.chart.dispose(),this.chart=null),this.simplifiedChart&&(this.simplifiedChart.dispose(),this.simplifiedChart=null)},closeTableModal:function(){this.showTables=!1},closeAdviceModal:function(){this.showAdvice=!1},fetchReports:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingMsg=!0,this.loadingGra=!0,t.prev=2,e=new Date(this.source.开始时间.replace(/-/g,"/")),a=new Date(this.source.结束时间.replace(/-/g,"/")),e.getTime()===a.getTime()&&a.setSeconds(a.getSeconds()+1),n=function(t){var e=function(t){return(t<10?"0":"")+t};return"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1),"-").concat(e(t.getDate())," ").concat(e(t.getHours()),":").concat(e(t.getMinutes()),":").concat(e(t.getSeconds()))},r=n(a),this.source.结束时间=r,t.next=11,_["a"].get("http://43.138.200.89:8080/kairos/graph-actions",{params:{graph_index:this.source.文件名.slice(0,-4)},headers:{"content-type":"application/json"}});case 11:return i=t.sent,this.reportData=i.data,null==this.reportData.dangerous_actions.data&&(this.reportData.dangerous_actions.data=[]),this.AlterTable.data=this.processActionData(this.reportData.anomalous_actions.data),this.DangerTable.data=this.processActionData(this.reportData.dangerous_actions.data),this.createInitialNetworkData(),t.next=19,this.updateNetworkData();case 19:this.calculateStatistics(),this.$nextTick((function(){s.initChart(),s.initSimpleChart()})),this.dataUpdateTrigger+=1,t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](2),console.error("Error fetching reports:",t.t0);case 27:return t.prev=27,this.loadingMsg=!1,this.loadingGra=!1,this.dataUpdateTrigger+=1,t.finish(27);case 32:case"end":return t.stop()}}),t,this,[[2,24,27,32]])})));function e(){return t.apply(this,arguments)}return e}(),processActionData:function(t){var e=this;return t.map((function(t){return{"时间":e.formatTime(t.Time),"主体类型":t.SubjectType,"主体名称":t.SubjectName,"行为":t.Action,"客体类型":t.ObjectType,"客体名称":t.ObjectName}}))},createInitialNetworkData:function(){var t=new Map,e=new Map,a=function(a,n){t.has(a.SubjectName)||t.set(a.SubjectName,{name:a.SubjectName,value:a.SubjectName,SubjectType:a.SubjectType}),t.has(a.ObjectName)||t.set(a.ObjectName,{name:a.ObjectName,value:a.ObjectName,ObjectType:a.ObjectType});var r="".concat(a.SubjectName,"-").concat(a.ObjectName);e.has(r)||e.set(r,{source:a.SubjectName,target:a.ObjectName,actions:[],hasDangerousAction:!1});var i=e.get(r);i.actions.push(E(E({},a),{},{"危险等级":n})),"危险"===n&&(i.hasDangerousAction=!0)};this.reportData.anomalous_actions.data.forEach((function(t){return a(t,"可疑")})),this.reportData.dangerous_actions.data.forEach((function(t){return a(t,"危险")})),this.networkData={nodes:Array.from(t.values()),links:Array.from(e.values()).map((function(t){return E(E({},t),{},{value:t.actions.length,id:"".concat(t.source,"-").concat(t.target)})}))}},updateNetworkData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([_["a"].get("http://43.138.200.89:8080/kairos/graph-subjects",{params:{graph_index:this.source.文件名.slice(0,-4)}}),_["a"].get("http://43.138.200.89:8080/kairos/graph-objects",{params:{graph_index:this.source.文件名.slice(0,-4)}})]);case 2:e=t.sent,a=Object(i["a"])(e,2),n=a[0],r=a[1],s=new Set(n.data.dangerous_subjects.data.map((function(t){return t.SubjectName}))),o=new Set(n.data.anomalous_subjects.data.map((function(t){return t.SubjectName}))),c=new Set(r.data.dangerous_objects.data.map((function(t){return t.SubjectName}))),l=new Set(r.data.anomalous_objects.data.map((function(t){return t.SubjectName}))),this.networkData.nodes=this.networkData.nodes.map((function(t){return E(E({},t),{},{isDangerousSubject:s.has(t.name),isSuspiciousSubject:o.has(t.name),isDangerousObject:c.has(t.name),isSuspiciousObject:l.has(t.name)})}));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initChart:function(){var t=document.getElementById("echarts-container");t?(this.chart=I["init"](t),this.renderEChartsGraph()):console.error("ECharts container not found")},initSimpleChart:function(){var t=document.getElementById("simplified-graph");t?(this.simplifiedChart=I["init"](t),this.renderSimplifiedEChartsGraph()):console.error("ECharts container not found")},toggleEdgeStyle:function(){this.isStraightLine=!this.isStraightLine,this.renderEChartsGraph(),this.renderSimplifiedEChartsGraph()},renderEChartsGraph:function(){var t=this,e=document.getElementById("echarts-container");this.chart||(this.chart=I["init"](e));Math.max.apply(Math,Object(M["a"])(this.networkData.links.map((function(t){return t.value}))));var a={title:{text:"完整溯源图",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:function(t){return"edge"===t.dataType?"".concat(t.data.source," -> ").concat(t.data.target,"<br/>Actions: ").concat(t.data.value):t.name}},graphic:[{type:"group",left:10,top:80,children:[{type:"circle",shape:{r:8},style:{fill:"#FF0000",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"危险节点",font:"14px Arial",fill:"#333"}}]},{type:"group",left:10,top:140,children:[{type:"circle",shape:{r:8},style:{fill:"#0000FF",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"可疑节点",font:"14px Arial",fill:"#333"}}]}],series:[{type:"graph",layout:"none",data:this.networkData.nodes.filter((function(e){return!t.hiddenNodes.includes(e.name)})).map((function(e){return E(E({},e),{},{itemStyle:{color:t.getNodeColor(e),borderColor:"#000",borderWidth:1}})})),links:this.networkData.links.filter((function(e){return!t.hiddenNodes.includes(e.source)&&!t.hiddenNodes.includes(e.target)})).map((function(e){return E(E({},e),{},{lineStyle:{color:t.getLinkColor(e)}})})),roam:!0,label:{show:!1,position:"right",formatter:"{b}",fontSize:12},lineStyle:{curveness:this.isStraightLine?0:.3},emphasis:{focus:"adjacency",lineStyle:{width:4},label:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,8],draggable:!0,cursor:"pointer",symbolSize:function(e,a){var n=t.networkData.links.filter((function(t){return t.source===a.name||t.target===a.name}));return Math.min(10+2*n.length,30)},itemStyle:{color:"#4169E1",borderColor:"#000",borderWidth:1}}]};this.setNodePositions(a.series[0].data),this.chart.setOption(a),this.addChartClickListeners(),this.loadingGra=!1},getLinkColor:function(t){return t.hasDangerousAction?"#FF0000":"#0000FF"},getNodeColor:function(t){return t.isDangerousSubject||t.isDangerousObject?"#FF0000":t.isDangerousSubject||t.isDangerousObject?"#4169E1":"#0000FF"},getNodeCategory:function(t){return t.isDangerousSubject&&t.isDangerousObject?"危险主体和客体":t.isDangerousSubject?"危险主体":t.isDangerousObject?"危险客体":t.isSuspiciousSubject||t.isSuspiciousObject?"可疑节点":"普通节点"},setNodePositions:function(t){var e=t.length,a=Math.max(50*e,1e7);t.forEach((function(t,n){var r=n/e*2*Math.PI;t.x=a*Math.cos(r),t.y=a*Math.sin(r)}))},renderSimplifiedEChartsGraph:function(){var t=this;try{var e=document.getElementById("simplified-graph");this.simplifiedChart||(this.simplifiedChart=I["init"](e));var a=JSON.parse(JSON.stringify(this.networkData.nodes)),n=JSON.parse(JSON.stringify(this.networkData.links)),r=["mount","PIPE","tmp",".conf",".so",".swp","default"],i=[".sh","mv","cp","rm"];a=a.filter((function(t){return!!i.some((function(e){return t.name.includes(e)}))||!r.some((function(e){return t.name.includes(e)}))}));var s=a.map((function(t){return t.name}));n=n.filter((function(t){return s.includes(t.source)&&s.includes(t.target)}));var o=new Set([].concat(Object(M["a"])(n.map((function(t){return t.source}))),Object(M["a"])(n.map((function(t){return t.target})))));a=a.filter((function(t){return o.has(t.name)}));var c={title:{text:"关键溯源图",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:function(t){return"edge"===t.dataType?"".concat(t.data.source," -> ").concat(t.data.target,"<br/>Actions: ").concat(t.data.value):t.name}},legend:{data:[{name:"既是危险攻击方又是危险被攻击方",icon:"circle"},{name:"危险攻击方",icon:"circle"},{name:"危险被攻击方",icon:"circle"},{name:"可疑节点",icon:"circle"}],textStyle:{color:"#333"},left:10,top:50,orient:"vertical",itemWidth:25,itemHeight:14,itemStyle:{borderColor:"#000",borderWidth:1}},graphic:[{type:"group",left:10,top:80,children:[{type:"circle",shape:{r:8},style:{fill:"#FF0000",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"危险节点",font:"14px Arial",fill:"#333"}}]},{type:"group",left:10,top:140,children:[{type:"circle",shape:{r:8},style:{fill:"#0000FF",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"可疑节点",font:"14px Arial",fill:"#333"}}]}],series:[{type:"graph",layout:"none",data:a.map((function(e){return E(E({},e),{},{itemStyle:{color:t.getNodeColor(e),borderColor:"#000",borderWidth:1}})})),links:n.map((function(e){return E(E({},e),{},{lineStyle:{color:t.getLinkColor(e)}})})),roam:!0,label:{show:!0,position:"right",formatter:"{b}",fontSize:10},lineStyle:{curveness:this.isStraightLine?0:.3},emphasis:{focus:"adjacency",lineStyle:{width:4},label:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,8],draggable:!0,cursor:"pointer",symbolSize:function(t,e){var a=n.filter((function(t){return t.source===e.name||t.target===e.name}));return Math.min(10+2*a.length,30)},itemStyle:{color:"#4169E1",borderColor:"#000",borderWidth:1}}]};this.setNodePositions(c.series[0].data),this.simplifiedChart.setOption(c),this.addSimplifiedChartClickListeners()}catch(l){console.log("chart error:",l)}},addSimplifiedChartClickListeners:function(){var t=this;this.simplifiedChart.on("click",(function(e){"node"===e.dataType?t.showNodeDetails(e.data):"edge"===e.dataType&&t.showEdgeDetails(e.data)}))},calculateLineWidth:function(t,e){var a=1,n=5;return 0===e||0===t?a:a+Math.log(t)/Math.log(e)*(n-a)},addChartClickListeners:function(){var t=this;this.chart.on("click",(function(e){"node"===e.dataType?t.showNodeDetails(e.data):"edge"===e.dataType&&t.showEdgeDetails(e.data)}))},showNodeDetails:function(t){this.selectedNode={name:t.name,type:t.SubjectType||t.ObjectType},this.showNodeModal=!0},showEdgeDetails:function(t){var e=this,a=t.actions.some((function(t){return e.reportData.dangerous_actions.data.some((function(e){return t.Time===e.Time&&t.SubjectName===e.SubjectName&&t.ObjectName===e.ObjectName}))}));this.selectedEdge={source:t.source,target:t.target,actions:t.actions||[],dangerLevel:a?"危险":"可疑"},this.showEdgeModal=!0},showNodeFilter:function(){this.showNodeFilterModal=!0,this.initNodeFilterData()},closeNodeFilterModal:function(){this.showNodeFilterModal=!1},closeNodeModal:function(){this.showNodeModal=!1,this.selectedNode=null},closeEdgeModal:function(){this.showEdgeModal=!1,this.selectedEdge=null},formatTime:function(t){if(!t)return"Invalid timestamp";var e=new Date(Number(t)/1e6);return isNaN(e.getTime())?"Invalid date":e.toLocaleString()}}},z=$,V=(a("6ef1"),Object(b["a"])(z,N,A,!1,null,"576b200e",null)),G=V.exports,U={name:"source-table",components:{SourceChild:G},props:{sources:{type:Array,required:!0},title:{type:String,default:"警告信息"}},data:function(){return{currentPage:1,pageSize:4,displayedSources:[]}},computed:{totalPages:function(){return Math.ceil(this.sources.length/this.pageSize)},paginatedSources:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.sources.slice(t,e)}},methods:{prevPage:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.currentPage>1&&this.currentPage--;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),nextPage:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.currentPage<this.totalPages&&this.currentPage++;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){}},W=U,J=Object(b["a"])(W,O,D,!1,null,null,null),B=J.exports;function H(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=K(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw i}}}}function K(t,e){if(t){if("string"==typeof t)return q(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}var Y=["时间","类型","名称","危险等级"],X=["时间","类型","名称","危险等级"],Q=["时间","主体类型","主体名称","行为","客体类型","客体名称"],Z=["时间","主体类型","主体名称","行为","客体类型","客体名称"],tt={components:{SourceTable:B,RuleChild:k,StatsCard:l["g"],PaperTable:l["f"],ChartCard:l["c"],Chartist:d.a},data:function(){var t;return t={currentWebPage:"",dataUpdateTrigger:0,ruleTypeFilter:"all",allFilteredData:[],fileList:[],dialogVisible:!1,searchText:"",showTable:!1,rules:JSON.parse(localStorage.getItem("rules"))||[{ruleName:"sql注入",ruleMessage:"1号",multilineText:"",enable:!0,warnLevel:"high",deleted:!1,ruleType:"black"},{ruleName:"55555",ruleMessage:"2号",multilineText:"",enable:!0,warnLevel:"low",deleted:!1,ruleType:"white"},{}],tableData:{title:"预警列表",subTitle:"",columns:["ID","创建时间","更新时间","目标名称","目标类型"],data:[{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:0,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"},{ID:11,"创建时间":"2024-07-17 10:00","更新时间":"IP","目标名称":"192.168.1.1","目标类型":"高"}],options:{pageSize:10,currentPage:1}},mode:"",loadingSource:!1,loadingWeek:!1},Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(t,"dataUpdateTrigger",0),"progressVisible",!1),"progress",0),"showActionTable",!0),"showTextArea",!1),"selectedUploadType","file"),"selectedFile",null),"manualInput",""),"allFilteredData",[]),"selectedTable","AttackerTable"),Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(t,"searchText",""),"dialogVisible",!1),"analysisTimeRange",{beginTime:"2018-04-06 00:00:00",endTime:"2018-04-12 00:00:00"}),"fileList",[]),"subjectTypes",[{value:20,name:"netflow"},{value:30,name:"lsof"}]),"objectTypes",{}),"subjectNames",[{name:"",value:0,series:[0,0,0,0,0,0,0]}]),"objectNames",[{name:"",value:0,series:[0,0,0,0,0,0,0]}]),"analysisMethod",[{value:"high",label:"high"},{value:"medium",label:"medium"},{value:"low",label:"low"},{value:"cadets-e3",label:"cadets-e3"}]),"uploadMethod",[{value:"file",label:"文件上传"},{value:"manual",label:"手动输入"}]),Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(t,"modelConfigVisible",!1),"activeTab","artifactsPath"),"modelConfig",{ARTIFACT_DIR:"./artifact/",MODEL_NAME:"cadets3_models",LOSS_FACTOR:1.5,MAX_AVG_LOSS:10,MIN_AVG_LOSS:4.7}),"statsCards",[{type:"warning",icon:"ti-server",title:"攻击方",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-reload",loading:!1},{type:"success",icon:"ti-wallet",title:"被攻击方",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-calendar",loading:!1},{type:"danger",icon:"ti-pulse",title:"异常行为",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-timer",loading:!1}]),"AttackerTable",{title:"攻击源列表",subTitle:"",columns:[].concat(Y),data:[],options:{pageSize:10,currentPage:1}}),"AttackedTable",{title:"被攻击方列表",subTitle:"",columns:[].concat(X),data:[],options:{pageSize:10,currentPage:1}}),"AlterTable",{title:"可疑行为列表",subTitle:"",columns:[].concat(Q),data:[],options:{pageSize:10,currentPage:2}}),"DangerTable",{title:"危险行为列表",subTitle:"",columns:[].concat(Z),data:[],options:{pageSize:10,currentPage:1}}),"EventTable",{title:"警告信息",data:[],ids:[]}),"loading",!1),Object(c["a"])(Object(c["a"])(t,"searchText",""),"MapTable",{title:"警告信息",data:[],ids:[]})},computed:{currentPage:function(){return this.tableData.options.currentPage},pageSize:function(){return this.tableData.options.pageSize},totalItems:function(){return this.allFilteredData.length},totalPages:function(){return Math.ceil(this.totalItems/this.pageSize)||1},filteredData:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.allFilteredData.slice(t,e)},filteredRules:function(){var t=this;return"all"===this.ruleTypeFilter?this.rules:this.rules.filter((function(e){return e.ruleType===t.ruleTypeFilter}))},filteredSources:function(){if(!this.searchText)return this.MapTable.data;var t=this.searchText.toLowerCase();return this.MapTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))}))}},mounted:function(){this.initRulesPage(),this.initAnalysisPage(),this.initEventsPage()},watch:{searchText:function(t){this.updateAllFilteredData()},currentWebPage:function(t,e){switch(t){case"analysis":this.initAnalysisPage();break;case"rules":this.initRulesPage();break;case"events":this.initEventsPage();break}}},methods:(R={handleSelect:function(t,e){this.currentWebPage=t},initAnalysisPage:function(){this.fetchConfig(),this.checkEngineStatus()},initRulesPage:function(){this.fetchBlackList(),localStorage.getItem("rules")?this.loadRules():this.saveRules(),this.setupAudit()},initEventsPage:function(){this.fetchMapData()},setupAudit:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].post("http://43.138.200.89:8080/data/setup-audit",'{"paths":["/home/ubuntu/softbei/KIDS/Backend", "/home/ubuntu/softbei/KIDS/Frontend"]}');case 3:t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log("set up audit error:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}(),updateAllFilteredData:function(){console.log("过滤数据",this.allFilteredData);var t=this.searchText.trim().toLowerCase();t?this.allFilteredData=this.tableData.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))})):(this.allFilteredData=this.tableData.data,console.log("过滤数据",this.allFilteredData)),this.dataUpdateTrigger+=1},toggleView:function(){this.showTable=!this.showTable,this.showTable},handlePreview:function(t){var e=this,a=new FileReader;a.onload=function(t){try{var a=JSON.parse(t.target.result),n=JSON.stringify(a,null,2),r='<pre style="white-space: pre-wrap; word-wrap: break-word;">'.concat(n,"</pre>");e.$alert(r,"文件内容预览",{dangerouslyUseHTMLString:!0,customClass:"json-preview-dialog",closeOnClickModal:!0,closeOnPressEscape:!0})}catch(i){e.$message.error("无法解析 JSON 文件: "+i.message)}},a.readAsText(t.raw)},handleChange:function(t,e){this.fileList=e.filter((function(t){return t.name.endsWith(".yaml")})),this.fileList.length!==e.length&&this.$message.warning("只支持 .yaml 文件，非 yaml 文件已被过滤")},handleRemove:function(t,e){this.fileList=e,this.$message({message:"文件 ".concat(t.name," 已被移除"),type:"info"})},handleUpload:function(){return Promise.resolve()},submitUpload:function(){var t=this;if(0!==this.fileList.length){var e=this.fileList.map((function(e){return t.readFileAsJSON(e.raw)}));Promise.all(e).then((function(e){e.forEach((function(e){e.success?t.importRule(e.data):t.$message.error("文件 ".concat(e.fileName," 导入失败：").concat(e.error))})),t.dialogVisible=!1,t.fileList=[]})).catch((function(e){console.error("处理文件时发生错误:",e),t.$message.error("导入过程中发生错误，请检查文件格式")}))}else this.$message.warning("请先选择文件")},readFileAsJSON:function(t){return new Promise((function(e){var a=new FileReader;a.onload=function(a){try{var n=JSON.parse(a.target.result);e({success:!0,data:n,fileName:t.name})}catch(r){e({success:!1,error:"文件不是有效的yaml格式",fileName:t.name})}},a.readAsText(t)}))},importRule:function(t){if(!(t.ruleName&&t.warnLevel&&t.ruleMessage&&t.multilineText))throw new Error("JSON文件格式不正确或缺少必要字段");var e={ruleName:t.ruleName,warnLevel:t.warnLevel,ruleMessage:t.ruleMessage,multilineText:"object"===Object(s["a"])(t.multilineText)?JSON.stringify(t.multilineText,null,2):t.multilineText,enable:void 0===t.enable||t.enable,showTextArea:!1,ruleType:t.ruleType,id:t.id};this.rules.some((function(t){return t.ruleName===e.ruleName}))?this.$message.warning('规则 "'.concat(e.ruleName,'" 已存在，将被跳过')):(this.rules.push(e),this.saveRules(),this.$message.success('规则 "'.concat(e.ruleName,'" 导入成功！')))},showUploadDialog:function(){this.dialogVisible=!0},clearLocalStorage:function(){localStorage.clear(),this.rules=[]},showLocalStorage:function(){console.log("存储",JSON.parse(localStorage.getItem("rules"))),console.log("数组",this.rules)},deleteRule:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var a,n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=this.rules.findIndex((function(t){return t.id===e})),-1!==a){t.next=4;break}return console.error("未找到对应的规则"),t.abrupt("return");case 4:if(n=this.rules[a],n.deleted=!0,r='"ruleText":{\n  '.concat(n.multilineText,'\n}\n{\n  "ruleMessgae":[\n    {\n      "ruleName": ').concat(n.ruleName,'\n      "warnLevel":').concat(n.warnLevel,'\n      "ruleMessage":').concat(n.ruleMessage,'\n      "deleted":true,\n      "ruleType":').concat(n.ruleType,"\n    }\n  ]\n}"),this.rules.splice(a,1),t.prev=8,"black"!=this.deleteRule.ruleType){t.next=16;break}return t.next=12,_["a"].post("http://43.138.200.89:8080/blacklist/set-blacklist",r);case 12:i=t.sent,console.log("规则成功发送到后端:",i.data),t.next=21;break;case 16:if("white"!=this.deleteRule.ruleType){t.next=21;break}return t.next=19,_["a"].post("http://43.138.200.89:8080/blacklist/set-whitelist",r);case 19:s=t.sent,console.log("规则成功发送到后端:",s.data);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](8),console.log(t.t0);case 26:console.log(this.rules),this.removeRuleFromLocalStorage(e),this.saveRules(),this.loadRules();case 30:case"end":return t.stop()}}),t,this,[[8,23]])})));function e(e){return t.apply(this,arguments)}return e}(),removeRuleFromLocalStorage:function(t){localStorage.removeItem("ruleName_".concat(t)),localStorage.removeItem("warnLevel_".concat(t)),localStorage.removeItem("ruleMessage_".concat(t)),localStorage.removeItem("multilineText_".concat(t)),localStorage.removeItem("enable_".concat(t)),localStorage.removeItem("ruleType_".concat(t))},saveRules:function(){localStorage.setItem("rules",JSON.stringify(this.rules))},addEmptyRule:function(){var t={id:Date.now(),ruleName:"",ruleMessage:"",multilineText:"",enable:!1,warnLevel:"",deleted:!1,ruleType:"black"};console.log(t.ruleType),this.rules.push(t),this.saveRules(),this.loadRules()},loadRules:function(){var t=JSON.parse(localStorage.getItem("rules"))||[];this.rules=Array.isArray(t)?t:[]},updateRules:function(){this.loadRules()},handlePrevPage:function(){this.tableData.options.currentPage>1&&this.tableData.options.currentPage--},handleNextPage:function(){this.tableData.options.currentPage<this.totalPages&&this.tableData.options.currentPage++},fetchBlackList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].get("http://43.138.200.89:8080/blacklist/get-blacklist");case 3:e=t.sent,a=e.data,n=[],r=H(a);try{for(r.s();!(i=r.n()).done;)s=i.value,console.log(s),n.push({ID:s.ID,"创建时间":s.CreatedAt.slice(0,19),"更新时间":s.UpdatedAt.slice(0,19),"目标名称":s.TargetName,"目标类型":s.TargetType})}catch(o){r.e(o)}finally{r.f()}this.tableData.data=n,this.updateAllFilteredData(),this.dataUpdateTrigger+=1,this.searchText="1",this.searchText="",t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),console.error("获取黑名单告警失败:",t.t0);case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function e(){return t.apply(this,arguments)}return e}(),fetchMapData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,_["a"].get("http://43.138.200.89:8080/kairos/graph/info",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json;charset=utf-8"}});case 4:e=t.sent,e.data&&e.data.data&&(this.MapTable.data=e.data.data.map((function(t,e){var n=a.extractTimeInfo(t.file_name),r=["low","medium","high"],i=r[Math.floor(Math.random()*r.length)];return 0==t.dangerous_action_count&&0==t.dangerous_subject_count&&0==t.dangerous_object_count?i="low":0!=t.dangerous_action_count||0!=t.dangerous_subject_count||0!=t.dangerous_object_count&&t.dangerous_action_count*t.dangerous_subject_count*t.dangerous_object_count==0?i="medium":0!=t.dangerous_action_count&&0!=t.dangerous_subject_count&&0!=t.dangerous_object_count&&(i="high"),{ID:e+1,"开始时间":n.startTime,"结束时间":n.endTime,"可疑行为数":t.anomalous_action_count,"可疑攻击方数":t.anomalous_subject_count,"可疑被攻击方数":t.anomalous_object_count,"危险行为数":t.dangerous_action_count,"危险攻击方数":t.dangerous_subject_count,"危险被攻击方数":t.dangerous_object_count,"危害级别":i,"文件名":a.extractFileName(t.file_name)}})),this.MapTable.total=e.data.total),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("获取警告数据时出错:",t.t0);case 11:return t.prev=11,this.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])})));function e(){return t.apply(this,arguments)}return e}(),extractFileName:function(t){var e=t.replace(/[^0-9\-: ~._^a-z]/g,":"),a=e.match(/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+~\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+)(.+)/);return a?a[1]+a[2]:e},extractTimeInfo:function(t){var e=t.match(/(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)~(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)/);if(e){var a=function(t){var e=t.replace(/[^0-9 -]/g,""),a=e.split(" "),n=Object(i["a"])(a,2),r=n[0],s=n[1],o=r.split("-").map(Number),c=Object(i["a"])(o,3),l=c[0],u=c[1],d=c[2],h=parseInt(s.substr(0,2)),p=parseInt(s.substr(2,2)),f=parseInt(s.substr(4,2));new Date(Date.UTC(l,u-1,d,h,p,f));return"".concat(l,"-").concat(String(u).padStart(2,"0"),"-").concat(String(d).padStart(2,"0")," ").concat(String(h).padStart(2,"0"),":").concat(String(p).padStart(2,"0"),":").concat(String(f).padStart(2,"0"))};return{startTime:a(e[1]),endTime:a(e[3])}}return{startTime:"未知",endTime:"未知"}},showModelConfig:function(){this.modelConfigVisible=!0},saveModelConfig:function(){console.log("Saving model config:",this.modelConfig);try{this.updateAllConfigs(),this.$message.success("模型配置已保存")}catch(t){console.log("保存错误",t)}this.modelConfigVisible=!1},fetchData:function(){try{this.fetchAlertData(),this.fetchAttackedData(),this.fetchAttackerData(),this.fetchEventData()}catch(t){console.log("分析数据错误",t)}},toggleActionView:function(){this.showActionTable=!this.showActionTable}},Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(R,"showUploadDialog",(function(){this.dialogVisible=!0})),"handlePreview",(function(t){var e=this;if("application/json"===t.raw.type){var a=new FileReader;a.onload=function(t){try{var a=JSON.parse(t.target.result),n=JSON.stringify(a,null,2),r='<pre style="white-space: pre-wrap; word-wrap: break-word;">'.concat(n,"</pre>");e.$alert(r,"文件内容预览",{dangerouslyUseHTMLString:!0,customClass:"json-preview-dialog",closeOnClickModal:!0,closeOnPressEscape:!0})}catch(i){e.$message.error("无法解析 JSON 文件: "+i.message)}},a.readAsText(t.raw)}else this.$message.error("只能预览 json 文件")})),"handleRemove",(function(t,e){this.fileList=e,this.$message({message:"文件 ".concat(t.name," 已被移除"),type:"info"})})),"submitUpload",(function(){this.selectedFile?(this.dialogVisible=!1,this.uploadFile()):this.$message.warning("请先选择文件")})),"changeShow",(function(){return this.showTextArea=!this.showTextArea,this.showTextArea})),"sendManualInput",(function(){})),"submitMultilineText",(function(){})),"updateAllFilteredData",(function(){var t=this.searchText.trim().toLowerCase();this.allFilteredData=t?this.CurrentTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))})):this.CurrentTable.data,this.dataUpdateTrigger+=1})),"formatDate_date",(function(t){var e=function(t){return t<10?"0"+t:t},a=t.getFullYear(),n=e(t.getMonth()+1),r=e(t.getDate()),i=e(t.getHours()),s=e(t.getMinutes()),o=e(t.getSeconds());return"".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(s,":").concat(o)})),"handlePrevPage",(function(){this.CurrentTable.options.currentPage>1&&this.CurrentTable.options.currentPage--})),Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(R,"handleNextPage",(function(){this.CurrentTable.options.currentPage<this.totalPages&&this.CurrentTable.options.currentPage++})),"fetchAttackerData",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(s,":").concat(o)},this.statsCards[0].loading=!0,t.next=4,_["a"].get("http://43.138.200.89:8080/kairos/subjects",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:a=t.sent,n=[],r=H(a.data.anomalous_subjects.data);try{for(r.s();!(i=r.n()).done;)s=i.value,n.push({"时间":e(s.Time),"类型":s.SubjectType,"名称":s.SubjectName,"危险等级":"可疑"})}catch(u){r.e(u)}finally{r.f()}o=H(a.data.dangerous_subjects.data);try{for(o.s();!(c=o.n()).done;)l=c.value,n.push({"时间":e(l.Time),"类型":l.SubjectType,"名称":l.SubjectName,"危险等级":"危险"})}catch(u){o.e(u)}finally{o.f()}this.statsCards[0].value=a.data.anomalous_subjects.total.toString()+"/"+a.data.dangerous_subjects.total.toString(),this.statsCards[0].loading=!1,this.AttackerTable.data=this.AttackerTable.data.concat(n),this.dataUpdateTrigger+=1,this.updateAllFilteredData();case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()),"fetchAttackedData",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(s,":").concat(o)},this.statsCards[1].loading=!0,t.next=4,_["a"].get("http://43.138.200.89:8080/kairos/objects",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:a=t.sent,n=[],r=H(a.data.anomalous_objects.data);try{for(r.s();!(i=r.n()).done;)s=i.value,n.push({"时间":e(s.Time),"类型":s.ObjectType,"名称":s.ObjectName,"危险等级":"可疑"})}catch(u){r.e(u)}finally{r.f()}o=H(a.data.dangerous_objects.data);try{for(o.s();!(c=o.n()).done;)l=c.value,n.push({"时间":e(l.Time),"类型":l.ObjectType,"名称":l.ObjectName,"危险等级":"危险"})}catch(u){o.e(u)}finally{o.f()}this.statsCards[1].value=a.data.anomalous_objects.total.toString()+"/"+a.data.dangerous_objects.total.toString(),this.statsCards[1].loading=!1,this.AttackedTable.data=this.AttackedTable.data.concat(n);case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()),"fetchAlertData",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s,o,c,l,u,d,h,p,f,g,m,v,b,y,w,S,C,x,T;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(s,":").concat(o)},this.loadingWeek=!0,this.statsCards[2].loading=!0,t.next=5,_["a"].get("http://43.138.200.89:8080/kairos/actions",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 5:a=t.sent,n={},r={},i={},s={},o=["EVENT_RECVFROM","EVENT_SENDTO","EVENT_EXECUTE","EVENT_WRITE","EVENT_READ","EVENT_OPEN","EVENT_CLOSE"],c=[],l=[],u=a.data.anomalous_actions.data,d=a.data.dangerous_actions.data,h=H(u);try{for(h.s();!(p=h.n()).done;)f=p.value,c.push({"时间":e(f.Time),"主体类型":f.SubjectType,"主体名称":f.SubjectName,"行为":f.Action,"客体类型":f.ObjectType,"客体名称":f.ObjectName})}catch(j){h.e(j)}finally{h.f()}g=H(d);try{for(g.s();!(m=g.n()).done;)v=m.value,l.push({"时间":e(v.Time),"主体类型":v.SubjectType,"主体名称":v.SubjectName,"行为":v.Action,"客体类型":v.ObjectType,"客体名称":v.ObjectName})}catch(j){g.e(j)}finally{g.f()}b=u.concat(a.data.dangerous_actions.data),b.forEach((function(t){var e=t.SubjectName,a=t.ObjectName,c=o.indexOf(t.Action);i[e]||(i[e]={name:e,value:0,series:[0,0,0,0,0,0,0]}),i[e].value+=1,i[e].series[c]+=1,s[a]||(s[a]={name:a,value:0,series:[0,0,0,0,0,0,0]}),s[a].value+=1,s[a].series[c]+=1,n[t.SubjectType]=(n[t.SubjectType]||0)+1,r[t.ObjectType]=(r[t.ObjectType]||0)+1})),this.statsCards[2].value="1537/15",this.statsCards[2].loading=!1,this.AlterTable.data=this.AttackerTable.data.concat(c),this.DangerTable.data=this.DangerTable.data.concat(l),this.subjectTypes=n,this.objectTypes=r,y=Object.values(i),w=Object.values(s),S=y.sort((function(t,e){return e.value-t.value})),C=S.slice(0,6),x=w.sort((function(t,e){return e.value-t.value})),T=x.slice(0,6),this.subjectNames=Object.values(C),this.objectNames=Object.values(T),this.loadingWeek=!1;case 36:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()),"fetchEventData",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,_["a"].get("http://43.138.200.89:8080/kairos/graph/info",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:e=t.sent,e.data&&e.data.data&&(this.EventTable.data=e.data.data.map((function(t,e){var n=a.extractTimeInfo(t.file_name),r=["low","medium","high"],i=r[Math.floor(Math.random()*r.length)];return{ID:e+1,"开始时间":n.startTime,"结束时间":n.endTime,"可疑行为数":t.anomalous_action_count,"可疑攻击方数":t.anomalous_subject_count,"可疑被攻击方数":t.anomalous_object_count,"危险行为数":t.dangerous_action_count,"危险攻击方数":t.dangerous_subject_count,"危险被攻击方数":t.dangerous_object_count,"危害级别":i,"文件名":a.extractFileName(t.file_name)}})),this.EventTable.total=e.data.total),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("获取警告数据时出错:",t.t0);case 11:return t.prev=11,this.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])})));function e(){return t.apply(this,arguments)}return e}()),"extractFileName",(function(t){var e=t.replace(/[^0-9\-: ~._^a-z]/g,":"),a=e.match(/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+~\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+)(.+)/);return a?a[1]+a[2]:e})),"extractTimeInfo",(function(t){var e=t.match(/(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)~(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)/);if(e){var a=function(t){var e=t.replace(/[^0-9 -]/g,""),a=e.split(" "),n=Object(i["a"])(a,2),r=n[0],s=n[1],o=r.split("-").map(Number),c=Object(i["a"])(o,3),l=c[0],u=c[1],d=c[2],h=parseInt(s.substr(0,2)),p=parseInt(s.substr(2,2)),f=parseInt(s.substr(4,2));new Date(Date.UTC(l,u-1,d,h,p,f));return"".concat(l,"-").concat(String(u).padStart(2,"0"),"-").concat(String(d).padStart(2,"0")," ").concat(String(h).padStart(2,"0"),":").concat(String(p).padStart(2,"0"),":").concat(String(f).padStart(2,"0"))};return{startTime:a(e[1]),endTime:a(e[3])}}return{startTime:"未知",endTime:"未知"}})),"handleFileChange",(function(t){this.selectedFile=t.raw,console.log("选择的文件",this.selectedFile)})),"uploadFile",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.selectedFile){t.next=18;break}return t.prev=1,e=new FormData,e.append("file",this.selectedFile),t.next=6,_["a"].post("http://43.138.200.89:8080/data/upload-log",e,{headers:{"Content-Type":"multipart/form-data"}});case 6:t.sent,this.$message.success("文件上传成功。"),this.selectedFile=null,this.$refs.upload.clearFiles(),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),console.error(t.t0),this.$message.error("文件上传失败");case 16:t.next=19;break;case 18:this.$message.warning("请选择要上传的文件。");case 19:case"end":return t.stop()}}),t,this,[[1,12]])})));function e(){return t.apply(this,arguments)}return e}()),"showProgressBar",(function(){var t=this;this.progressVisible=!0,this.progress=0;var e=Math.floor(30001*Math.random()+2e4),a=setInterval((function(){if(t.progress<100){var e=5*Math.random();e=Math.random()<.5?Math.round(10*e)/10:Math.floor(e),t.progress=Math.min(100,t.progress+e)}else clearInterval(a),t.hideProgressBar(),t.fetchData()}),1e3);setTimeout((function(){clearInterval(a),t.progress=100,t.hideProgressBar(),t.fetchData()}),e)})),Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(R,"hideProgressBar",(function(){this.progressVisible=!1,this.progress=0})),"handleFetchFailure",(function(){this.hideLoading(),this.$message.error("无法获取分析数据，请稍后重试或联系管理员。")})),"sendManualInput",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.manualInput.trim()){t.next=15;break}return t.prev=1,t.next=4,_["a"].post("/api/manual-input",{data:this.manualInput});case 4:e=t.sent,alert("数据发送成功："+e.data.message),this.manualInput="",t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error("发送错误：",t.t0),this.$message.error("上传失败，请重试。"+t.t0.message);case 13:t.next=16;break;case 15:this.$message.warning("请选择要发送的数据。");case 16:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(){return t.apply(this,arguments)}return e}()),"fetchConfig",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].get("http://43.138.200.89:8080/config/view");case 3:e=t.sent,this.modelConfig=e.data.config,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("获取配置失败:",t.t0),this.$message.error("获取配置失败,请重试");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()),"updateConfig",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,a){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=encodeURIComponent(e),r=this.customEncodeURIComponent(a),console.log("更新配置",e,a),t.next=6,_["a"].get("http://43.138.200.89:8080/config/update/".concat(n,"/").concat(r));case 6:i=t.sent,i.data&&"200 OK"==i.data.Status?this.$message.success("参数 ".concat(e," 更新成功")):this.$message.warning("参数 ".concat(e," 更新可能未成功，请检查")),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.error("更新配置失败:",t.t0),this.$message.error("更新配置失败: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[0,10]])})));function e(e,a){return t.apply(this,arguments)}return e}()),"customEncodeURIComponent",(function(t){return encodeURIComponent(t).replace(/%2F/g,"|")})),"checkEngineStatus",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].get("http://43.138.200.89:8080/ping");case 3:e=t.sent,"pong!\n"===e.data.Msg?this.$message.success("KIDS Engine 运行正常"):this.$message.warning("KIDS Engine 状态异常"),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("检查引擎状态失败:",t.t0),this.$message.error("无法连接到 KIDS Engine");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()),"updateAllConfigs",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=0,a=Object.entries(this.modelConfig);case 1:if(!(e<a.length)){t.next=8;break}return n=Object(i["a"])(a[e],2),r=n[0],s=n[1],t.next=5,this.updateConfig(r,s);case 5:e++,t.next=1;break;case 8:this.$message.success("所有配置更新完成");case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()),"triggerAnalysis",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="2018-04-01 00:00:00",a="2018-04-12 00:00:00",n="run",this.updateAllConfigs(),t.prev=4,t.next=7,_["a"].get("http://43.138.200.89:8080/api/".concat(n,"/").concat(e,"/").concat(a));case 7:this.$message.success("溯源分析已启动"),this.showProgressBar(),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](4),console.error("启动分析失败:",t.t0),this.$message.error("启动溯源分析失败,请重试");case 15:case"end":return t.stop()}}),t,this,[[4,11]])})));function e(){return t.apply(this,arguments)}return e}())),beforeDestroy:function(){this.saveRules()}},et=tt,at=(a("306e"),Object(b["a"])(et,n,r,!1,null,null,null));e["default"]=at.exports},"456d":function(t,e,a){var n=a("4bf8"),r=a("0d58");a("5eda")("keys",(function(){return function(t){return r(n(t))}}))},4917:function(t,e,a){"use strict";var n=a("cb7c"),r=a("9def"),i=a("0390"),s=a("5f1b");a("214f")("match",1,(function(t,e,a,o){return[function(a){var n=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,n):new RegExp(a)[e](String(n))},function(t){var e=o(a,t,this);if(e.done)return e.value;var c=n(t),l=String(this);if(!c.global)return s(c,l);var u=c.unicode;c.lastIndex=0;var d,h=[],p=0;while(null!==(d=s(c,l))){var f=String(d[0]);h[p]=f,""===f&&(c.lastIndex=i(l,r(c.lastIndex),u)),p++}return 0===p?null:h}]}))},"4f7f":function(t,e,a){"use strict";var n=a("c26b"),r=a("b39a"),i="Set";t.exports=a("e0b8")(i,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return n.def(r(this,i),t=0===t?0:t,t)}},n)},"55dd":function(t,e,a){"use strict";var n=a("5ca1"),r=a("d8e8"),i=a("4bf8"),s=a("79e5"),o=[].sort,c=[1,2,3];n(n.P+n.F*(s((function(){c.sort(void 0)}))||!s((function(){c.sort(null)}))||!a("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(i(this)):o.call(i(this),r(t))}})},"5df3":function(t,e,a){"use strict";var n=a("02f4")(!0);a("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=n(e,a),this._i+=t.length,{value:t,done:!1})}))},"5eda":function(t,e,a){var n=a("5ca1"),r=a("8378"),i=a("79e5");t.exports=function(t,e){var a=(r.Object||{})[t]||Object[t],s={};s[t]=e(a),n(n.S+n.F*i((function(){a(1)})),"Object",s)}},"67ab":function(t,e,a){var n=a("ca5a")("meta"),r=a("d3f4"),i=a("69a8"),s=a("86cc").f,o=0,c=Object.isExtensible||function(){return!0},l=!a("79e5")((function(){return c(Object.preventExtensions({}))})),u=function(t){s(t,n,{value:{i:"O"+ ++o,w:{}}})},d=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,n)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[n].i},h=function(t,e){if(!i(t,n)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[n].w},p=function(t){return l&&f.NEED&&c(t)&&!i(t,n)&&u(t),t},f=t.exports={KEY:n,NEED:!1,fastKey:d,getWeak:h,onFreeze:p}},"6b54":function(t,e,a){"use strict";a("3846");var n=a("cb7c"),r=a("0bfb"),i=a("9e1e"),s="toString",o=/./[s],c=function(t){a("2aba")(RegExp.prototype,s,t,!0)};a("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?c((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?r.call(t):void 0)})):o.name!=s&&c((function(){return o.call(this)}))},"6ef1":function(t,e,a){"use strict";a("9ded")},"7bbc":function(t,e,a){var n=a("6821"),r=a("9093").f,i={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(t){try{return r(t)}catch(e){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==i.call(t)?o(t):r(n(t))}},"7f50":function(t,e,a){},"84b7":function(t,e,a){"use strict";a("3c48")},8615:function(t,e,a){var n=a("5ca1"),r=a("504c")(!1);n(n.S,"Object",{values:function(t){return r(t)}})},"8a81":function(t,e,a){"use strict";var n=a("7726"),r=a("69a8"),i=a("9e1e"),s=a("5ca1"),o=a("2aba"),c=a("67ab").KEY,l=a("79e5"),u=a("5537"),d=a("7f20"),h=a("ca5a"),p=a("2b4c"),f=a("37c8"),g=a("3a72"),m=a("d4c0"),v=a("1169"),b=a("cb7c"),y=a("d3f4"),w=a("4bf8"),_=a("6821"),S=a("6a99"),C=a("4630"),x=a("2aeb"),T=a("7bbc"),j=a("11e9"),k=a("2621"),O=a("86cc"),D=a("0d58"),N=j.f,A=O.f,M=T.f,I=n.Symbol,P=n.JSON,E=P&&P.stringify,R="prototype",F=p("_hidden"),L=p("toPrimitive"),$={}.propertyIsEnumerable,z=u("symbol-registry"),V=u("symbols"),G=u("op-symbols"),U=Object[R],W="function"==typeof I&&!!k.f,J=n.QObject,B=!J||!J[R]||!J[R].findChild,H=i&&l((function(){return 7!=x(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a}))?function(t,e,a){var n=N(U,e);n&&delete U[e],A(t,e,a),n&&t!==U&&A(U,e,n)}:A,K=function(t){var e=V[t]=x(I[R]);return e._k=t,e},q=W&&"symbol"==typeof I.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof I},Y=function(t,e,a){return t===U&&Y(G,e,a),b(t),e=S(e,!0),b(a),r(V,e)?(a.enumerable?(r(t,F)&&t[F][e]&&(t[F][e]=!1),a=x(a,{enumerable:C(0,!1)})):(r(t,F)||A(t,F,C(1,{})),t[F][e]=!0),H(t,e,a)):A(t,e,a)},X=function(t,e){b(t);var a,n=m(e=_(e)),r=0,i=n.length;while(i>r)Y(t,a=n[r++],e[a]);return t},Q=function(t,e){return void 0===e?x(t):X(x(t),e)},Z=function(t){var e=$.call(this,t=S(t,!0));return!(this===U&&r(V,t)&&!r(G,t))&&(!(e||!r(this,t)||!r(V,t)||r(this,F)&&this[F][t])||e)},tt=function(t,e){if(t=_(t),e=S(e,!0),t!==U||!r(V,e)||r(G,e)){var a=N(t,e);return!a||!r(V,e)||r(t,F)&&t[F][e]||(a.enumerable=!0),a}},et=function(t){var e,a=M(_(t)),n=[],i=0;while(a.length>i)r(V,e=a[i++])||e==F||e==c||n.push(e);return n},at=function(t){var e,a=t===U,n=M(a?G:_(t)),i=[],s=0;while(n.length>s)!r(V,e=n[s++])||a&&!r(U,e)||i.push(V[e]);return i};W||(I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(a){this===U&&e.call(G,a),r(this,F)&&r(this[F],t)&&(this[F][t]=!1),H(this,t,C(1,a))};return i&&B&&H(U,t,{configurable:!0,set:e}),K(t)},o(I[R],"toString",(function(){return this._k})),j.f=tt,O.f=Y,a("9093").f=T.f=et,a("52a7").f=Z,k.f=at,i&&!a("2d00")&&o(U,"propertyIsEnumerable",Z,!0),f.f=function(t){return K(p(t))}),s(s.G+s.W+s.F*!W,{Symbol:I});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)p(nt[rt++]);for(var it=D(p.store),st=0;it.length>st;)g(it[st++]);s(s.S+s.F*!W,"Symbol",{for:function(t){return r(z,t+="")?z[t]:z[t]=I(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){B=!0},useSimple:function(){B=!1}}),s(s.S+s.F*!W,"Object",{create:Q,defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:at});var ot=l((function(){k.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return k.f(w(t))}}),P&&s(s.S+s.F*(!W||l((function(){var t=I();return"[null]"!=E([t])||"{}"!=E({a:t})||"{}"!=E(Object(t))}))),"JSON",{stringify:function(t){var e,a,n=[t],r=1;while(arguments.length>r)n.push(arguments[r++]);if(a=e=n[1],(y(e)||void 0!==t)&&!q(t))return v(e)||(e=function(t,e){if("function"==typeof a&&(e=a.call(this,t,e)),!q(e))return e}),n[1]=e,E.apply(P,n)}}),I[R][L]||a("32e9")(I[R],L,I[R].valueOf),d(I,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},"8e6e":function(t,e,a){var n=a("5ca1"),r=a("990b"),i=a("6821"),s=a("11e9"),o=a("f1ae");n(n.S,"Object",{getOwnPropertyDescriptors:function(t){var e,a,n=i(t),c=s.f,l=r(n),u={},d=0;while(l.length>d)a=c(n,e=l[d++]),void 0!==a&&o(u,e,a);return u}})},9744:function(t,e,a){"use strict";var n=a("4588"),r=a("be13");t.exports=function(t){var e=String(r(this)),a="",i=n(t);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(a+=e);return a}},"990b":function(t,e,a){var n=a("9093"),r=a("2621"),i=a("cb7c"),s=a("7726").Reflect;t.exports=s&&s.ownKeys||function(t){var e=n.f(i(t)),a=r.f;return a?e.concat(a(t)):e}},"9ded":function(t,e,a){},a2cc:function(t,e,a){},a481:function(t,e,a){"use strict";var n=a("cb7c"),r=a("4bf8"),i=a("9def"),s=a("4588"),o=a("0390"),c=a("5f1b"),l=Math.max,u=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};a("214f")("replace",2,(function(t,e,a,g){return[function(n,r){var i=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,i,r):a.call(String(i),n,r)},function(t,e){var r=g(a,t,this,e);if(r.done)return r.value;var d=n(t),h=String(this),p="function"===typeof e;p||(e=String(e));var v=d.global;if(v){var b=d.unicode;d.lastIndex=0}var y=[];while(1){var w=c(d,h);if(null===w)break;if(y.push(w),!v)break;var _=String(w[0]);""===_&&(d.lastIndex=o(h,i(d.lastIndex),b))}for(var S="",C=0,x=0;x<y.length;x++){w=y[x];for(var T=String(w[0]),j=l(u(s(w.index),h.length),0),k=[],O=1;O<w.length;O++)k.push(f(w[O]));var D=w.groups;if(p){var N=[T].concat(k,j,h);void 0!==D&&N.push(D);var A=String(e.apply(void 0,N))}else A=m(T,h,j,k,D,e);j>=C&&(S+=h.slice(C,j)+A,C=j+T.length)}return S+h.slice(C)}];function m(t,e,n,i,s,o){var c=n+t.length,l=i.length,u=p;return void 0!==s&&(s=r(s),u=h),a.call(o,u,(function(a,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(c);case"<":o=s[r.slice(1,-1)];break;default:var u=+r;if(0===u)return a;if(u>l){var h=d(u/10);return 0===h?a:h<=l?void 0===i[h-1]?r.charAt(1):i[h-1]+r.charAt(1):a}o=i[u-1]}return void 0===o?"":o}))}}))},ac4d:function(t,e,a){a("3a72")("asyncIterator")},aef6:function(t,e,a){"use strict";var n=a("5ca1"),r=a("9def"),i=a("d2c8"),s="endsWith",o=""[s];n(n.P+n.F*a("5147")(s),"String",{endsWith:function(t){var e=i(this,t,s),a=arguments.length>1?arguments[1]:void 0,n=r(e.length),c=void 0===a?n:Math.min(r(a),n),l=String(t);return o?o.call(e,l,c):e.slice(c-l.length,c)===l}})},b39a:function(t,e,a){var n=a("d3f4");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},c26b:function(t,e,a){"use strict";var n=a("86cc").f,r=a("2aeb"),i=a("dcbc"),s=a("9b43"),o=a("f605"),c=a("4a59"),l=a("01f9"),u=a("d53b"),d=a("7a56"),h=a("9e1e"),p=a("67ab").fastKey,f=a("b39a"),g=h?"_s":"size",m=function(t,e){var a,n=p(e);if("F"!==n)return t._i[n];for(a=t._f;a;a=a.n)if(a.k==e)return a};t.exports={getConstructor:function(t,e,a,l){var u=t((function(t,n){o(t,u,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[g]=0,void 0!=n&&c(n,a,t[l],t)}));return i(u.prototype,{clear:function(){for(var t=f(this,e),a=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete a[n.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var a=f(this,e),n=m(a,t);if(n){var r=n.n,i=n.p;delete a._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),a._f==n&&(a._f=r),a._l==n&&(a._l=i),a[g]--}return!!n},forEach:function(t){f(this,e);var a,n=s(t,arguments.length>1?arguments[1]:void 0,3);while(a=a?a.n:this._f){n(a.v,a.k,this);while(a&&a.r)a=a.p}},has:function(t){return!!m(f(this,e),t)}}),h&&n(u.prototype,"size",{get:function(){return f(this,e)[g]}}),u},def:function(t,e,a){var n,r,i=m(t,e);return i?i.v=a:(t._l=i={i:r=p(e,!0),k:e,v:a,p:n=t._l,n:void 0,r:!1},t._f||(t._f=i),n&&(n.n=i),t[g]++,"F"!==r&&(t._i[r]=i)),t},getEntry:m,setStrong:function(t,e,a){l(t,e,(function(t,a){this._t=f(t,e),this._k=a,this._l=void 0}),(function(){var t=this,e=t._k,a=t._l;while(a&&a.r)a=a.p;return t._t&&(t._l=a=a?a.n:t._t._f)?u(0,"keys"==e?a.k:"values"==e?a.v:[a.k,a.v]):(t._t=void 0,u(1))}),a?"entries":"values",!a,!0),d(e)}}},cd1c:function(t,e,a){var n=a("e853");t.exports=function(t,e){return new(n(t))(e)}},d4c0:function(t,e,a){var n=a("0d58"),r=a("2621"),i=a("52a7");t.exports=function(t){var e=n(t),a=r.f;if(a){var s,o=a(t),c=i.f,l=0;while(o.length>l)c.call(t,s=o[l++])&&e.push(s)}return e}},dd02:function(t,e,a){"use strict";a("a2cc")},e0b8:function(t,e,a){"use strict";var n=a("7726"),r=a("5ca1"),i=a("2aba"),s=a("dcbc"),o=a("67ab"),c=a("4a59"),l=a("f605"),u=a("d3f4"),d=a("79e5"),h=a("5cc5"),p=a("7f20"),f=a("5dbc");t.exports=function(t,e,a,g,m,v){var b=n[t],y=b,w=m?"set":"add",_=y&&y.prototype,S={},C=function(t){var e=_[t];i(_,t,"delete"==t||"has"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,a){return e.call(this,0===t?0:t,a),this})};if("function"==typeof y&&(v||_.forEach&&!d((function(){(new y).entries().next()})))){var x=new y,T=x[w](v?{}:-0,1)!=x,j=d((function(){x.has(1)})),k=h((function(t){new y(t)})),O=!v&&d((function(){var t=new y,e=5;while(e--)t[w](e,e);return!t.has(-0)}));k||(y=e((function(e,a){l(e,y,t);var n=f(new b,e,y);return void 0!=a&&c(a,m,n[w],n),n})),y.prototype=_,_.constructor=y),(j||O)&&(C("delete"),C("has"),m&&C("get")),(O||T)&&C(w),v&&_.clear&&delete _.clear}else y=g.getConstructor(e,t,m,w),s(y.prototype,a),o.NEED=!0;return p(y,t),S[t]=y,r(r.G+r.W+r.F*(y!=b),S),v||g.setStrong(y,t,m),y}},e853:function(t,e,a){var n=a("d3f4"),r=a("1169"),i=a("2b4c")("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),n(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},f1ae:function(t,e,a){"use strict";var n=a("86cc"),r=a("4630");t.exports=function(t,e,a){e in t?n.f(t,e,r(0,a)):t[e]=a}},f400:function(t,e,a){"use strict";var n=a("c26b"),r=a("b39a"),i="Map";t.exports=a("e0b8")(i,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=n.getEntry(r(this,i),t);return e&&e.v},set:function(t,e){return n.def(r(this,i),0===t?0:t,e)}},n,!0)},f576:function(t,e,a){"use strict";var n=a("5ca1"),r=a("2e08"),i=a("a25f"),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i);n(n.P+n.F*s,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})}}]);
//# sourceMappingURL=chunk-2e43f7f7.7b88ab05.js.map