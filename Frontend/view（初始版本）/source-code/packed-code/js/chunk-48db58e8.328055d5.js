(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48db58e8"],{1169:function(t,e,a){var n=a("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"37c8":function(t,e,a){e.f=a("2b4c")},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3a72":function(t,e,a){var n=a("7726"),r=a("8378"),s=a("2d00"),i=a("37c8"),o=a("86cc").f;t.exports=function(t){var e=r.Symbol||(r.Symbol=s?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:i.f(t)})}},"6b54":function(t,e,a){"use strict";a("3846");var n=a("cb7c"),r=a("0bfb"),s=a("9e1e"),i="toString",o=/./[i],c=function(t){a("2aba")(RegExp.prototype,i,t,!0)};a("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?c((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!s&&t instanceof RegExp?r.call(t):void 0)})):o.name!=i&&c((function(){return o.call(this)}))},"7bbc":function(t,e,a){var n=a("6821"),r=a("9093").f,s={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(t){try{return r(t)}catch(e){return i.slice()}};t.exports.f=function(t){return i&&"[object Window]"==s.call(t)?o(t):r(n(t))}},"7f6e":function(t,e,a){"use strict";a("9a45")},"8a81":function(t,e,a){"use strict";var n=a("7726"),r=a("69a8"),s=a("9e1e"),i=a("5ca1"),o=a("2aba"),c=a("67ab").KEY,l=a("79e5"),u=a("5537"),d=a("7f20"),p=a("ca5a"),f=a("2b4c"),h=a("37c8"),g=a("3a72"),m=a("d4c0"),b=a("1169"),v=a("cb7c"),y=a("d3f4"),C=a("4bf8"),T=a("6821"),w=a("6a99"),S=a("4630"),_=a("2aeb"),x=a("7bbc"),j=a("11e9"),O=a("2621"),k=a("86cc"),A=a("0d58"),N=j.f,E=k.f,D=x.f,M=n.Symbol,I=n.JSON,P=I&&I.stringify,R="prototype",F=f("_hidden"),L=f("toPrimitive"),V={}.propertyIsEnumerable,$=u("symbol-registry"),U=u("symbols"),z=u("op-symbols"),W=Object[R],B="function"==typeof M&&!!O.f,G=n.QObject,J=!G||!G[R]||!G[R].findChild,q=s&&l((function(){return 7!=_(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a}))?function(t,e,a){var n=N(W,e);n&&delete W[e],E(t,e,a),n&&t!==W&&E(W,e,n)}:E,H=function(t){var e=U[t]=_(M[R]);return e._k=t,e},K=B&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},X=function(t,e,a){return t===W&&X(z,e,a),v(t),e=w(e,!0),v(a),r(U,e)?(a.enumerable?(r(t,F)&&t[F][e]&&(t[F][e]=!1),a=_(a,{enumerable:S(0,!1)})):(r(t,F)||E(t,F,S(1,{})),t[F][e]=!0),q(t,e,a)):E(t,e,a)},Y=function(t,e){v(t);var a,n=m(e=T(e)),r=0,s=n.length;while(s>r)X(t,a=n[r++],e[a]);return t},Q=function(t,e){return void 0===e?_(t):Y(_(t),e)},Z=function(t){var e=V.call(this,t=w(t,!0));return!(this===W&&r(U,t)&&!r(z,t))&&(!(e||!r(this,t)||!r(U,t)||r(this,F)&&this[F][t])||e)},tt=function(t,e){if(t=T(t),e=w(e,!0),t!==W||!r(U,e)||r(z,e)){var a=N(t,e);return!a||!r(U,e)||r(t,F)&&t[F][e]||(a.enumerable=!0),a}},et=function(t){var e,a=D(T(t)),n=[],s=0;while(a.length>s)r(U,e=a[s++])||e==F||e==c||n.push(e);return n},at=function(t){var e,a=t===W,n=D(a?z:T(t)),s=[],i=0;while(n.length>i)!r(U,e=n[i++])||a&&!r(W,e)||s.push(U[e]);return s};B||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(a){this===W&&e.call(z,a),r(this,F)&&r(this[F],t)&&(this[F][t]=!1),q(this,t,S(1,a))};return s&&J&&q(W,t,{configurable:!0,set:e}),H(t)},o(M[R],"toString",(function(){return this._k})),j.f=tt,k.f=X,a("9093").f=x.f=et,a("52a7").f=Z,O.f=at,s&&!a("2d00")&&o(W,"propertyIsEnumerable",Z,!0),h.f=function(t){return H(f(t))}),i(i.G+i.W+i.F*!B,{Symbol:M});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)f(nt[rt++]);for(var st=A(f.store),it=0;st.length>it;)g(st[it++]);i(i.S+i.F*!B,"Symbol",{for:function(t){return r($,t+="")?$[t]:$[t]=M(t)},keyFor:function(t){if(!K(t))throw TypeError(t+" is not a symbol!");for(var e in $)if($[e]===t)return e},useSetter:function(){J=!0},useSimple:function(){J=!1}}),i(i.S+i.F*!B,"Object",{create:Q,defineProperty:X,defineProperties:Y,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:at});var ot=l((function(){O.f(1)}));i(i.S+i.F*ot,"Object",{getOwnPropertySymbols:function(t){return O.f(C(t))}}),I&&i(i.S+i.F*(!B||l((function(){var t=M();return"[null]"!=P([t])||"{}"!=P({a:t})||"{}"!=P(Object(t))}))),"JSON",{stringify:function(t){var e,a,n=[t],r=1;while(arguments.length>r)n.push(arguments[r++]);if(a=e=n[1],(y(e)||void 0!==t)&&!K(t))return b(e)||(e=function(t,e){if("function"==typeof a&&(e=a.call(this,t,e)),!K(e))return e}),n[1]=e,P.apply(I,n)}}),M[R][L]||a("32e9")(M[R],L,M[R].valueOf),d(M,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},"9a45":function(t,e,a){},ac4d:function(t,e,a){a("3a72")("asyncIterator")},b230:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("div",{staticClass:"top-row"},[e("div",{staticClass:"top-row-left column"},[e("h4",[t._v("分析参数")]),e("div",{staticClass:"row upload-section"},[e("div",{staticClass:"row ml-3"},[e("el-tag",[t._v("上传方式")]),e("el-select",{staticClass:"ml-1 upload-selcter",attrs:{placeholder:"选择上传方式"},model:{value:t.selectedUploadType,callback:function(e){t.selectedUploadType=e},expression:"selectedUploadType"}},t._l(t.uploadMethod,(function(t){return e("el-option",{attrs:{label:t.label,value:t.value}})})),1)],1),"file"===t.selectedUploadType?e("div",{staticClass:"ml-3 row"},[e("el-button",{staticClass:"mt-0 mr-5",on:{click:t.showUploadDialog}},[t._v("选取文件")])],1):"manual"===t.selectedUploadType?e("div",{staticClass:"row align-items-center ml-3"},[e("div",[e("button",{staticClass:"ml-3 mr-3 mt-0",on:{click:t.changeShow}},[t._v(t._s(t.showTextArea?"收起":"展开"))])]),e("div",[e("button",{staticClass:"button upload-button mt-0",attrs:{disabled:!t.manualInput.trim()},on:{click:t.sendManualInput}},[t._v("发送数据")])])]):t._e()]),e("div",{staticClass:"w-100"},[t.showTextArea?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.manualInput,expression:"manualInput"}],staticClass:"form-control w-100 mt-2",staticStyle:{"background-color":"gray",color:"white"},attrs:{rows:"3",placeholder:"输入数据"},domProps:{value:t.manualInput},on:{input:[function(e){e.target.composing||(t.manualInput=e.target.value)},t.submitMultilineText]}}):t._e()]),e("div",{staticClass:"model-mode row mt-2"},[e("div",{staticClass:"row ml-3"},[e("el-tag",[t._v("分析方式")]),e("el-select",{staticClass:"ml-1 upload-selcter",attrs:{placeholder:"选择分析方式"},model:{value:t.modelConfig.MODEL_NAME,callback:function(e){t.$set(t.modelConfig,"MODEL_NAME",e)},expression:"modelConfig.MODEL_NAME"}},t._l(t.analysisMethod,(function(t){return e("el-option",{attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"row mt-0"},[e("el-button",{staticClass:"mt-0 ml-4",attrs:{type:"primary"},on:{click:t.showModelConfig}},[t._v("修改模型配置")])],1)]),e("el-dialog",{attrs:{title:"修改模型配置",visible:t.modelConfigVisible,width:"50%","modal-append-to-body":!1},on:{"update:visible":function(e){t.modelConfigVisible=e}}},[e("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"文件路径",name:"artifactsPath"}},[e("el-form",{attrs:{model:t.modelConfig,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"产物目录"}},[e("el-input",{model:{value:t.modelConfig.ARTIFACT_DIR,callback:function(e){t.$set(t.modelConfig,"ARTIFACT_DIR",e)},expression:"modelConfig.ARTIFACT_DIR"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"存储模型产物的目录路径",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"模型名称"}},[e("el-input",{model:{value:t.modelConfig.MODEL_NAME,callback:function(e){t.$set(t.modelConfig,"MODEL_NAME",e)},expression:"modelConfig.MODEL_NAME"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"模型的名称,更改模型的名称可以使用不同模型",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1)],1)],1),e("el-tab-pane",{attrs:{label:"阈值设置",name:"threshold"}},[e("el-form",{attrs:{model:t.modelConfig,"label-width":"180px"}},[e("el-form-item",{attrs:{label:"损失因子"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0,max:10},model:{value:t.modelConfig.LOSS_FACTOR,callback:function(e){t.$set(t.modelConfig,"LOSS_FACTOR",e)},expression:"modelConfig.LOSS_FACTOR"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"损失函数的因子",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"最大时间窗口阈值"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0},model:{value:t.modelConfig.MAX_AVG_LOSS,callback:function(e){t.$set(t.modelConfig,"MAX_AVG_LOSS",e)},expression:"modelConfig.MAX_AVG_LOSS"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"允许的最大时间窗口阈值",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1),e("el-form-item",{attrs:{label:"最小时间窗口阈值"}},[e("el-input-number",{attrs:{precision:2,step:.1,min:0},model:{value:t.modelConfig.MIN_AVG_LOSS,callback:function(e){t.$set(t.modelConfig,"MIN_AVG_LOSS",e)},expression:"modelConfig.MIN_AVG_LOSS"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"允许的最小时间窗口阈值",placement:"right"}},[e("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1),e("span",{staticClass:"dialog-footer row justify-content-end mr-5",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.modelConfigVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveModelConfig}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{visible:t.dialogVisible,title:"选择文件并上传",width:"50%","modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-change":t.handleFileChange,"auto-upload":!1,"file-list":t.fileList,accept:".json"}},[e("el-button",{staticClass:"mt-0",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),e("span",{staticClass:"dialog-footer row justify-content-end",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"mb-0",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("\n                确 认\n              ")]),e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1),e("span",{staticClass:"justify-content-center row mt-3 mb-2"},[e("el-button",{on:{click:t.triggerAnalysis}},[t._v("开始分析")])],1),t.progressVisible?e("el-progress",{staticClass:"justify-content-center",attrs:{percentage:t.progress,format:t.format,"stroke-width":20}}):t._e()],1),e("div",{staticClass:"top-row-right column"},[e("div",{staticClass:"row"},t._l(t.statsCards,(function(a){return e("div",{key:a.title,staticClass:"col-md-6 col-lg-6 mb-3"},[e("stats-card",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"stats.loading"}],staticClass:"h-100"},[e("div",{staticClass:"icon-big text-center",class:"icon-".concat(a.type),attrs:{slot:"header"},slot:"header"},[e("i",{class:a.icon})]),e("div",{staticClass:"numbers",attrs:{slot:"content"},slot:"content"},[e("p",[t._v(t._s(a.title))]),e("p",[t._v(t._s(a.subTitle))]),t._v("\n          "+t._s(a.value)+"\n        ")])])],1)})),0)])]),e("div",{staticClass:"bottom-row mt-3"},[e("div",{staticClass:"row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-4",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"被攻击方类型",chartLibrary:"echarts",chartData:t.objectTypes,"chart-type":"Pie"}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-8",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"最多次被攻击方","sub-title":"演示数据",chartLibrary:"echarts",chartType:"Bar",chartData:t.objectNames}})],1)]),e("div",{staticClass:"row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-4",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"攻击方类型",chartLibrary:"echarts",chartData:t.subjectTypes,"chart-type":"Pie"}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeek,expression:"loadingWeek"}],staticClass:"col-8",attrs:{"element-loading-text":"加载中..."}},[e("chart-card",{attrs:{title:"最多次攻击方","sub-title":"演示数据",chartLibrary:"echarts",chartType:"Bar",chartData:t.subjectNames}})],1)])]),e("div",{staticClass:"bottom-row mt-3"},[e("div",{staticClass:"d-flex justify-content-start mb-3"},[e("el-button",{attrs:{type:"primary"},on:{click:t.toggleView}},[t._v("\n        "+t._s(t.showActionTable?"显示安全事件":"显示行为表格")+"\n      ")])],1),t.showActionTable?e("div",{staticClass:"action-table"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"table-selector"},[e("label",{attrs:{for:"tableSelect"}},[t._v("选择表格:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedTable,expression:"selectedTable"}],staticClass:"form-select",attrs:{id:"tableSelect"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedTable=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"AttackerTable"}},[t._v("攻击源列表")]),e("option",{attrs:{value:"AttackedTable"}},[t._v("被攻击方列表")]),e("option",{attrs:{value:"AlterTable"}},[t._v("可疑行为列表")]),e("option",{attrs:{value:"DangerTable"}},[t._v("危险行为列表")])])]),e("div",{staticClass:"search-bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),t.CurrentTable?e("div",{staticClass:"col-12"},[t.CurrentTable?e("card",{attrs:{title:t.CurrentTable.title,subTitle:t.CurrentTable.subTitle}},[e("div",{staticClass:"table",attrs:{slot:"raw-content"},slot:"raw-content"},[e("paper-table",{key:"".concat(t.selectedTable,"-").concat(t.dataUpdateTrigger),attrs:{data:t.filteredData,columns:t.CurrentTable.columns}})],1)]):t._e(),e("div",{staticClass:"page_button",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("p-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handlePrevPage.apply(null,arguments)}}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("p-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handleNextPage.apply(null,arguments)}}},[t._v("下一页")])],1)],1):t._e()]):e("div",{staticClass:"source-map"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"search-bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingSource,expression:"loadingSource"}],staticClass:"col-12",attrs:{"element-loading-text":"加载中..."}},[e("source-table",{attrs:{sources:t.filteredSources,title:t.EventTable.title}})],1)])])])},r=[],s=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("ade3")),i=(a("ffc1"),a("28a5"),a("3835")),o=(a("4917"),a("a481"),a("55dd"),a("6b54"),a("f576"),a("c5f6"),a("96cf"),a("1da1")),c=(a("7f7f"),a("6762"),a("2fdb"),a("ac6a"),a("8615"),a("c8ac")),l=a("2af9"),u=a("ba48"),d=a.n(u),p=a("cee4");function f(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=h(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return i=t.done,t},e:function(t){o=!0,s=t},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw s}}}}function h(t,e){if(t){if("string"==typeof t)return g(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}var m=["时间","类型","名称","危险等级"],b=["时间","类型","名称","危险等级"],v=["时间","主体类型","主体名称","行为","客体类型","客体名称"],y=["时间","主体类型","主体名称","行为","客体类型","客体名称"],C={name:"LogUpload",components:{SourceTable:c["a"],StatsCard:l["g"],PaperTable:l["f"],ChartCard:l["c"],Chartist:d.a},data:function(){return{mode:"",loadingSource:!1,loadingWeek:!1,dataUpdateTrigger:0,progressVisible:!1,progress:0,showActionTable:!0,showTextArea:!1,selectedUploadType:"file",selectedFile:null,manualInput:"",allFilteredData:[],selectedTable:"AttackerTable",searchText:"",dialogVisible:!1,analysisTimeRange:{beginTime:"2018-04-06 00:00:00",endTime:"2018-04-12 00:00:00"},fileList:[],subjectTypes:[{value:20,name:"netflow"},{value:30,name:"lsof"}],objectTypes:{},subjectNames:[{name:"",value:0,series:[0,0,0,0,0,0,0]}],objectNames:[{name:"",value:0,series:[0,0,0,0,0,0,0]}],analysisMethod:[{value:"high",label:"high"},{value:"medium",label:"medium"},{value:"low",label:"low"},{value:"cadets-e3",label:"cadets-e3"}],uploadMethod:[{value:"file",label:"文件上传"},{value:"manual",label:"手动输入"}],modelConfigVisible:!1,activeTab:"artifactsPath",modelConfig:{ARTIFACT_DIR:"./artifact/",MODEL_NAME:"cadets3_models",LOSS_FACTOR:1.5,MAX_AVG_LOSS:10,MIN_AVG_LOSS:4.7},statsCards:[{type:"warning",icon:"ti-server",title:"攻击方",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-reload",loading:!1},{type:"success",icon:"ti-wallet",title:"被攻击方",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-calendar",loading:!1},{type:"danger",icon:"ti-pulse",title:"异常行为",subTitle:"(可疑/危险)",value:"",footerIcon:"ti-timer",loading:!1}],AttackerTable:{title:"攻击源列表",subTitle:"",columns:[].concat(m),data:[],options:{pageSize:10,currentPage:1}},AttackedTable:{title:"被攻击方列表",subTitle:"",columns:[].concat(b),data:[],options:{pageSize:10,currentPage:1}},AlterTable:{title:"可疑行为列表",subTitle:"",columns:[].concat(v),data:[],options:{pageSize:10,currentPage:2}},DangerTable:{title:"危险行为列表",subTitle:"",columns:[].concat(y),data:[],options:{pageSize:10,currentPage:1}},EventTable:{title:"警告信息",data:[],ids:[]}}},computed:{filteredSources:function(){if(!this.searchText)return this.EventTable.data;var t=this.searchText.toLowerCase();return this.EventTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))}))},CurrentTable:function(){return this[this.selectedTable]},currentPage:function(){return this.CurrentTable.options.currentPage},pageSize:function(){return this.CurrentTable.options.pageSize||6},totalItems:function(){return this.allFilteredData.length||0},totalPages:function(){return Math.ceil(this.totalItems/this.pageSize)||1},currentPageData:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.CurrentTable.data.slice(t,e)},filteredData:function(){this.dataUpdateTrigger;var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize,a=this.CurrentTable.data,n=this.searchText.trim().toLowerCase();return n?a.filter((function(t){return Object.values(t).some((function(t){return String(t).toLowerCase().includes(n)}))})).slice(t,e):a.slice(t,e)}},watch:{searchText:function(){this.updateAllFilteredData()},CurrentTable:function(){this.updateAllFilteredData()}},mounted:function(){this.fetchConfig(),this.checkEngineStatus()},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({showModelConfig:function(){this.modelConfigVisible=!0},saveModelConfig:function(){console.log("Saving model config:",this.modelConfig);try{this.updateAllConfigs(),this.$message.success("模型配置已保存")}catch(t){console.log("保存错误",t)}this.modelConfigVisible=!1},fetchData:function(){try{this.fetchAlertData(),this.fetchAttackedData(),this.fetchAttackerData(),this.fetchEventData()}catch(t){console.log("分析数据错误",t)}},toggleView:function(){this.showActionTable=!this.showActionTable},showUploadDialog:function(){this.dialogVisible=!0},handlePreview:function(t){var e=this;if("application/json"===t.raw.type){var a=new FileReader;a.onload=function(t){try{var a=JSON.parse(t.target.result),n=JSON.stringify(a,null,2),r='<pre style="white-space: pre-wrap; word-wrap: break-word;">'.concat(n,"</pre>");e.$alert(r,"文件内容预览",{dangerouslyUseHTMLString:!0,customClass:"json-preview-dialog",closeOnClickModal:!0,closeOnPressEscape:!0})}catch(s){e.$message.error("无法解析 JSON 文件: "+s.message)}},a.readAsText(t.raw)}else this.$message.error("只能预览 json 文件")},handleRemove:function(t,e){this.fileList=e,this.$message({message:"文件 ".concat(t.name," 已被移除"),type:"info"})},submitUpload:function(){this.selectedFile?(this.dialogVisible=!1,this.uploadFile()):this.$message.warning("请先选择文件")},changeShow:function(){return this.showTextArea=!this.showTextArea,this.showTextArea},sendManualInput:function(){},submitMultilineText:function(){},updateAllFilteredData:function(){var t=this.searchText.trim().toLowerCase();this.allFilteredData=t?this.CurrentTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))})):this.CurrentTable.data,this.dataUpdateTrigger+=1},formatDate_date:function(t){var e=function(t){return t<10?"0"+t:t},a=t.getFullYear(),n=e(t.getMonth()+1),r=e(t.getDate()),s=e(t.getHours()),i=e(t.getMinutes()),o=e(t.getSeconds());return"".concat(a,"-").concat(n,"-").concat(r," ").concat(s,":").concat(i,":").concat(o)},handlePrevPage:function(){this.CurrentTable.options.currentPage>1&&this.CurrentTable.options.currentPage--},handleNextPage:function(){this.CurrentTable.options.currentPage<this.totalPages&&this.CurrentTable.options.currentPage++},fetchAttackerData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s,i,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(s,":").concat(i,":").concat(o)},this.statsCards[0].loading=!0,t.next=4,p["a"].get("http://43.138.200.89:8080/kairos/subjects",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:a=t.sent,n=[],r=f(a.data.anomalous_subjects.data);try{for(r.s();!(s=r.n()).done;)i=s.value,n.push({"时间":e(i.Time),"类型":i.SubjectType,"名称":i.SubjectName,"危险等级":"可疑"})}catch(u){r.e(u)}finally{r.f()}o=f(a.data.dangerous_subjects.data);try{for(o.s();!(c=o.n()).done;)l=c.value,n.push({"时间":e(l.Time),"类型":l.SubjectType,"名称":l.SubjectName,"危险等级":"危险"})}catch(u){o.e(u)}finally{o.f()}this.statsCards[0].value=a.data.anomalous_subjects.total.toString()+"/"+a.data.dangerous_subjects.total.toString(),this.statsCards[0].loading=!1,this.AttackerTable.data=this.AttackerTable.data.concat(n),this.dataUpdateTrigger+=1,this.updateAllFilteredData();case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchAttackedData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s,i,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(s,":").concat(i,":").concat(o)},this.statsCards[1].loading=!0,t.next=4,p["a"].get("http://43.138.200.89:8080/kairos/objects",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:a=t.sent,n=[],r=f(a.data.anomalous_objects.data);try{for(r.s();!(s=r.n()).done;)i=s.value,n.push({"时间":e(i.Time),"类型":i.ObjectType,"名称":i.ObjectName,"危险等级":"可疑"})}catch(u){r.e(u)}finally{r.f()}o=f(a.data.dangerous_objects.data);try{for(o.s();!(c=o.n()).done;)l=c.value,n.push({"时间":e(l.Time),"类型":l.ObjectType,"名称":l.ObjectName,"危险等级":"危险"})}catch(u){o.e(u)}finally{o.f()}this.statsCards[1].value=a.data.anomalous_objects.total.toString()+"/"+a.data.dangerous_objects.total.toString(),this.statsCards[1].loading=!1,this.AttackedTable.data=this.AttackedTable.data.concat(n);case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchAlertData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s,i,o,c,l,u,d,h,g,m,b,v,y,C,T,w,S,_,x,j;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(t){var e=new Date(Number(BigInt(t)/1000000n)),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(s,":").concat(i,":").concat(o)},this.loadingWeek=!0,this.statsCards[2].loading=!0,t.next=5,p["a"].get("http://43.138.200.89:8080/kairos/actions",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 5:a=t.sent,n={},r={},s={},i={},o=["EVENT_RECVFROM","EVENT_SENDTO","EVENT_EXECUTE","EVENT_WRITE","EVENT_READ","EVENT_OPEN","EVENT_CLOSE"],c=[],l=[],u=a.data.anomalous_actions.data,d=a.data.dangerous_actions.data,h=f(u);try{for(h.s();!(g=h.n()).done;)m=g.value,c.push({"时间":e(m.Time),"主体类型":m.SubjectType,"主体名称":m.SubjectName,"行为":m.Action,"客体类型":m.ObjectType,"客体名称":m.ObjectName})}catch(O){h.e(O)}finally{h.f()}b=f(d);try{for(b.s();!(v=b.n()).done;)y=v.value,l.push({"时间":e(y.Time),"主体类型":y.SubjectType,"主体名称":y.SubjectName,"行为":y.Action,"客体类型":y.ObjectType,"客体名称":y.ObjectName})}catch(O){b.e(O)}finally{b.f()}C=u.concat(a.data.dangerous_actions.data),C.forEach((function(t){var e=t.SubjectName,a=t.ObjectName,c=o.indexOf(t.Action);s[e]||(s[e]={name:e,value:0,series:[0,0,0,0,0,0,0]}),s[e].value+=1,s[e].series[c]+=1,i[a]||(i[a]={name:a,value:0,series:[0,0,0,0,0,0,0]}),i[a].value+=1,i[a].series[c]+=1,n[t.SubjectType]=(n[t.SubjectType]||0)+1,r[t.ObjectType]=(r[t.ObjectType]||0)+1})),this.statsCards[2].value="1537/15",this.statsCards[2].loading=!1,this.AlterTable.data=this.AttackerTable.data.concat(c),this.DangerTable.data=this.DangerTable.data.concat(l),this.subjectTypes=n,this.objectTypes=r,T=Object.values(s),w=Object.values(i),S=T.sort((function(t,e){return e.value-t.value})),_=S.slice(0,6),x=w.sort((function(t,e){return e.value-t.value})),j=x.slice(0,6),this.subjectNames=Object.values(_),this.objectNames=Object.values(j),this.loadingWeek=!1;case 36:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchEventData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,p["a"].get("http://43.138.200.89:8080/kairos/graph/info",{params:{start_time:"2018-04-01 00:00:00",end_time:"2018-04-12 00:00:00"},headers:{"content-type":"application/json"}});case 4:e=t.sent,e.data&&e.data.data&&(this.EventTable.data=e.data.data.map((function(t,e){var n=a.extractTimeInfo(t.file_name),r=["low","medium","high"],s=r[Math.floor(Math.random()*r.length)];return{ID:e+1,"开始时间":n.startTime,"结束时间":n.endTime,"可疑行为数":t.anomalous_action_count,"可疑攻击方数":t.anomalous_subject_count,"可疑被攻击方数":t.anomalous_object_count,"危险行为数":t.dangerous_action_count,"危险攻击方数":t.dangerous_subject_count,"危险被攻击方数":t.dangerous_object_count,"危害级别":s,"文件名":a.extractFileName(t.file_name)}})),this.EventTable.total=e.data.total),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("获取警告数据时出错:",t.t0);case 11:return t.prev=11,this.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])})));function e(){return t.apply(this,arguments)}return e}(),extractFileName:function(t){var e=t.replace(/[^0-9\-: ~._^a-z]/g,":"),a=e.match(/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+~\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+)(.+)/);return a?a[1]+a[2]:e},extractTimeInfo:function(t){var e=t.match(/(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)~(\d{4}-\d{2}-\d{2} \d{2}.?\d{2}.?\d{2})\.(\d+)/);if(e){var a=function(t){var e=t.replace(/[^0-9 -]/g,""),a=e.split(" "),n=Object(i["a"])(a,2),r=n[0],s=n[1],o=r.split("-").map(Number),c=Object(i["a"])(o,3),l=c[0],u=c[1],d=c[2],p=parseInt(s.substr(0,2)),f=parseInt(s.substr(2,2)),h=parseInt(s.substr(4,2));new Date(Date.UTC(l,u-1,d,p,f,h));return"".concat(l,"-").concat(String(u).padStart(2,"0"),"-").concat(String(d).padStart(2,"0")," ").concat(String(p).padStart(2,"0"),":").concat(String(f).padStart(2,"0"),":").concat(String(h).padStart(2,"0"))};return{startTime:a(e[1]),endTime:a(e[3])}}return{startTime:"未知",endTime:"未知"}},handleFileChange:function(t){this.selectedFile=t.raw,console.log("选择的文件",this.selectedFile)},uploadFile:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.selectedFile){t.next=18;break}return t.prev=1,e=new FormData,e.append("file",this.selectedFile),t.next=6,p["a"].post("http://43.138.200.89:8080/data/upload-log",e,{headers:{"Content-Type":"multipart/form-data"}});case 6:t.sent,this.$message.success("文件上传成功。"),this.selectedFile=null,this.$refs.upload.clearFiles(),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),console.error(t.t0),this.$message.error("文件上传失败");case 16:t.next=19;break;case 18:this.$message.warning("请选择要上传的文件。");case 19:case"end":return t.stop()}}),t,this,[[1,12]])})));function e(){return t.apply(this,arguments)}return e}(),showProgressBar:function(){var t=this;this.progressVisible=!0,this.progress=0;var e=Math.floor(30001*Math.random()+2e4),a=setInterval((function(){if(t.progress<100){var e=5*Math.random();e=Math.random()<.5?Math.round(10*e)/10:Math.floor(e),t.progress=Math.min(100,t.progress+e)}else clearInterval(a),t.hideProgressBar(),t.fetchData()}),1e3);setTimeout((function(){clearInterval(a),t.progress=100,t.hideProgressBar(),t.fetchData()}),e)},hideProgressBar:function(){this.progressVisible=!1,this.progress=0},handleFetchFailure:function(){this.hideLoading(),this.$message.error("无法获取分析数据，请稍后重试或联系管理员。")}},"sendManualInput",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.manualInput.trim()){t.next=15;break}return t.prev=1,t.next=4,p["a"].post("/api/manual-input",{data:this.manualInput});case 4:e=t.sent,alert("数据发送成功："+e.data.message),this.manualInput="",t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error("发送错误：",t.t0),this.$message.error("上传失败，请重试。"+t.t0.message);case 13:t.next=16;break;case 15:this.$message.warning("请选择要发送的数据。");case 16:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(){return t.apply(this,arguments)}return e}()),"fetchConfig",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].get("http://43.138.200.89:8080/config/view");case 3:e=t.sent,this.modelConfig=e.data.config,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("获取配置失败:",t.t0),this.$message.error("获取配置失败,请重试");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()),"updateConfig",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,a){var n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=encodeURIComponent(e),r=this.customEncodeURIComponent(a),console.log("更新配置",e,a),t.next=6,p["a"].get("http://43.138.200.89:8080/config/update/".concat(n,"/").concat(r));case 6:s=t.sent,s.data&&"200 OK"==s.data.Status?this.$message.success("参数 ".concat(e," 更新成功")):this.$message.warning("参数 ".concat(e," 更新可能未成功，请检查")),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.error("更新配置失败:",t.t0),this.$message.error("更新配置失败: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[0,10]])})));function e(e,a){return t.apply(this,arguments)}return e}()),"customEncodeURIComponent",(function(t){return encodeURIComponent(t).replace(/%2F/g,"|")})),"checkEngineStatus",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].get("http://43.138.200.89:8080/ping");case 3:e=t.sent,"pong!\n"===e.data.Msg?this.$message.success("KIDS Engine 运行正常"):this.$message.warning("KIDS Engine 状态异常"),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("检查引擎状态失败:",t.t0),this.$message.error("无法连接到 KIDS Engine");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()),"updateAllConfigs",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=0,a=Object.entries(this.modelConfig);case 1:if(!(e<a.length)){t.next=8;break}return n=Object(i["a"])(a[e],2),r=n[0],s=n[1],t.next=5,this.updateConfig(r,s);case 5:e++,t.next=1;break;case 8:this.$message.success("所有配置更新完成");case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()),"triggerAnalysis",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="2018-04-01 00:00:00",a="2018-04-12 00:00:00",n="run",this.updateAllConfigs(),t.prev=4,t.next=7,p["a"].get("http://43.138.200.89:8080/api/".concat(n,"/").concat(e,"/").concat(a));case 7:this.$message.success("溯源分析已启动"),this.showProgressBar(),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](4),console.error("启动分析失败:",t.t0),this.$message.error("启动溯源分析失败,请重试");case 15:case"end":return t.stop()}}),t,this,[[4,11]])})));function e(){return t.apply(this,arguments)}return e}())},T=C,w=(a("7f6e"),a("2877")),S=Object(w["a"])(T,n,r,!1,null,"655b619c",null);e["default"]=S.exports},d4c0:function(t,e,a){var n=a("0d58"),r=a("2621"),s=a("52a7");t.exports=function(t){var e=n(t),a=r.f;if(a){var i,o=a(t),c=s.f,l=0;while(o.length>l)c.call(t,i=o[l++])&&e.push(i)}return e}}}]);
//# sourceMappingURL=chunk-48db58e8.328055d5.js.map