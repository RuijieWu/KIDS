{"version":3,"sources":["webpack:///./src/pages/SourceMaps.vue?4c31","webpack:///./src/pages/SourceMaps.vue","webpack:///src/pages/SourceMaps.vue","webpack:///./src/pages/SourceMaps.vue?7bb6","webpack:///./src/pages/SourceMaps.vue?3c01"],"names":["render","_vm","this","_c","_self","staticClass","directives","name","rawName","value","searchText","expression","attrs","domProps","on","$event","target","composing","loading","filteredSources","EventTable","title","staticRenderFns","components","SourceTable","data","ids","computed","searchLower","toLowerCase","filter","source","Object","values","some","String","includes","mounted","fetchEventData","parseInt","localStorage","getItem","methods","searchSources","console","log","_fetchEventData","_asyncToGenerator","regeneratorRuntime","mark","_callee","response","_this","wrap","_context","prev","next","axios","get","params","start_time","end_time","headers","sent","map","item","index","timeInfo","extractTimeInfo","file_name","dangerLevels","randomDangerLevel","Math","floor","random","length","dangerous_action_count","dangerous_subject_count","dangerous_object_count","ID","开始时间","startTime","结束时间","endTime","可疑行为数","anomalous_action_count","可疑攻击方数","anomalous_subject_count","可疑被攻击方数","anomalous_object_count","危险行为数","危险攻击方数","危险被攻击方数","危害级别","文件名","extractFileName","total","t0","error","finish","stop","apply","arguments","fileName","cleanFileName","replace","timeMatch","match","formatTime","dateString","cleanDateString","_cleanDateString$spli","split","_cleanDateString$spli2","_slicedToArray","datePart","timePart","_datePart$split$map","Number","_datePart$split$map2","year","month","day","hour","substr","minute","second","Date","UTC","concat","padStart","component"],"mappings":"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","file":"js/chunk-2eea1aa2.85833870.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SourceMaps.vue?vue&type=style&index=0&id=25fe081e&prod&scoped=true&lang=css\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-12\"},[_c('div',{staticClass:\"table-header\"},[_c('div',{staticClass:\"search-bar\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.searchText),expression:\"searchText\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"搜索...\"},domProps:{\"value\":(_vm.searchText)},on:{\"input\":function($event){if($event.target.composing)return;_vm.searchText=$event.target.value}}}),_c('p-button',{staticClass:\"search-btn ti-search\"})],1)])]),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"col-12 loading\",attrs:{\"element-loading-text\":\"加载中...\"}},[_c('source-table',{attrs:{\"sources\":_vm.filteredSources,\"title\":_vm.EventTable.title}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"row\">\r\n      <div class=\"col-12\">\r\n        <div class=\"table-header\">\r\n          <div class=\"search-bar\">\r\n            <input v-model=\"searchText\" type=\"text\" placeholder=\"搜索...\" class=\"form-control\" />\r\n            <p-button class=\"search-btn ti-search\"></p-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-12 loading\" v-loading=\"loading\" element-loading-text=\"加载中...\">\r\n        <source-table :sources=\"filteredSources\" :title=\"EventTable.title\"></source-table>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import SourceTable from '@/components/SourceTable.vue';\r\n  import axios from 'axios';\r\n  export default {\r\n    components: {\r\n      SourceTable,\r\n    },\r\n    data() {\r\n      return {\r\n        loading:false,\r\n        searchText: '',\r\n        EventTable: {\r\n          title: \"警告信息\",\r\n          data:[],\r\n          ids: [],\r\n        },\r\n      };\r\n    },\r\n    computed: {\r\n      filteredSources() {\r\n        if (!this.searchText) {\r\n          return this.EventTable.data;\r\n        }\r\n        const searchLower = this.searchText.toLowerCase();\r\n        return this.EventTable.data.filter(source => \r\n          Object.values(source).some(value => \r\n            String(value).toLowerCase().includes(searchLower)\r\n          )\r\n        );\r\n      },\r\n    },\r\n    mounted() {\r\n    this.fetchEventData();\r\n    const sourceUpdateIntervalMinutes = parseInt(localStorage.getItem('sourceUpdateInterval')) || 2;\r\n    const sourceUpdateIntervalMilliseconds = sourceUpdateIntervalMinutes * 60 * 1000;\r\n  },\r\n    methods: {\r\n      \r\n      searchSources() {\r\n        console.log('Searching for:', this.searchText);\r\n      },\r\n\r\n\r\n      async fetchEventData() {\r\n        this.loading = true;\r\n  try {\r\n    const response = await axios.get(`http://43.138.200.89:8080/kairos/graph/info`, {\r\n      params: {\r\n        start_time: '2018-04-01 00:00:00',\r\n        end_time: '2018-04-12 00:00:00',\r\n      },\r\n      headers: {\r\n        'content-type': 'application/json;charset=utf-8',\r\n        // 根据需要添加授权信息\r\n      }\r\n    });\r\n\r\n    if (response.data && response.data.data) {\r\n      this.EventTable.data = response.data.data.map((item, index) => {\r\n        // 从文件名中提取时间段\r\n        const timeInfo = this.extractTimeInfo(item.file_name);\r\n\r\n        // 随机生成危害级别，实际应用中应根据具体逻辑决定\r\n        const dangerLevels = ['low', 'medium', 'high'];\r\n        let randomDangerLevel = dangerLevels[Math.floor(Math.random() * dangerLevels.length)];\r\n        if(item.dangerous_action_count == 0&&item.dangerous_subject_count == 0 &&item.dangerous_object_count ==0) randomDangerLevel = 'low';\r\n        else if(item.dangerous_action_count != 0||item.dangerous_subject_count != 0 ||item.dangerous_object_count != 0&&\r\n        item.dangerous_action_count * item.dangerous_subject_count * item.dangerous_object_count == 0) randomDangerLevel = 'medium';\r\n        else if (item.dangerous_action_count != 0&&item.dangerous_subject_count != 0 &&item.dangerous_object_count != 0) randomDangerLevel = 'high';\r\n        return {\r\n          ID: index + 1,\r\n          开始时间: timeInfo.startTime,\r\n          结束时间: timeInfo.endTime,\r\n          可疑行为数: item.anomalous_action_count,\r\n          可疑攻击方数: item.anomalous_subject_count,\r\n          可疑被攻击方数: item.anomalous_object_count,\r\n          危险行为数: item.dangerous_action_count,\r\n          危险攻击方数: item.dangerous_subject_count,\r\n          危险被攻击方数: item.dangerous_object_count,\r\n          危害级别: randomDangerLevel,\r\n          文件名: this.extractFileName(item.file_name),\r\n        };\r\n      });\r\n      // 更新总数\r\n      this.EventTable.total = response.data.total;\r\n    }\r\n  } catch (error) {\r\n    console.error('获取警告数据时出错:', error);\r\n    // 这里可以添加错误处理逻辑，比如显示一个错误消息给用户\r\n  }finally{\r\n    this.loading = false;\r\n  }\r\n},\r\nextractFileName(fileName) {\r\n  // 将未知字符替换为冒号\r\n  const cleanFileName = fileName.replace(/[^0-9\\-: ~._^a-z]/g, ':');\r\n  const timeMatch = cleanFileName.match(/(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d+~\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d+)(.+)/);\r\n  if (timeMatch) {\r\n    return timeMatch[1] + timeMatch[2];\r\n  }\r\n  return cleanFileName;\r\n},\r\nextractTimeInfo(fileName) {\r\n  const timeMatch = fileName.match(/(\\d{4}-\\d{2}-\\d{2} \\d{2}.?\\d{2}.?\\d{2})\\.(\\d+)~(\\d{4}-\\d{2}-\\d{2} \\d{2}.?\\d{2}.?\\d{2})\\.(\\d+)/);\r\n  if (timeMatch) {\r\n  const formatTime = (dateString) => {\r\n    const cleanDateString = dateString.replace(/[^0-9 -]/g, '');\r\n    const [datePart, timePart] = cleanDateString.split(' ');\r\n    const [year, month, day] = datePart.split('-').map(Number);\r\n    const hour = parseInt(timePart.substr(0, 2));\r\n    const minute = parseInt(timePart.substr(2, 2));\r\n    const second = parseInt(timePart.substr(4, 2));\r\n    const date = new Date(Date.UTC(year, month - 1, day, hour, minute, second));\r\n    return `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')} ${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}:${String(second).padStart(2, '0')}`;\r\n  };\r\n  return {\r\n    startTime: formatTime(timeMatch[1]),\r\n    endTime: formatTime(timeMatch[3])\r\n  };\r\n}\r\n  return { startTime: '未知', endTime: '未知' };\r\n}\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .table-header {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .search-bar {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  \r\n  .search-btn {\r\n    margin-left: 8px;\r\n  }\r\n  \r\n  .form-control {\r\n    padding: 8px 12px;\r\n    border: 1px solid #ced4da;\r\n    border-radius: 4px;\r\n    font-size: 14px;\r\n    width: 300px;\r\n  }\r\n  .loading{\r\n    height: 100%;\r\n  }\r\n  </style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SourceMaps.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SourceMaps.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SourceMaps.vue?vue&type=template&id=25fe081e&scoped=true\"\nimport script from \"./SourceMaps.vue?vue&type=script&lang=js\"\nexport * from \"./SourceMaps.vue?vue&type=script&lang=js\"\nimport style0 from \"./SourceMaps.vue?vue&type=style&index=0&id=25fe081e&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25fe081e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}