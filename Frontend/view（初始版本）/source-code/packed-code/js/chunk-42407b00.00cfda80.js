(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42407b00"],{"02f4":function(t,e,i){var n=i("4588"),a=i("be13");t.exports=function(t){return function(e,i){var r,s,o=String(a(e)),c=n(i),l=o.length;return c<0||c>=l?t?"":void 0:(r=o.charCodeAt(c),r<55296||r>56319||c+1===l||(s=o.charCodeAt(c+1))<56320||s>57343?t?o.charAt(c):r:t?o.slice(c,c+2):s-56320+(r-55296<<10)+65536)}}},"0390":function(t,e,i){"use strict";var n=i("02f4")(!0);t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},"1c4c":function(t,e,i){"use strict";var n=i("9b43"),a=i("5ca1"),r=i("4bf8"),s=i("1fa8"),o=i("33a4"),c=i("9def"),l=i("f1ae"),u=i("27ee");a(a.S+a.F*!i("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,i,a,d,h=r(t),f="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,m=0,b=u(h);if(g&&(v=n(v,p>2?arguments[2]:void 0,2)),void 0==b||f==Array&&o(b))for(e=c(h.length),i=new f(e);e>m;m++)l(i,m,g?v(h[m],m):h[m]);else for(d=b.call(h),i=new f;!(a=d.next()).done;m++)l(i,m,g?s(d,v,[a.value,m],!0):a.value);return i.length=m,i}})},"28a5":function(t,e,i){"use strict";var n=i("aae3"),a=i("cb7c"),r=i("ebd6"),s=i("0390"),o=i("9def"),c=i("5f1b"),l=i("520a"),u=i("79e5"),d=Math.min,h=[].push,f="split",p="length",v="lastIndex",g=4294967295,m=!u((function(){RegExp(g,"y")}));i("214f")("split",2,(function(t,e,i,u){var b;return b="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[p]||2!="ab"[f](/(?:ab)*/)[p]||4!="."[f](/(.?)(.?)/)[p]||"."[f](/()()/)[p]>1||""[f](/.?/)[p]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!n(t))return i.call(a,t,e);var r,s,o,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,f=void 0===e?g:e>>>0,m=new RegExp(t.source,u+"g");while(r=l.call(m,a)){if(s=m[v],s>d&&(c.push(a.slice(d,r.index)),r[p]>1&&r.index<a[p]&&h.apply(c,r.slice(1)),o=r[0][p],d=s,c[p]>=f))break;m[v]===r.index&&m[v]++}return d===a[p]?!o&&m.test("")||c.push(""):c.push(a.slice(d)),c[p]>f?c.slice(0,f):c}:"0"[f](void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var a=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,a,n):b.call(String(a),i,n)},function(t,e){var n=u(b,t,this,e,b!==i);if(n.done)return n.value;var l=a(t),h=String(this),f=r(l,RegExp),p=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(m?"y":"g"),y=new f(m?l:"^(?:"+l.source+")",v),w=void 0===e?g:e>>>0;if(0===w)return[];if(0===h.length)return null===c(y,h)?[h]:[];var _=0,S=0,C=[];while(S<h.length){y.lastIndex=m?S:0;var k,x=c(y,m?h:h.slice(S));if(null===x||(k=d(o(y.lastIndex+(m?0:S)),h.length))===_)S=s(h,S,p);else{if(C.push(h.slice(_,S)),C.length===w)return C;for(var N=1;N<=x.length-1;N++)if(C.push(x[N]),C.length===w)return C;S=_=k}}return C.push(h.slice(_)),C}]}))},2909:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i("6b75");function a(t){if(Array.isArray(t))return Object(n["a"])(t)}function r(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=i("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return a(t)||r(t)||Object(s["a"])(t)||o()}},"2e08":function(t,e,i){var n=i("9def"),a=i("9744"),r=i("be13");t.exports=function(t,e,i,s){var o=String(r(t)),c=o.length,l=void 0===i?" ":String(i),u=n(e);if(u<=c||""==l)return o;var d=u-c,h=a.call(l,Math.ceil(d/l.length));return h.length>d&&(h=h.slice(0,d)),s?h+o:o+h}},"2f21":function(t,e,i){"use strict";var n=i("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"456d":function(t,e,i){var n=i("4bf8"),a=i("0d58");i("5eda")("keys",(function(){return function(t){return a(n(t))}}))},4917:function(t,e,i){"use strict";var n=i("cb7c"),a=i("9def"),r=i("0390"),s=i("5f1b");i("214f")("match",1,(function(t,e,i,o){return[function(i){var n=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,n):new RegExp(i)[e](String(n))},function(t){var e=o(i,t,this);if(e.done)return e.value;var c=n(t),l=String(this);if(!c.global)return s(c,l);var u=c.unicode;c.lastIndex=0;var d,h=[],f=0;while(null!==(d=s(c,l))){var p=String(d[0]);h[f]=p,""===p&&(c.lastIndex=r(l,a(c.lastIndex),u)),f++}return 0===f?null:h}]}))},"4f7f":function(t,e,i){"use strict";var n=i("c26b"),a=i("b39a"),r="Set";t.exports=i("e0b8")(r,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return n.def(a(this,r),t=0===t?0:t,t)}},n)},"55dd":function(t,e,i){"use strict";var n=i("5ca1"),a=i("d8e8"),r=i("4bf8"),s=i("79e5"),o=[].sort,c=[1,2,3];n(n.P+n.F*(s((function(){c.sort(void 0)}))||!s((function(){c.sort(null)}))||!i("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(r(this)):o.call(r(this),a(t))}})},"5df3":function(t,e,i){"use strict";var n=i("02f4")(!0);i("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})}))},"5eda":function(t,e,i){var n=i("5ca1"),a=i("8378"),r=i("79e5");t.exports=function(t,e){var i=(a.Object||{})[t]||Object[t],s={};s[t]=e(i),n(n.S+n.F*r((function(){i(1)})),"Object",s)}},"67ab":function(t,e,i){var n=i("ca5a")("meta"),a=i("d3f4"),r=i("69a8"),s=i("86cc").f,o=0,c=Object.isExtensible||function(){return!0},l=!i("79e5")((function(){return c(Object.preventExtensions({}))})),u=function(t){s(t,n,{value:{i:"O"+ ++o,w:{}}})},d=function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[n].i},h=function(t,e){if(!r(t,n)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[n].w},f=function(t){return l&&p.NEED&&c(t)&&!r(t,n)&&u(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:d,getWeak:h,onFreeze:f}},"6ef1":function(t,e,i){"use strict";i("9ded")},8615:function(t,e,i){var n=i("5ca1"),a=i("504c")(!1);n(n.S,"Object",{values:function(t){return a(t)}})},"8e6e":function(t,e,i){var n=i("5ca1"),a=i("990b"),r=i("6821"),s=i("11e9"),o=i("f1ae");n(n.S,"Object",{getOwnPropertyDescriptors:function(t){var e,i,n=r(t),c=s.f,l=a(n),u={},d=0;while(l.length>d)i=c(n,e=l[d++]),void 0!==i&&o(u,e,i);return u}})},9744:function(t,e,i){"use strict";var n=i("4588"),a=i("be13");t.exports=function(t){var e=String(a(this)),i="",r=n(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(i+=e);return i}},"990b":function(t,e,i){var n=i("9093"),a=i("2621"),r=i("cb7c"),s=i("7726").Reflect;t.exports=s&&s.ownKeys||function(t){var e=n.f(r(t)),i=a.f;return i?e.concat(i(t)):e}},"9ded":function(t,e,i){},a481:function(t,e,i){"use strict";var n=i("cb7c"),a=i("4bf8"),r=i("9def"),s=i("4588"),o=i("0390"),c=i("5f1b"),l=Math.max,u=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};i("214f")("replace",2,(function(t,e,i,v){return[function(n,a){var r=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,r,a):i.call(String(r),n,a)},function(t,e){var a=v(i,t,this,e);if(a.done)return a.value;var d=n(t),h=String(this),f="function"===typeof e;f||(e=String(e));var m=d.global;if(m){var b=d.unicode;d.lastIndex=0}var y=[];while(1){var w=c(d,h);if(null===w)break;if(y.push(w),!m)break;var _=String(w[0]);""===_&&(d.lastIndex=o(h,r(d.lastIndex),b))}for(var S="",C=0,k=0;k<y.length;k++){w=y[k];for(var x=String(w[0]),N=l(u(s(w.index),h.length),0),T=[],j=1;j<w.length;j++)T.push(p(w[j]));var A=w.groups;if(f){var D=[x].concat(T,N,h);void 0!==A&&D.push(A);var E=String(e.apply(void 0,D))}else E=g(x,h,N,T,A,e);N>=C&&(S+=h.slice(C,N)+E,C=N+x.length)}return S+h.slice(C)}];function g(t,e,n,r,s,o){var c=n+t.length,l=r.length,u=f;return void 0!==s&&(s=a(s),u=h),i.call(o,u,(function(i,a){var o;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(c);case"<":o=s[a.slice(1,-1)];break;default:var u=+a;if(0===u)return i;if(u>l){var h=d(u/10);return 0===h?i:h<=l?void 0===r[h-1]?a.charAt(1):r[h-1]+a.charAt(1):i}o=r[u-1]}return void 0===o?"":o}))}}))},b39a:function(t,e,i){var n=i("d3f4");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},c26b:function(t,e,i){"use strict";var n=i("86cc").f,a=i("2aeb"),r=i("dcbc"),s=i("9b43"),o=i("f605"),c=i("4a59"),l=i("01f9"),u=i("d53b"),d=i("7a56"),h=i("9e1e"),f=i("67ab").fastKey,p=i("b39a"),v=h?"_s":"size",g=function(t,e){var i,n=f(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,l){var u=t((function(t,n){o(t,u,e,"_i"),t._t=e,t._i=a(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=n&&c(n,i,t[l],t)}));return r(u.prototype,{clear:function(){for(var t=p(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var i=p(this,e),n=g(i,t);if(n){var a=n.n,r=n.p;delete i._i[n.i],n.r=!0,r&&(r.n=a),a&&(a.p=r),i._f==n&&(i._f=a),i._l==n&&(i._l=r),i[v]--}return!!n},forEach:function(t){p(this,e);var i,n=s(t,arguments.length>1?arguments[1]:void 0,3);while(i=i?i.n:this._f){n(i.v,i.k,this);while(i&&i.r)i=i.p}},has:function(t){return!!g(p(this,e),t)}}),h&&n(u.prototype,"size",{get:function(){return p(this,e)[v]}}),u},def:function(t,e,i){var n,a,r=g(t,e);return r?r.v=i:(t._l=r={i:a=f(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=r),n&&(n.n=r),t[v]++,"F"!==a&&(t._i[a]=r)),t},getEntry:g,setStrong:function(t,e,i){l(t,e,(function(t,i){this._t=p(t,e),this._k=i,this._l=void 0}),(function(){var t=this,e=t._k,i=t._l;while(i&&i.r)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?u(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,u(1))}),i?"entries":"values",!i,!0),d(e)}}},c8ac:function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"source-table"},[e("h3",[t._v(t._s(t.title))]),e("div",{staticClass:"row"},t._l(t.paginatedSources,(function(t){return e("div",{key:t.ID,staticClass:"col-md-6"},[e("source-child",{attrs:{source:t}})],1)})),0),e("div",{staticClass:"d-flex justify-content-center mt-4"},[e("button",{staticClass:"btn btn-primary mr-2",attrs:{disabled:1===t.currentPage},on:{click:t.prevPage}},[t._v("上一页")]),e("span",{staticClass:"align-self-center mx-3"},[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("button",{staticClass:"btn btn-primary",attrs:{disabled:t.currentPage===t.totalPages},on:{click:t.nextPage}},[t._v("下一页")])])])},a=[],r=(i("96cf"),i("1da1")),s=(i("ac6a"),i("ffc1"),i("7f7f"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"source-child"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3"},[e("h4",[t._v(t._s(t.source.ID)+". "+t._s(t.source.主机名称))]),e("div",[e("span",{class:["badge",t.getBadgeClass(t.source.危害级别)]},[t._v(t._s(t.source.危害级别))])])]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("开始时间：")]),t._v(" "+t._s(t.source.开始时间)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("结束时间：")]),t._v(" "+t._s(t.source.结束时间)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("行为数：")]),t._v(" "+t._s(t.source.可疑行为数+t.source.危险行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("攻击方数：")]),t._v(" "+t._s(t.source.可疑攻击方数+t.source.危险攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("被攻击方数：")]),t._v(" "+t._s(t.source.可疑被攻击方数+t.source.危险被攻击方数)+"\n          ")]),e("div",{staticClass:"row ablity-button"},[e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showImageModal}},[t._v("查看相关图片")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showReportModal}},[t._v("查看安全报告")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showTableModal}},[t._v("查看行为表格")]),e("button",{staticClass:"btn btn-primary ml-1",on:{click:t.showAdviceModal}},[t._v("查看安全建议")])])])]),t.showModalImage?e("div",{staticClass:"modal-overlay",on:{click:t.closeImageModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeImageModal}},[t._v("×")]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingImg,expression:"loadingImg"}],staticClass:"statistics-panel-img col-12",attrs:{"element-loading-text":"加载中..."}},[t.currentImage?e("el-image",{attrs:{src:t.currentImage,fit:"contain","preview-src-list":[t.currentImage]}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e(),e("span",{staticStyle:{display:"block","text-align":"center"}},[t._v(t._s(t.source.文件名))])],1)])]):t._e(),t.showModalReport?e("div",{staticClass:"modal-overlay",on:{click:t.closeReportModal}},[e("div",{staticClass:"modal-content report-modal",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeReportModal}},[t._v("×")]),e("h3",{staticClass:"modal-title"},[t._v("安全报告")]),e("div",{staticClass:"report-container row"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingMsg,expression:"loadingMsg"}],staticClass:"statistics-panel",attrs:{"element-loading-text":"加载中..."}},[e("el-collapse-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showMessage,expression:"showMessage"}]},[e("h4",[t._v("统计信息")]),e("p",[t._v("数据总量: "+t._s(t.statistics.dataCount))]),e("h5",[t._v("最危险攻击方:")]),e("ul",t._l(t.statistics.topAttackers,(function(i,n){return e("li",{key:"attacker-"+n},[t._v("\n            "+t._s(i.name)+": "+t._s(i.count)+" 次\n          ")])})),0),e("h5",[t._v("最危险被攻击方:")]),e("ul",t._l(t.statistics.topTargets,(function(i,n){return e("li",{key:"target-"+n},[t._v("\n            "+t._s(i.name)+": "+t._s(i.count)+" 次\n          ")])})),0),e("h5",[t._v("前三种边类型统计：")]),e("ul",t._l(Object.entries(t.edgeTypeStats).slice(0,3),(function(i,n){return e("li",{key:n},[t._v("\n    "+t._s(t.edgeTypeMap[n]||n)+": "+t._s(i)+" 次\n  ")])})),0)])]),e("el-collapse-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showMessage,expression:"!showMessage"}]},[e("h4",[t._v("事件信息")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑行为数：")]),t._v(" "+t._s(t.source.可疑行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑攻击方数：")]),t._v(" "+t._s(t.source.可疑攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("可疑被攻击方数：")]),t._v(" "+t._s(t.source.可疑被攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险行为数：")]),t._v(" "+t._s(t.source.危险行为数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险攻击方数：")]),t._v(" "+t._s(t.source.危险攻击方数)+"\n          ")]),e("div",{staticClass:"mb-3"},[e("strong",[t._v("危险被攻击方数：")]),t._v(" "+t._s(t.source.危险被攻击方数)+"\n          ")])])]),e("div",{staticClass:"message-button mb-2"},[e("el-button",{on:{click:function(e){t.showMessage=!t.showMessage}}},[t._v("切换信息")])],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSimplifiedGraph,expression:"!showSimplifiedGraph"},{name:"loading",rawName:"v-loading",value:t.loadingGra,expression:"loadingGra"}],staticClass:"echarts-container column",attrs:{id:"echarts-container","element-loading-text":"加载中..."}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSimplifiedGraph,expression:"showSimplifiedGraph"},{name:"loading",rawName:"v-loading",value:t.loadingGra,expression:"loadingGra"}],staticClass:"echarts-container column",attrs:{id:"simplified-graph","element-loading-text":"加载中..."}})]),e("div",{staticClass:"button-container"},[e("button",{staticClass:"btn btn-primary mr-3",on:{click:t.toggleEdgeStyle}},[t._v("\n        "+t._s(t.isStraightLine?"曲线显示":"直线显示")+"\n      ")]),e("button",{staticClass:"btn btn-primary",on:{click:t.showNodeFilter}},[t._v("筛选节点")]),e("button",{staticClass:"btn btn-primary ml-3",on:{click:t.toggleGraph}},[t._v(t._s(t.showSimplifiedGraph?"显示完整溯源图":"显示关键溯源图"))])])])]):t._e(),t.showNodeFilterModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeNodeFilterModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeNodeFilterModal}},[t._v("×")]),e("h3",[t._v("节点筛选")]),e("div",{staticClass:"d-flex justify-content-end"},[e("el-transfer",{attrs:{filterable:"","filter-method":t.filterNodes,"filter-placeholder":"请输入节点名称",data:t.allNodes,titles:["隐藏","显示"]},model:{value:t.visibleNodes,callback:function(e){t.visibleNodes=e},expression:"visibleNodes"}})],1),e("div",{staticClass:"d-flex justify-content-end"},[e("button",{staticClass:"btn btn-primary mt-3",on:{click:t.applyNodeFilter}},[t._v("应用筛选")])])])]):t._e(),t.showNodeModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeNodeModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeNodeModal}},[t._v("×")]),e("h3",[t._v("节点详情")]),e("p",[e("strong",[t._v("名称:")]),t._v(" "+t._s(t.selectedNode.name))]),e("p",[e("strong",[t._v("类型:")]),t._v(" "+t._s(t.selectedNode.type))]),e("button",{staticClass:"hide-node-btn col-2",on:{click:t.hideNode}},[t._v("隐藏此节点")])])]):t._e(),t.showEdgeModal?e("div",{staticClass:"modal-overlay",on:{click:t.closeEdgeModal}},[e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeEdgeModal}},[t._v("×")]),e("h3",[t._v("边详情")]),t._l(t.selectedEdge.actions,(function(i,n){return e("div",{key:n},[e("p",[e("strong",[t._v("行为:")]),t._v(" "+t._s(i.Action))]),e("p",[e("strong",[t._v("时间:")]),t._v(" "+t._s(t.formatTime(i.Time)))]),e("p",[e("strong",[t._v("危险等级:")]),t._v(" "+t._s(i.危险等级))]),n<t.selectedEdge.actions.length-1?e("hr"):t._e()])}))],2)]):t._e(),t.showTables?e("div",{staticClass:"modal-overlay",on:{click:t.closeTableModal}},[t.showTables?e("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeTableModal}},[t._v("×")]),e("div",{staticClass:"col-12"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"table-header row justify-content-between"},[e("div",{staticClass:"table-selector"},[e("label",{attrs:{for:"tableSelect"}},[t._v("选择表格:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedTable,expression:"selectedTable"}],staticClass:"form-select",attrs:{id:"tableSelect"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedTable=e.target.multiple?i:i[0]}}},[e("option",{attrs:{value:"AlterTable"}},[t._v("可疑行为列表")]),e("option",{attrs:{value:"DangerTable"}},[t._v("危险行为列表")])])]),e("div",{staticClass:"search-bar mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"搜索..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("p-button",{staticClass:"search-btn ti-search"})],1)])]),e("div",{staticClass:"col-12"},[t.CurrentTable?e("card",{attrs:{title:t.CurrentTable.title,subTitle:t.CurrentTable.subTitle}},[e("div",{staticClass:"table",attrs:{slot:"raw-content"},slot:"raw-content"},[e("paper-table",{key:"".concat(t.selectedTable,"-").concat(t.dataUpdateTrigger),attrs:{data:t.filteredData,columns:t.CurrentTable.columns}})],1)]):t._e(),e("div",{staticClass:"page_button"},[e("p-button",{attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handlePrevPage.apply(null,arguments)}}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.currentPage)+" 页 / 共 "+t._s(t.totalPages)+" 页")]),e("p-button",{attrs:{type:"info",round:""},nativeOn:{click:function(e){return t.handleNextPage.apply(null,arguments)}}},[t._v("下一页")])],1)],1)])]):t._e()]):t._e(),t.showAdvice?e("div",{staticClass:"modal-overlay",on:{click:t.closeAdviceModal}},[e("div",{staticClass:"modal-content advice-modal",on:{click:function(t){t.stopPropagation()}}},[e("button",{staticClass:"close-btn",on:{click:t.closeAdviceModal}},[t._v("×")]),e("h3",[t._v("安全建议")]),e("el-collapse-transition",[t.showDetailedAdvice?t._e():e("div",[t._l(t.securityAdvice,(function(i,n){return e("p",{key:n},[t._v(t._s(i))])})),e("el-button",{attrs:{type:"primary"},on:{click:t.showDetailedSecurityAdvice}},[t._v("显示详细安全建议")])],2)]),e("el-collapse-transition",[t.showDetailedAdvice?e("div",{staticClass:"detailed-advice"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAi,expression:"loadingAi"}],staticClass:"message",attrs:{"element-loading-text":"加载中..."}},[e("img",{staticClass:"ai-avatar",attrs:{src:i("f01c"),alt:"AI Avatar"}}),e("div",{staticClass:"advice-content"},[e("p",[t._v(t._s(t.detailedSecurityAdvice.content))])])]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showDetailedAdvice=!1}}},[t._v("返回简要建议")])],1):t._e()])],1)]):t._e()])}),o=[],c=(i("8e6e"),i("456d"),i("c5f6"),i("2909")),l=(i("4f7f"),i("1c4c"),i("ade3")),u=(i("5df3"),i("f400"),i("a481"),i("6762"),i("2fdb"),i("8615"),i("3835")),d=(i("55dd"),i("313e")),h=i("2af9"),f=i("cee4");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){Object(l["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var g=["时间","主体类型","主体名称","行为","客体类型","客体名称"],m=["时间","主体类型","主体名称","行为","客体类型","客体名称"],b={components:{PaperTable:h["f"]},name:"SourceChild",props:{source:{type:Object,required:!0}},data:function(){return{dataUpdateTrigger:0,loadingAi:!1,loadingImg:!1,loadingMsg:!1,loadingGra:!1,showSimplifiedGraph:!1,showAdvice:!1,showMessage:!0,showTables:!1,showModalImage:!1,showModalReport:!1,showNodeModal:!1,showEdgeModal:!1,showNodeFilterModal:!1,showDetailedAdvice:!1,isStraightLine:!0,selectedNode:null,selectedEdge:null,reportData:null,networkData:null,forceRerender:!1,chart:null,hiddenNodes:[],allNodes:[],visibleNodes:[],allFilteredData:[],selectedTable:"DangerTable",searchText:"",securityAdvice:[],edgeTypeStats:{},edgeTypeMap:{EVENT_RECVFROM:"接收事件",EVENT_SENDTO:"发送事件",EVENT_EXECUTE:"执行事件",EVENT_WRITE:"写入事件",EVENT_READ:"读取事件",EVENT_OPEN:"打开事件",EVENT_CLOSE:"关闭事件"},detailedSecurityAdvice:{type:"ai",content:"",typedText:"",typeIndex:0},statistics:{topAttackers:[],topTargets:[],dataCount:0},AlterTable:{title:"可疑行为列表",subTitle:"",columns:[].concat(g),data:[],options:{pageSize:10,currentPage:1}},DangerTable:{title:"危险行为列表",subTitle:"",columns:[].concat(m),data:[],options:{pageSize:10,currentPage:1}}}},mounted:function(){window.addEventListener("resize",this.resizeChart),this.fetchReports()},beforeDestroy:function(){this.chart&&this.chart.dispose(),this.simplifiedChart&&this.simplifiedChart.dispose(),window.removeEventListener("resize",this.resizeChart)},computed:{currentImage:function(){var t=this.source.图片内容;return t?"data:image/png;base64,".concat(t):""},CurrentTable:function(){return this[this.selectedTable]},currentPage:function(){return this.CurrentTable.options.currentPage},pageSize:function(){return this.CurrentTable.options.pageSize||6},totalItems:function(){return this.allFilteredData.length||0},totalPages:function(){return Math.ceil(this.totalItems/this.pageSize)||1},currentPageData:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.CurrentTable.data.slice(t,e)},filteredData:function(){this.dataUpdateTrigger+=1;var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.allFilteredData.slice(t,e)}},watch:{searchText:function(t){this.updateAllFilteredData()},CurrentTable:function(){this.updateAllFilteredData()}},methods:{toggleGraph:function(){var t=this;this.showSimplifiedGraph=!this.showSimplifiedGraph,console.log("Toggling graph:",this.showSimplifiedGraph),this.$nextTick((function(){setTimeout((function(){t.showSimplifiedGraph?(t.renderSimplifiedEChartsGraph(),t.$nextTick((function(){t.simplifiedChart&&t.simplifiedChart.resize()}))):(t.renderEChartsGraph(),t.$nextTick((function(){t.chart&&t.chart.resize()})))}),100)}))},fetchImage:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.source.图片内容){t.next=16;break}return this.loadingImg=!0,t.prev=2,t.next=5,f["a"].get("http://43.138.200.89:8080/kairos/graph/content",{params:{file_name:this.source.文件名},headers:{"content-type":"application/json"}});case 5:e=t.sent,this.$set(this.source,"图片内容",e.data.file_content),this.$nextTick((function(){i.forceRerender=!i.forceRerender})),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log("溯源图获取出错",t.t0);case 13:return t.prev=13,this.loadingImg=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[2,10,13,16]])})));function e(){return t.apply(this,arguments)}return e}(),showDetailedSecurityAdvice:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.showDetailedAdvice=!0,this.loadingAi=!0,this.detailedSecurityAdvice.content)this.detailedSecurityAdvice.typedText="",this.detailedSecurityAdvice.typeIndex=0,this.typeNextChar(this.detailedSecurityAdvice),this.loadingAi=!1;else{e={networkData:[this.networkData],statistics:[this.statistics]},i="安全事件信息: ".concat(JSON.stringify(e),"\n用户问题:给出详细安全建议");try{f["a"].post("http://43.138.200.89:8080/kairos/completions",{prompt:i}).then((function(t){var e=t.data.advice;n.detailedSecurityAdvice.content=e,n.typeNextChar(n.detailedSecurityAdvice)}))}catch(a){console.error("Error fetching detailed security advice:",a),this.detailedSecurityAdvice.content="抱歉，获取详细安全建议时出现错误。请稍后再试。",this.detailedSecurityAdvice.typedText=this.detailedSecurityAdvice.content,this.loadingAi=!1}finally{this.loadingAi=!1}}case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchDetailedSecrityAdvice:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),typeNextChar:function(t){var e=this;t.typeIndex<t.content.length&&(t.typedText+=t.content.charAt(t.typeIndex),t.typeIndex++,setTimeout((function(){return e.typeNextChar(t)}),50))},calculateStatistics:function(){var t=this,e={},i={};this.edgeTypeStats={},this.networkData.links.forEach((function(n){e[n.source]=(e[n.source]||0)+1,i[n.target]=(i[n.target]||0)+1,n.actions.forEach((function(e){var i=t.edgeTypeMap[e.Action]||e.Action;t.edgeTypeStats[i]=(t.edgeTypeStats[i]||0)+1}))}));var n=function(t){return Object.entries(t).sort((function(t,e){return e[1]-t[1]})).map((function(t){var e=Object(u["a"])(t,2),i=e[0],n=e[1];return{name:i,count:n}}))},a=this.networkData.links.length<1e3?3:6;this.edgeTypeStats=Object.entries(this.edgeTypeStats).sort((function(t,e){return e[1]-t[1]})).reduce((function(t,e){var i=Object(u["a"])(e,2),n=i[0],a=i[1];return t[n]=a,t}),{}),this.statistics={topAttackers:n(e).slice(0,a),topTargets:n(i).slice(0,a),dataCount:this.networkData.links.length},console.log("Calculated statistics:",this.statistics),console.log("Edge type statistics:",this.edgeTypeStats)},generateSecurityAdvice:function(){var t=this;if(this.securityAdvice=[],this.statistics.topAttackers.length>0){var e=this.statistics.topAttackers[0].name;this.securityAdvice.push("".concat(e," 节点作为最频繁的攻击方较为危险，建议加强其防护和监控。"))}if(this.statistics.topTargets.length>0){var i=this.statistics.topTargets[0].name;this.securityAdvice.push("".concat(i," 节点作为最常被攻击的目标较为脆弱，建议对其进行全面检查与必要的隔离措施。"))}var n=["接收事件","发送事件","执行事件","写入事件","读取事件","打开事件","关闭事件"];n.forEach((function(e){var i=t.edgeTypeStats[e]||0,n="";switch(e){case"接收事件":i>0&&(n="检测到 ".concat(i," 次接收事件，建议审查入站流量，确保数据来源可信，并检查是否存在未经授权的数据接收。"));break;case"发送事件":i>0&&(n="发现 ".concat(i," 次发送事件，建议监控出站连接，防止可能的数据外泄，并确保所有外发数据都经过适当的加密和授权。"));break;case"执行事件":i>0&&(n="存在 ".concat(i," 次执行事件，建议审查所有被执行的程序，确保它们都是经过授权和安全的。考虑实施应用程序白名单策略。"));break;case"写入事件":i>0&&(n="检测到 ".concat(i," 次写入事件，建议监控文件系统变更，防止恶意软件写入或重要文件被篡改。考虑实施文件完整性监控。"));break;case"读取事件":i>0&&"检测到 ".concat(i," 次读取事件，建议审查文件访问权限，确保敏感数据不被未授权访问。考虑实施数据加密、访问日志记录，并监控异常的读取模式，如大量或频繁读取敏感文件。同时，评估是否存在数据泄露的风险，并确保所有读取操作都有正当理由。");case"打开事件":i>0&&(n="有 ".concat(i," 次文件或资源打开事件，建议审查访问控制策略，确保只有授权用户和进程能够访问敏感资源。"));break;case"关闭事件":i>0&&(n="记录到 ".concat(i," 次关闭事件，虽然这通常是正常行为，但建议检查是否有异常的资源使用模式，例如频繁的打开后立即关闭。"));break}n&&t.securityAdvice.push(n)})),this.statistics.dataCount>1e3?this.securityAdvice.push("鉴于大量的交互行为，建议加强整体网络安全策略，并考虑实施更严格的访问控制措施。"):this.securityAdvice.push("虽然交互行为数量不多，仍建议定期检查和更新安全策略，以防潜在威胁。")},updateAllFilteredData:function(){var t=this.searchText.trim().toLowerCase();this.allFilteredData=t?this.CurrentTable.data.filter((function(e){return Object.values(e).some((function(e){return String(e).toLowerCase().includes(t)}))})):this.CurrentTable.data,this.dataUpdateTrigger+=1},handlePrevPage:function(){this.CurrentTable.options.currentPage>1&&this.CurrentTable.options.currentPage--},handleNextPage:function(){this.CurrentTable.options.currentPage<this.totalPages&&this.CurrentTable.options.currentPage++},hideNode:function(){this.selectedNode&&(this.hiddenNodes.push(this.selectedNode.name),this.closeNodeModal(),this.updateGraph())},initNodeFilterData:function(){var t=this;this.allNodes=this.networkData.nodes.map((function(t,e){return{key:e,label:t.name,disabled:!1}})),this.visibleNodes=this.allNodes.filter((function(e){return!t.hiddenNodes.includes(e.label)})).map((function(t){return t.key}))},filterNodes:function(t,e){return e.label.toLowerCase().indexOf(t.toLowerCase())>-1},applyNodeFilter:function(){var t=this,e=this.allNodes.filter((function(e){return!t.visibleNodes.includes(e.key)})).map((function(t){return t.label}));this.hiddenNodes=e,this.updateGraph(),this.closeNodeFilterModal()},updateGraph:function(){var t=this,e=this.networkData.nodes.filter((function(e){return!t.hiddenNodes.includes(e.name)})),i=this.networkData.links.filter((function(e){return!t.hiddenNodes.includes(e.source)&&!t.hiddenNodes.includes(e.target)}));this.chart.setOption({series:[{data:e,links:i}]}),this.toggleGraph(),this.toggleGraph()},resizeChart:function(){this.chart&&this.chart.resize(),this.simplifiedChart&&this.simplifiedChart.resize()},getBadgeClass:function(t){switch(t.toLowerCase()){case"high":return"bg-danger";case"medium":return"bg-warning";case"low":return"bg-success";default:return"bg-secondary"}},showImageModal:function(){this.showModalImage=!0,this.fetchImage()},showTableModal:function(){this.showTables=!0},showReportModal:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.showModalReport=!0,t.next=3,this.$nextTick();case 3:return t.next=5,this.fetchReports();case 5:this.initChart(),this.initSimpleChart(),this.showSimplifiedGraph?this.renderSimplifiedEChartsGraph():this.renderEChartsGraph();case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showAdviceModal:function(){this.generateSecurityAdvice(),this.showAdvice=!0},closeImageModal:function(){this.showModalImage=!1},closeReportModal:function(){this.showModalReport=!1,this.chart&&(this.chart.dispose(),this.chart=null),this.simplifiedChart&&(this.simplifiedChart.dispose(),this.simplifiedChart=null)},closeTableModal:function(){this.showTables=!1},closeAdviceModal:function(){this.showAdvice=!1},fetchReports:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,i,n,a,r,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingMsg=!0,this.loadingGra=!0,t.prev=2,e=new Date(this.source.开始时间.replace(/-/g,"/")),i=new Date(this.source.结束时间.replace(/-/g,"/")),e.getTime()===i.getTime()&&i.setSeconds(i.getSeconds()+1),n=function(t){var e=function(t){return(t<10?"0":"")+t};return"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1),"-").concat(e(t.getDate())," ").concat(e(t.getHours()),":").concat(e(t.getMinutes()),":").concat(e(t.getSeconds()))},a=n(i),this.source.结束时间=a,t.next=11,f["a"].get("http://43.138.200.89:8080/kairos/graph-actions",{params:{graph_index:this.source.文件名.slice(0,-4)},headers:{"content-type":"application/json"}});case 11:return r=t.sent,this.reportData=r.data,null==this.reportData.dangerous_actions.data&&(this.reportData.dangerous_actions.data=[]),this.AlterTable.data=this.processActionData(this.reportData.anomalous_actions.data),this.DangerTable.data=this.processActionData(this.reportData.dangerous_actions.data),this.createInitialNetworkData(),t.next=19,this.updateNetworkData();case 19:this.calculateStatistics(),this.$nextTick((function(){s.initChart(),s.initSimpleChart()})),this.dataUpdateTrigger+=1,t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](2),console.error("Error fetching reports:",t.t0);case 27:return t.prev=27,this.loadingMsg=!1,this.loadingGra=!1,this.dataUpdateTrigger+=1,t.finish(27);case 32:case"end":return t.stop()}}),t,this,[[2,24,27,32]])})));function e(){return t.apply(this,arguments)}return e}(),processActionData:function(t){var e=this;return t.map((function(t){return{"时间":e.formatTime(t.Time),"主体类型":t.SubjectType,"主体名称":t.SubjectName,"行为":t.Action,"客体类型":t.ObjectType,"客体名称":t.ObjectName}}))},createInitialNetworkData:function(){var t=new Map,e=new Map,i=function(i,n){t.has(i.SubjectName)||t.set(i.SubjectName,{name:i.SubjectName,value:i.SubjectName,SubjectType:i.SubjectType}),t.has(i.ObjectName)||t.set(i.ObjectName,{name:i.ObjectName,value:i.ObjectName,ObjectType:i.ObjectType});var a="".concat(i.SubjectName,"-").concat(i.ObjectName);e.has(a)||e.set(a,{source:i.SubjectName,target:i.ObjectName,actions:[],hasDangerousAction:!1});var r=e.get(a);r.actions.push(v(v({},i),{},{"危险等级":n})),"危险"===n&&(r.hasDangerousAction=!0)};this.reportData.anomalous_actions.data.forEach((function(t){return i(t,"可疑")})),this.reportData.dangerous_actions.data.forEach((function(t){return i(t,"危险")})),this.networkData={nodes:Array.from(t.values()),links:Array.from(e.values()).map((function(t){return v(v({},t),{},{value:t.actions.length,id:"".concat(t.source,"-").concat(t.target)})}))}},updateNetworkData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,i,n,a,r,s,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([f["a"].get("http://43.138.200.89:8080/kairos/graph-subjects",{params:{graph_index:this.source.文件名.slice(0,-4)}}),f["a"].get("http://43.138.200.89:8080/kairos/graph-objects",{params:{graph_index:this.source.文件名.slice(0,-4)}})]);case 2:e=t.sent,i=Object(u["a"])(e,2),n=i[0],a=i[1],r=new Set(n.data.dangerous_subjects.data.map((function(t){return t.SubjectName}))),s=new Set(n.data.anomalous_subjects.data.map((function(t){return t.SubjectName}))),o=new Set(a.data.dangerous_objects.data.map((function(t){return t.SubjectName}))),c=new Set(a.data.anomalous_objects.data.map((function(t){return t.SubjectName}))),this.networkData.nodes=this.networkData.nodes.map((function(t){return v(v({},t),{},{isDangerousSubject:r.has(t.name),isSuspiciousSubject:s.has(t.name),isDangerousObject:o.has(t.name),isSuspiciousObject:c.has(t.name)})}));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initChart:function(){var t=document.getElementById("echarts-container");t?(this.chart=d["init"](t),this.renderEChartsGraph()):console.error("ECharts container not found")},initSimpleChart:function(){var t=document.getElementById("simplified-graph");t?(this.simplifiedChart=d["init"](t),this.renderSimplifiedEChartsGraph()):console.error("ECharts container not found")},toggleEdgeStyle:function(){this.isStraightLine=!this.isStraightLine,this.renderEChartsGraph(),this.renderSimplifiedEChartsGraph()},renderEChartsGraph:function(){var t=this,e=document.getElementById("echarts-container");this.chart||(this.chart=d["init"](e));Math.max.apply(Math,Object(c["a"])(this.networkData.links.map((function(t){return t.value}))));var i={title:{text:"完整溯源图",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:function(t){return"edge"===t.dataType?"".concat(t.data.source," -> ").concat(t.data.target,"<br/>Actions: ").concat(t.data.value):t.name}},graphic:[{type:"group",left:10,top:80,children:[{type:"circle",shape:{r:8},style:{fill:"#FF0000",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"危险节点",font:"14px Arial",fill:"#333"}}]},{type:"group",left:10,top:140,children:[{type:"circle",shape:{r:8},style:{fill:"#0000FF",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"可疑节点",font:"14px Arial",fill:"#333"}}]}],series:[{type:"graph",layout:"none",data:this.networkData.nodes.filter((function(e){return!t.hiddenNodes.includes(e.name)})).map((function(e){return v(v({},e),{},{itemStyle:{color:t.getNodeColor(e),borderColor:"#000",borderWidth:1}})})),links:this.networkData.links.filter((function(e){return!t.hiddenNodes.includes(e.source)&&!t.hiddenNodes.includes(e.target)})).map((function(e){return v(v({},e),{},{lineStyle:{color:t.getLinkColor(e)}})})),roam:!0,label:{show:!1,position:"right",formatter:"{b}",fontSize:12},lineStyle:{curveness:this.isStraightLine?0:.3},emphasis:{focus:"adjacency",lineStyle:{width:4},label:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,8],draggable:!0,cursor:"pointer",symbolSize:function(e,i){var n=t.networkData.links.filter((function(t){return t.source===i.name||t.target===i.name}));return Math.min(10+2*n.length,30)},itemStyle:{color:"#4169E1",borderColor:"#000",borderWidth:1}}]};this.setNodePositions(i.series[0].data),this.chart.setOption(i),this.addChartClickListeners(),this.loadingGra=!1},getLinkColor:function(t){return t.hasDangerousAction?"#FF0000":"#0000FF"},getNodeColor:function(t){return t.isDangerousSubject||t.isDangerousObject?"#FF0000":t.isDangerousSubject||t.isDangerousObject?"#4169E1":"#0000FF"},getNodeCategory:function(t){return t.isDangerousSubject&&t.isDangerousObject?"危险主体和客体":t.isDangerousSubject?"危险主体":t.isDangerousObject?"危险客体":t.isSuspiciousSubject||t.isSuspiciousObject?"可疑节点":"普通节点"},setNodePositions:function(t){var e=t.length,i=Math.max(50*e,1e7);t.forEach((function(t,n){var a=n/e*2*Math.PI;t.x=i*Math.cos(a),t.y=i*Math.sin(a)}))},renderSimplifiedEChartsGraph:function(){var t=this;try{var e=document.getElementById("simplified-graph");this.simplifiedChart||(this.simplifiedChart=d["init"](e));var i=JSON.parse(JSON.stringify(this.networkData.nodes)),n=JSON.parse(JSON.stringify(this.networkData.links)),a=["mount","PIPE","tmp",".conf",".so",".swp","default"],r=[".sh","mv","cp","rm"];i=i.filter((function(t){return!!r.some((function(e){return t.name.includes(e)}))||!a.some((function(e){return t.name.includes(e)}))}));var s=i.map((function(t){return t.name}));n=n.filter((function(t){return s.includes(t.source)&&s.includes(t.target)}));var o=new Set([].concat(Object(c["a"])(n.map((function(t){return t.source}))),Object(c["a"])(n.map((function(t){return t.target})))));i=i.filter((function(t){return o.has(t.name)}));var l={title:{text:"关键溯源图",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:function(t){return"edge"===t.dataType?"".concat(t.data.source," -> ").concat(t.data.target,"<br/>Actions: ").concat(t.data.value):t.name}},legend:{data:[{name:"既是危险攻击方又是危险被攻击方",icon:"circle"},{name:"危险攻击方",icon:"circle"},{name:"危险被攻击方",icon:"circle"},{name:"可疑节点",icon:"circle"}],textStyle:{color:"#333"},left:10,top:50,orient:"vertical",itemWidth:25,itemHeight:14,itemStyle:{borderColor:"#000",borderWidth:1}},graphic:[{type:"group",left:10,top:80,children:[{type:"circle",shape:{r:8},style:{fill:"#FF0000",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"危险节点",font:"14px Arial",fill:"#333"}}]},{type:"group",left:10,top:140,children:[{type:"circle",shape:{r:8},style:{fill:"#0000FF",stroke:"#000",lineWidth:1}},{type:"text",left:20,style:{text:"可疑节点",font:"14px Arial",fill:"#333"}}]}],series:[{type:"graph",layout:"none",data:i.map((function(e){return v(v({},e),{},{itemStyle:{color:t.getNodeColor(e),borderColor:"#000",borderWidth:1}})})),links:n.map((function(e){return v(v({},e),{},{lineStyle:{color:t.getLinkColor(e)}})})),roam:!0,label:{show:!0,position:"right",formatter:"{b}",fontSize:10},lineStyle:{curveness:this.isStraightLine?0:.3},emphasis:{focus:"adjacency",lineStyle:{width:4},label:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,8],draggable:!0,cursor:"pointer",symbolSize:function(t,e){var i=n.filter((function(t){return t.source===e.name||t.target===e.name}));return Math.min(10+2*i.length,30)},itemStyle:{color:"#4169E1",borderColor:"#000",borderWidth:1}}]};this.setNodePositions(l.series[0].data),this.simplifiedChart.setOption(l),this.addSimplifiedChartClickListeners()}catch(u){console.log("chart error:",u)}},addSimplifiedChartClickListeners:function(){var t=this;this.simplifiedChart.on("click",(function(e){"node"===e.dataType?t.showNodeDetails(e.data):"edge"===e.dataType&&t.showEdgeDetails(e.data)}))},calculateLineWidth:function(t,e){var i=1,n=5;return 0===e||0===t?i:i+Math.log(t)/Math.log(e)*(n-i)},addChartClickListeners:function(){var t=this;this.chart.on("click",(function(e){"node"===e.dataType?t.showNodeDetails(e.data):"edge"===e.dataType&&t.showEdgeDetails(e.data)}))},showNodeDetails:function(t){this.selectedNode={name:t.name,type:t.SubjectType||t.ObjectType},this.showNodeModal=!0},showEdgeDetails:function(t){var e=this,i=t.actions.some((function(t){return e.reportData.dangerous_actions.data.some((function(e){return t.Time===e.Time&&t.SubjectName===e.SubjectName&&t.ObjectName===e.ObjectName}))}));this.selectedEdge={source:t.source,target:t.target,actions:t.actions||[],dangerLevel:i?"危险":"可疑"},this.showEdgeModal=!0},showNodeFilter:function(){this.showNodeFilterModal=!0,this.initNodeFilterData()},closeNodeFilterModal:function(){this.showNodeFilterModal=!1},closeNodeModal:function(){this.showNodeModal=!1,this.selectedNode=null},closeEdgeModal:function(){this.showEdgeModal=!1,this.selectedEdge=null},formatTime:function(t){if(!t)return"Invalid timestamp";var e=new Date(Number(t)/1e6);return isNaN(e.getTime())?"Invalid date":e.toLocaleString()}}},y=b,w=(i("6ef1"),i("2877")),_=Object(w["a"])(y,s,o,!1,null,"576b200e",null),S=_.exports,C={name:"source-table",components:{SourceChild:S},props:{sources:{type:Array,required:!0},title:{type:String,default:"警告信息"}},data:function(){return{currentPage:1,pageSize:4,displayedSources:[]}},computed:{totalPages:function(){return Math.ceil(this.sources.length/this.pageSize)},paginatedSources:function(){var t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.sources.slice(t,e)}},methods:{prevPage:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.currentPage>1&&this.currentPage--;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),nextPage:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.currentPage<this.totalPages&&this.currentPage++;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){}},k=C,x=Object(w["a"])(k,n,a,!1,null,null,null);e["a"]=x.exports},e0b8:function(t,e,i){"use strict";var n=i("7726"),a=i("5ca1"),r=i("2aba"),s=i("dcbc"),o=i("67ab"),c=i("4a59"),l=i("f605"),u=i("d3f4"),d=i("79e5"),h=i("5cc5"),f=i("7f20"),p=i("5dbc");t.exports=function(t,e,i,v,g,m){var b=n[t],y=b,w=g?"set":"add",_=y&&y.prototype,S={},C=function(t){var e=_[t];r(_,t,"delete"==t||"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof y&&(m||_.forEach&&!d((function(){(new y).entries().next()})))){var k=new y,x=k[w](m?{}:-0,1)!=k,N=d((function(){k.has(1)})),T=h((function(t){new y(t)})),j=!m&&d((function(){var t=new y,e=5;while(e--)t[w](e,e);return!t.has(-0)}));T||(y=e((function(e,i){l(e,y,t);var n=p(new b,e,y);return void 0!=i&&c(i,g,n[w],n),n})),y.prototype=_,_.constructor=y),(N||j)&&(C("delete"),C("has"),g&&C("get")),(j||x)&&C(w),m&&_.clear&&delete _.clear}else y=v.getConstructor(e,t,g,w),s(y.prototype,i),o.NEED=!0;return f(y,t),S[t]=y,a(a.G+a.W+a.F*(y!=b),S),m||v.setStrong(y,t,g),y}},f1ae:function(t,e,i){"use strict";var n=i("86cc"),a=i("4630");t.exports=function(t,e,i){e in t?n.f(t,e,a(0,i)):t[e]=i}},f400:function(t,e,i){"use strict";var n=i("c26b"),a=i("b39a"),r="Map";t.exports=i("e0b8")(r,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=n.getEntry(a(this,r),t);return e&&e.v},set:function(t,e){return n.def(a(this,r),0===t?0:t,e)}},n,!0)},f576:function(t,e,i){"use strict";var n=i("5ca1"),a=i("2e08"),r=i("a25f"),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);n(n.P+n.F*s,"String",{padStart:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0,!0)}})}}]);
//# sourceMappingURL=chunk-42407b00.00cfda80.js.map